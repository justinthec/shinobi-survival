/*! For license information please see local.js.LICENSE.txt */
(()=>{var e={343:e=>{var t;self,t=()=>(()=>{var e={"./node_modules/event-lite/event-lite.js":e=>{!function(t){e.exports=t;var n="listeners",i={on:function(e,t){return r(this,e).push(t),this},once:function(e,t){var n=this;return i.originalListener=t,r(n,e).push(i),n;function i(){o.call(n,e,i),t.apply(this,arguments)}},off:o,emit:function(e,t){var n=this,i=r(n,e,!0);if(!i)return!1;var s=arguments.length;if(1===s)i.forEach(function(e){e.call(n)});else if(2===s)i.forEach(function(e){e.call(n,t)});else{var o=Array.prototype.slice.call(arguments,1);i.forEach(function(e){e.apply(n,o)})}return!!i.length}};function s(e){for(var t in i)e[t]=i[t];return e}function o(e,t){var i,s=this;if(arguments.length){if(t){if(i=r(s,e,!0)){if(!(i=i.filter(function(e){return e!==t&&e.originalListener!==t})).length)return o.call(s,e);s[n][e]=i}}else if((i=s[n])&&(delete i[e],!Object.keys(i).length))return o.call(s)}else delete s[n];return s}function r(e,t,i){if(!i||e[n]){var s=e[n]||(e[n]={});return s[t]||(s[t]=[])}}s(t.prototype),t.mixin=s}(function e(){if(!(this instanceof e))return new e})},"./node_modules/ieee754/index.js":(e,t)=>{t.read=function(e,t,n,i,s){var o,r,a=8*s-i-1,l=(1<<a)-1,c=l>>1,h=-7,d=n?s-1:0,u=n?-1:1,p=e[t+d];for(d+=u,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+e[t+d],d+=u,h-=8);for(r=o&(1<<-h)-1,o>>=-h,h+=i;h>0;r=256*r+e[t+d],d+=u,h-=8);if(0===o)o=1-c;else{if(o===l)return r?NaN:1/0*(p?-1:1);r+=Math.pow(2,i),o-=c}return(p?-1:1)*r*Math.pow(2,o-i)},t.write=function(e,t,n,i,s,o){var r,a,l,c=8*o-s-1,h=(1<<c)-1,d=h>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,r=h):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?u/l:u*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=h?(a=0,r=h):r+d>=1?(a=(t*l-1)*Math.pow(2,s),r+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,s),r=0));s>=8;e[n+p]=255&a,p+=f,a/=256,s-=8);for(r=r<<s|a,c+=s;c>0;e[n+p]=255&r,p+=f,r/=256,c-=8);e[n+p-f]|=128*m}},"./node_modules/int64-buffer/int64-buffer.js":function(e,t){!function(e){var t,n="undefined",i=n!==typeof Buffer&&Buffer,s=n!==typeof Uint8Array&&Uint8Array,o=n!==typeof ArrayBuffer&&ArrayBuffer,r=[0,0,0,0,0,0,0,0],a=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},l=4294967296;function c(a,c,w){var x=c?0:4,k=c?4:0,S=c?0:3,_=c?1:2,P=c?2:1,M=c?3:0,j=c?g:b,E=c?y:v,T=A.prototype,C="is"+a,I="_"+C;return T.buffer=void 0,T.offset=0,T[I]=!0,T.toNumber=N,T.toString=function(e){var t=this.buffer,n=this.offset,i=R(t,n+x),s=R(t,n+k),o="",r=!w&&2147483648&i;for(r&&(i=~i,s=l-s),e=e||10;;){var a=i%e*l+s;if(i=Math.floor(i/e),s=Math.floor(a/e),o=(a%e).toString(e)+o,!i&&!s)break}return r&&(o="-"+o),o},T.toJSON=N,T.toArray=h,i&&(T.toBuffer=d),s&&(T.toArrayBuffer=u),A[C]=function(e){return!(!e||!e[I])},e[a]=A,A;function A(e,i,a,c){return this instanceof A?function(e,i,a,c,h){s&&o&&(i instanceof o&&(i=new s(i)),c instanceof o&&(c=new s(c))),i||a||c||t?(p(i,a)||(h=a,c=i,a=0,i=new(t||Array)(8)),e.buffer=i,e.offset=a|=0,n!==typeof c&&("string"==typeof c?function(e,t,n,i){var s=0,o=n.length,r=0,a=0;"-"===n[0]&&s++;for(var c=s;s<o;){var h=parseInt(n[s++],i);if(!(h>=0))break;a=a*i+h,r=r*i+Math.floor(a/l),a%=l}c&&(r=~r,a?a=l-a:r++),O(e,t+x,r),O(e,t+k,a)}(i,a,c,h||10):p(c,h)?f(i,a,c,h):"number"==typeof h?(O(i,a+x,c),O(i,a+k,h)):c>0?j(i,a,c):c<0?E(i,a,c):f(i,a,r,0))):e.buffer=m(r,0)}(this,e,i,a,c):new A(e,i,a,c)}function N(){var e=this.buffer,t=this.offset,n=R(e,t+x),i=R(e,t+k);return w||(n|=0),n?n*l+i:i}function O(e,t,n){e[t+M]=255&n,n>>=8,e[t+P]=255&n,n>>=8,e[t+_]=255&n,n>>=8,e[t+S]=255&n}function R(e,t){return 16777216*e[t+S]+(e[t+_]<<16)+(e[t+P]<<8)+e[t+M]}}function h(e){var n=this.buffer,i=this.offset;return t=null,!1!==e&&0===i&&8===n.length&&a(n)?n:m(n,i)}function d(e){var n=this.buffer,s=this.offset;if(t=i,!1!==e&&0===s&&8===n.length&&Buffer.isBuffer(n))return n;var o=new i(8);return f(o,0,n,s),o}function u(e){var n=this.buffer,i=this.offset,r=n.buffer;if(t=s,!1!==e&&0===i&&r instanceof o&&8===r.byteLength)return r;var a=new s(8);return f(a,0,n,i),a.buffer}function p(e,t){var n=e&&e.length;return t|=0,n&&t+8<=n&&"string"!=typeof e[t]}function f(e,t,n,i){t|=0,i|=0;for(var s=0;s<8;s++)e[t++]=255&n[i++]}function m(e,t){return Array.prototype.slice.call(e,t,t+8)}function g(e,t,n){for(var i=t+8;i>t;)e[--i]=255&n,n/=256}function y(e,t,n){var i=t+8;for(n++;i>t;)e[--i]=255&-n^255,n/=256}function b(e,t,n){for(var i=t+8;t<i;)e[t++]=255&n,n/=256}function v(e,t,n){var i=t+8;for(n++;t<i;)e[t++]=255&-n^255,n/=256}c("Uint64BE",!0,!0),c("Int64BE",!0,!1),c("Uint64LE",!1,!0),c("Int64LE",!1,!1)}("string"!=typeof t.nodeName?t:this||{})},"./node_modules/msgpack-lite/lib/browser.js":(e,t,n)=>{t.encode=n("./node_modules/msgpack-lite/lib/encode.js").encode,t.decode=n("./node_modules/msgpack-lite/lib/decode.js").decode,t.Encoder=n("./node_modules/msgpack-lite/lib/encoder.js").Encoder,t.Decoder=n("./node_modules/msgpack-lite/lib/decoder.js").Decoder,t.createCodec=n("./node_modules/msgpack-lite/lib/ext.js").createCodec,t.codec=n("./node_modules/msgpack-lite/lib/codec.js").codec},"./node_modules/msgpack-lite/lib/buffer-global.js":function(e){function t(e){return e&&e.isBuffer&&e}e.exports=t("undefined"!=typeof Buffer&&Buffer)||t(this.Buffer)||t("undefined"!=typeof window&&window.Buffer)||this.Buffer},"./node_modules/msgpack-lite/lib/buffer-lite.js":(e,t)=>{t.copy=function(e,t,n,i){var s;n||(n=0),i||0===i||(i=this.length),t||(t=0);var o=i-n;if(e===this&&n<t&&t<i)for(s=o-1;s>=0;s--)e[s+t]=this[s+n];else for(s=0;s<o;s++)e[s+t]=this[s+n];return o},t.toString=function(e,t,n){var i=this,s=0|t;n||(n=i.length);for(var o="",r=0;s<n;)(r=i[s++])<128?o+=String.fromCharCode(r):(192==(224&r)?r=(31&r)<<6|63&i[s++]:224==(240&r)?r=(15&r)<<12|(63&i[s++])<<6|63&i[s++]:240==(248&r)&&(r=(7&r)<<18|(63&i[s++])<<12|(63&i[s++])<<6|63&i[s++]),r>=65536?(r-=65536,o+=String.fromCharCode((r>>>10)+55296,56320+(1023&r))):o+=String.fromCharCode(r));return o},t.write=function(e,t){for(var n=this,i=t||(t|=0),s=e.length,o=0,r=0;r<s;)(o=e.charCodeAt(r++))<128?n[i++]=o:o<2048?(n[i++]=192|o>>>6,n[i++]=128|63&o):o<55296||o>57343?(n[i++]=224|o>>>12,n[i++]=128|o>>>6&63,n[i++]=128|63&o):(o=65536+(o-55296<<10|e.charCodeAt(r++)-56320),n[i++]=240|o>>>18,n[i++]=128|o>>>12&63,n[i++]=128|o>>>6&63,n[i++]=128|63&o);return i-t}},"./node_modules/msgpack-lite/lib/bufferish-array.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/bufferish.js"),s=e.exports=o(0);function o(e){return new Array(e)}s.alloc=o,s.concat=i.concat,s.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(s,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}},"./node_modules/msgpack-lite/lib/bufferish-buffer.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/bufferish.js"),s=i.global,o=e.exports=i.hasBuffer?r(0):[];function r(e){return new s(e)}o.alloc=i.hasBuffer&&s.alloc||r,o.concat=i.concat,o.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(o,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return s.from&&1!==s.from.length?s.from(e):new s(e)}},"./node_modules/msgpack-lite/lib/bufferish-proto.js":(e,t,n)=>{var i,s=n("./node_modules/msgpack-lite/lib/buffer-lite.js");t.copy=c,t.slice=h,t.toString=function(e,t,n){return(!a&&o.isBuffer(this)?this.toString:s.toString).apply(this,arguments)},t.write=(i="write",function(){return(this[i]||s[i]).apply(this,arguments)});var o=n("./node_modules/msgpack-lite/lib/bufferish.js"),r=o.global,a=o.hasBuffer&&"TYPED_ARRAY_SUPPORT"in r,l=a&&!r.TYPED_ARRAY_SUPPORT;function c(e,t,n,i){var r=o.isBuffer(this),a=o.isBuffer(e);if(r&&a)return this.copy(e,t,n,i);if(l||r||a||!o.isView(this)||!o.isView(e))return s.copy.call(this,e,t,n,i);var c=n||null!=i?h.call(this,n,i):this;return e.set(c,t),c.length}function h(e,t){var n=this.slice||!l&&this.subarray;if(n)return n.call(this,e,t);var i=o.alloc.call(this,t-e);return c.call(this,i,0,e,t),i}},"./node_modules/msgpack-lite/lib/bufferish-uint8array.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/bufferish.js"),s=e.exports=i.hasArrayBuffer?o(0):[];function o(e){return new Uint8Array(e)}s.alloc=o,s.concat=i.concat,s.from=function(e){if(i.isView(e)){var t=e.byteOffset,n=e.byteLength;(e=e.buffer).byteLength!==n&&(e.slice?e=e.slice(t,t+n):(e=new Uint8Array(e)).byteLength!==n&&(e=Array.prototype.slice.call(e,t,t+n)))}else{if("string"==typeof e)return i.from.call(s,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}},"./node_modules/msgpack-lite/lib/bufferish.js":(e,t,n)=>{var i=t.global=n("./node_modules/msgpack-lite/lib/buffer-global.js"),s=t.hasBuffer=i&&!!i.isBuffer,o=t.hasArrayBuffer="undefined"!=typeof ArrayBuffer,r=t.isArray=n("../node_modules/isarray/index.js");t.isArrayBuffer=o?function(e){return e instanceof ArrayBuffer||f(e)}:y;var a=t.isBuffer=s?i.isBuffer:y,l=t.isView=o?ArrayBuffer.isView||b("ArrayBuffer","buffer"):y;t.alloc=p,t.concat=function(e,n){n||(n=0,Array.prototype.forEach.call(e,function(e){n+=e.length}));var i=this!==t&&this||e[0],s=p.call(i,n),o=0;return Array.prototype.forEach.call(e,function(e){o+=u.copy.call(e,s,o)}),s},t.from=function(e){return"string"==typeof e?m.call(this,e):g(this).from(e)};var c=t.Array=n("./node_modules/msgpack-lite/lib/bufferish-array.js"),h=t.Buffer=n("./node_modules/msgpack-lite/lib/bufferish-buffer.js"),d=t.Uint8Array=n("./node_modules/msgpack-lite/lib/bufferish-uint8array.js"),u=t.prototype=n("./node_modules/msgpack-lite/lib/bufferish-proto.js");function p(e){return g(this).alloc(e)}var f=b("ArrayBuffer");function m(e){var t=3*e.length,n=p.call(this,t),i=u.write.call(n,e);return t!==i&&(n=u.slice.call(n,0,i)),n}function g(e){return a(e)?h:l(e)?d:r(e)?c:s?h:o?d:c}function y(){return!1}function b(e,t){return e="[object "+e+"]",function(n){return null!=n&&{}.toString.call(t?n[t]:n)===e}}},"./node_modules/msgpack-lite/lib/codec-base.js":(e,t,n)=>{var i=n("../node_modules/isarray/index.js");t.createCodec=a,t.install=function(e){for(var t in e)o.prototype[t]=r(o.prototype[t],e[t])},t.filter=function(e){return i(e)?function(e){return e=e.slice(),function(n){return e.reduce(t,n)};function t(e,t){return t(e)}}(e):e};var s=n("./node_modules/msgpack-lite/lib/bufferish.js");function o(e){if(!(this instanceof o))return new o(e);this.options=e,this.init()}function r(e,t){return e&&t?function(){return e.apply(this,arguments),t.apply(this,arguments)}:e||t}function a(e){return new o(e)}o.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=s.Uint8Array),this},t.preset=a({preset:!0})},"./node_modules/msgpack-lite/lib/codec.js":(e,t,n)=>{n("./node_modules/msgpack-lite/lib/read-core.js"),n("./node_modules/msgpack-lite/lib/write-core.js"),t.codec={preset:n("./node_modules/msgpack-lite/lib/codec-base.js").preset}},"./node_modules/msgpack-lite/lib/decode-buffer.js":(e,t,n)=>{t.DecodeBuffer=s;var i=n("./node_modules/msgpack-lite/lib/read-core.js").preset;function s(e){if(!(this instanceof s))return new s(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("./node_modules/msgpack-lite/lib/flex-buffer.js").FlexDecoder.mixin(s.prototype),s.prototype.codec=i,s.prototype.fetch=function(){return this.codec.decode(this)}},"./node_modules/msgpack-lite/lib/decode.js":(e,t,n)=>{t.decode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("./node_modules/msgpack-lite/lib/decode-buffer.js").DecodeBuffer},"./node_modules/msgpack-lite/lib/decoder.js":(e,t,n)=>{t.Decoder=o;var i=n("./node_modules/event-lite/event-lite.js"),s=n("./node_modules/msgpack-lite/lib/decode-buffer.js").DecodeBuffer;function o(e){if(!(this instanceof o))return new o(e);s.call(this,e)}o.prototype=new s,i.mixin(o.prototype),o.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},o.prototype.push=function(e){this.emit("data",e)},o.prototype.end=function(e){this.decode(e),this.emit("end")}},"./node_modules/msgpack-lite/lib/encode-buffer.js":(e,t,n)=>{t.EncodeBuffer=s;var i=n("./node_modules/msgpack-lite/lib/write-core.js").preset;function s(e){if(!(this instanceof s))return new s(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("./node_modules/msgpack-lite/lib/flex-buffer.js").FlexEncoder.mixin(s.prototype),s.prototype.codec=i,s.prototype.write=function(e){this.codec.encode(this,e)}},"./node_modules/msgpack-lite/lib/encode.js":(e,t,n)=>{t.encode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("./node_modules/msgpack-lite/lib/encode-buffer.js").EncodeBuffer},"./node_modules/msgpack-lite/lib/encoder.js":(e,t,n)=>{t.Encoder=o;var i=n("./node_modules/event-lite/event-lite.js"),s=n("./node_modules/msgpack-lite/lib/encode-buffer.js").EncodeBuffer;function o(e){if(!(this instanceof o))return new o(e);s.call(this,e)}o.prototype=new s,i.mixin(o.prototype),o.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},o.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")}},"./node_modules/msgpack-lite/lib/ext-buffer.js":(e,t,n)=>{t.ExtBuffer=function e(t,n){if(!(this instanceof e))return new e(t,n);this.buffer=i.from(t),this.type=n};var i=n("./node_modules/msgpack-lite/lib/bufferish.js")},"./node_modules/msgpack-lite/lib/ext-packer.js":(e,t,n)=>{t.setExtPackers=function(e){e.addExtPacker(14,Error,[d,l]),e.addExtPacker(1,EvalError,[d,l]),e.addExtPacker(2,RangeError,[d,l]),e.addExtPacker(3,ReferenceError,[d,l]),e.addExtPacker(4,SyntaxError,[d,l]),e.addExtPacker(5,TypeError,[d,l]),e.addExtPacker(6,URIError,[d,l]),e.addExtPacker(10,RegExp,[h,l]),e.addExtPacker(11,Boolean,[c,l]),e.addExtPacker(12,String,[c,l]),e.addExtPacker(13,Date,[Number,l]),e.addExtPacker(15,Number,[c,l]),"undefined"!=typeof Uint8Array&&(e.addExtPacker(17,Int8Array,r),e.addExtPacker(18,Uint8Array,r),e.addExtPacker(19,Int16Array,r),e.addExtPacker(20,Uint16Array,r),e.addExtPacker(21,Int32Array,r),e.addExtPacker(22,Uint32Array,r),e.addExtPacker(23,Float32Array,r),"undefined"!=typeof Float64Array&&e.addExtPacker(24,Float64Array,r),"undefined"!=typeof Uint8ClampedArray&&e.addExtPacker(25,Uint8ClampedArray,r),e.addExtPacker(26,ArrayBuffer,r),e.addExtPacker(29,DataView,r)),s.hasBuffer&&e.addExtPacker(27,o,s.from)};var i,s=n("./node_modules/msgpack-lite/lib/bufferish.js"),o=s.global,r=s.Uint8Array.from,a={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function l(e){return i||(i=n("./node_modules/msgpack-lite/lib/encode.js").encode),i(e)}function c(e){return e.valueOf()}function h(e){(e=RegExp.prototype.toString.call(e).split("/")).shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function d(e){var t={};for(var n in a)t[n]=e[n];return t}},"./node_modules/msgpack-lite/lib/ext-unpacker.js":(e,t,n)=>{t.setExtUnpackers=function(e){e.addExtUnpacker(14,[a,c(Error)]),e.addExtUnpacker(1,[a,c(EvalError)]),e.addExtUnpacker(2,[a,c(RangeError)]),e.addExtUnpacker(3,[a,c(ReferenceError)]),e.addExtUnpacker(4,[a,c(SyntaxError)]),e.addExtUnpacker(5,[a,c(TypeError)]),e.addExtUnpacker(6,[a,c(URIError)]),e.addExtUnpacker(10,[a,l]),e.addExtUnpacker(11,[a,h(Boolean)]),e.addExtUnpacker(12,[a,h(String)]),e.addExtUnpacker(13,[a,h(Date)]),e.addExtUnpacker(15,[a,h(Number)]),"undefined"!=typeof Uint8Array&&(e.addExtUnpacker(17,h(Int8Array)),e.addExtUnpacker(18,h(Uint8Array)),e.addExtUnpacker(19,[d,h(Int16Array)]),e.addExtUnpacker(20,[d,h(Uint16Array)]),e.addExtUnpacker(21,[d,h(Int32Array)]),e.addExtUnpacker(22,[d,h(Uint32Array)]),e.addExtUnpacker(23,[d,h(Float32Array)]),"undefined"!=typeof Float64Array&&e.addExtUnpacker(24,[d,h(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&e.addExtUnpacker(25,h(Uint8ClampedArray)),e.addExtUnpacker(26,d),e.addExtUnpacker(29,[d,h(DataView)])),s.hasBuffer&&e.addExtUnpacker(27,h(o))};var i,s=n("./node_modules/msgpack-lite/lib/bufferish.js"),o=s.global,r={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function a(e){return i||(i=n("./node_modules/msgpack-lite/lib/decode.js").decode),i(e)}function l(e){return RegExp.apply(null,e)}function c(e){return function(t){var n=new e;for(var i in r)n[i]=t[i];return n}}function h(e){return function(t){return new e(t)}}function d(e){return new Uint8Array(e).buffer}},"./node_modules/msgpack-lite/lib/ext.js":(e,t,n)=>{n("./node_modules/msgpack-lite/lib/read-core.js"),n("./node_modules/msgpack-lite/lib/write-core.js"),t.createCodec=n("./node_modules/msgpack-lite/lib/codec-base.js").createCodec},"./node_modules/msgpack-lite/lib/flex-buffer.js":(e,t,n)=>{t.FlexDecoder=o,t.FlexEncoder=r;var i=n("./node_modules/msgpack-lite/lib/bufferish.js"),s="BUFFER_SHORTAGE";function o(){if(!(this instanceof o))return new o}function r(){if(!(this instanceof r))return new r}function a(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function l(e){(this.buffers||(this.buffers=[])).push(e)}function c(e){return function(t){for(var n in e)t[n]=e[n];return t}}o.mixin=c({bufferish:i,write:function(e){var t=this.offset?i.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=t?e?this.bufferish.concat([t,e]):t:e,this.offset=0},fetch:function(){throw new Error("method not implemented: fetch()")},flush:function(){for(;this.offset<this.buffer.length;){var e,t=this.offset;try{e=this.fetch()}catch(e){if(e&&e.message!=s)throw e;this.offset=t;break}this.push(e)}},push:l,pull:function(){return(this.buffers||(this.buffers=[])).shift()},read:a,reserve:function(e){var t=this.offset,n=t+e;if(n>this.buffer.length)throw new Error(s);return this.offset=n,t},offset:0}),o.mixin(o.prototype),r.mixin=c({bufferish:i,write:function(){throw new Error("method not implemented: write()")},fetch:function(){var e=this.start;if(e<this.offset){var t=this.start=this.offset;return i.prototype.slice.call(this.buffer,e,t)}},flush:function(){for(;this.start<this.offset;){var e=this.fetch();e&&this.push(e)}},push:l,pull:function(){var e=this.buffers||(this.buffers=[]),t=e.length>1?this.bufferish.concat(e):e[0];return e.length=0,t},read:a,reserve:function(e){var t=0|e;if(this.buffer){var n=this.buffer.length,i=0|this.offset,s=i+t;if(s<n)return this.offset=s,i;this.flush(),e=Math.max(e,Math.min(2*n,this.maxBufferSize))}return e=Math.max(e,this.minBufferSize),this.buffer=this.bufferish.alloc(e),this.start=0,this.offset=t,0},send:function(e){var t=e.length;if(t>this.minBufferSize)this.flush(),this.push(e);else{var n=this.reserve(t);i.prototype.copy.call(e,this.buffer,n)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),r.mixin(r.prototype)},"./node_modules/msgpack-lite/lib/read-core.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/ext-buffer.js").ExtBuffer,s=n("./node_modules/msgpack-lite/lib/ext-unpacker.js"),o=n("./node_modules/msgpack-lite/lib/read-format.js").readUint8,r=n("./node_modules/msgpack-lite/lib/read-token.js"),a=n("./node_modules/msgpack-lite/lib/codec-base.js");function l(){var e=this.options;return this.decode=function(e){var t=r.getReadToken(e);return function(e){var n=o(e),i=t[n];if(!i)throw new Error("Invalid type: "+(n?"0x"+n.toString(16):n));return i(e)}}(e),e&&e.preset&&s.setExtUnpackers(this),this}a.install({addExtUnpacker:function(e,t){(this.extUnpackers||(this.extUnpackers=[]))[e]=a.filter(t)},getExtUnpacker:function(e){return(this.extUnpackers||(this.extUnpackers=[]))[e]||function(t){return new i(t,e)}},init:l}),t.preset=l.call(a.preset)},"./node_modules/msgpack-lite/lib/read-format.js":(e,t,n)=>{var i=n("./node_modules/ieee754/index.js"),s=n("./node_modules/int64-buffer/int64-buffer.js"),o=s.Uint64BE,r=s.Int64BE;t.getReadFormat=function(e){var t=a.hasArrayBuffer&&e&&e.binarraybuffer,n=e&&e.int64;return{map:c&&e&&e.usemap?u:d,array:p,str:f,bin:t?g:m,ext:y,uint8:b,uint16:w,uint32:k,uint64:_(8,n?j:P),int8:v,int16:x,int32:S,int64:_(8,n?E:M),float32:_(4,T),float64:_(8,C)}},t.readUint8=b;var a=n("./node_modules/msgpack-lite/lib/bufferish.js"),l=n("./node_modules/msgpack-lite/lib/bufferish-proto.js"),c="undefined"!=typeof Map,h=!0;function d(e,t){var n,i={},s=new Array(t),o=new Array(t),r=e.codec.decode;for(n=0;n<t;n++)s[n]=r(e),o[n]=r(e);for(n=0;n<t;n++)i[s[n]]=o[n];return i}function u(e,t){var n,i=new Map,s=new Array(t),o=new Array(t),r=e.codec.decode;for(n=0;n<t;n++)s[n]=r(e),o[n]=r(e);for(n=0;n<t;n++)i.set(s[n],o[n]);return i}function p(e,t){for(var n=new Array(t),i=e.codec.decode,s=0;s<t;s++)n[s]=i(e);return n}function f(e,t){var n=e.reserve(t),i=n+t;return l.toString.call(e.buffer,"utf-8",n,i)}function m(e,t){var n=e.reserve(t),i=n+t,s=l.slice.call(e.buffer,n,i);return a.from(s)}function g(e,t){var n=e.reserve(t),i=n+t,s=l.slice.call(e.buffer,n,i);return a.Uint8Array.from(s).buffer}function y(e,t){var n=e.reserve(t+1),i=e.buffer[n++],s=n+t,o=e.codec.getExtUnpacker(i);if(!o)throw new Error("Invalid ext type: "+(i?"0x"+i.toString(16):i));return o(l.slice.call(e.buffer,n,s))}function b(e){var t=e.reserve(1);return e.buffer[t]}function v(e){var t=e.reserve(1),n=e.buffer[t];return 128&n?n-256:n}function w(e){var t=e.reserve(2),n=e.buffer;return n[t++]<<8|n[t]}function x(e){var t=e.reserve(2),n=e.buffer,i=n[t++]<<8|n[t];return 32768&i?i-65536:i}function k(e){var t=e.reserve(4),n=e.buffer;return 16777216*n[t++]+(n[t++]<<16)+(n[t++]<<8)+n[t]}function S(e){var t=e.reserve(4),n=e.buffer;return n[t++]<<24|n[t++]<<16|n[t++]<<8|n[t]}function _(e,t){return function(n){var i=n.reserve(e);return t.call(n.buffer,i,h)}}function P(e){return new o(this,e).toNumber()}function M(e){return new r(this,e).toNumber()}function j(e){return new o(this,e)}function E(e){return new r(this,e)}function T(e){return i.read(this,e,!1,23,4)}function C(e){return i.read(this,e,!1,52,8)}},"./node_modules/msgpack-lite/lib/read-token.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/read-format.js");function s(e){var t,n=new Array(256);for(t=0;t<=127;t++)n[t]=o(t);for(t=128;t<=143;t++)n[t]=a(t-128,e.map);for(t=144;t<=159;t++)n[t]=a(t-144,e.array);for(t=160;t<=191;t++)n[t]=a(t-160,e.str);for(n[192]=o(null),n[193]=null,n[194]=o(!1),n[195]=o(!0),n[196]=r(e.uint8,e.bin),n[197]=r(e.uint16,e.bin),n[198]=r(e.uint32,e.bin),n[199]=r(e.uint8,e.ext),n[200]=r(e.uint16,e.ext),n[201]=r(e.uint32,e.ext),n[202]=e.float32,n[203]=e.float64,n[204]=e.uint8,n[205]=e.uint16,n[206]=e.uint32,n[207]=e.uint64,n[208]=e.int8,n[209]=e.int16,n[210]=e.int32,n[211]=e.int64,n[212]=a(1,e.ext),n[213]=a(2,e.ext),n[214]=a(4,e.ext),n[215]=a(8,e.ext),n[216]=a(16,e.ext),n[217]=r(e.uint8,e.str),n[218]=r(e.uint16,e.str),n[219]=r(e.uint32,e.str),n[220]=r(e.uint16,e.array),n[221]=r(e.uint32,e.array),n[222]=r(e.uint16,e.map),n[223]=r(e.uint32,e.map),t=224;t<=255;t++)n[t]=o(t-256);return n}function o(e){return function(){return e}}function r(e,t){return function(n){var i=e(n);return t(n,i)}}function a(e,t){return function(n){return t(n,e)}}t.getReadToken=function(e){var t=i.getReadFormat(e);return e&&e.useraw?function(e){var t,n=s(e).slice();for(n[217]=n[196],n[218]=n[197],n[219]=n[198],t=160;t<=191;t++)n[t]=a(t-160,e.bin);return n}(t):s(t)}},"./node_modules/msgpack-lite/lib/write-core.js":(e,t,n)=>{var i=n("./node_modules/msgpack-lite/lib/ext-buffer.js").ExtBuffer,s=n("./node_modules/msgpack-lite/lib/ext-packer.js"),o=n("./node_modules/msgpack-lite/lib/write-type.js"),r=n("./node_modules/msgpack-lite/lib/codec-base.js");function a(){var e=this.options;return this.encode=function(e){var t=o.getWriteType(e);return function(e,n){var i=t[typeof n];if(!i)throw new Error('Unsupported type "'+typeof n+'": '+n);i(e,n)}}(e),e&&e.preset&&s.setExtPackers(this),this}r.install({addExtPacker:function(e,t,n){n=r.filter(n);var s=t.name;function o(t){return n&&(t=n(t)),new i(t,e)}s&&"Object"!==s?(this.extPackers||(this.extPackers={}))[s]=o:(this.extEncoderList||(this.extEncoderList=[])).unshift([t,o])},getExtPacker:function(e){var t=this.extPackers||(this.extPackers={}),n=e.constructor,i=n&&n.name&&t[n.name];if(i)return i;for(var s=this.extEncoderList||(this.extEncoderList=[]),o=s.length,r=0;r<o;r++){var a=s[r];if(n===a[0])return a[1]}},init:a}),t.preset=a.call(r.preset)},"./node_modules/msgpack-lite/lib/write-token.js":(e,t,n)=>{var i=n("./node_modules/ieee754/index.js"),s=n("./node_modules/int64-buffer/int64-buffer.js"),o=s.Uint64BE,r=s.Int64BE,a=n("./node_modules/msgpack-lite/lib/write-uint8.js").uint8,l=n("./node_modules/msgpack-lite/lib/bufferish.js"),c=l.global,h=l.hasBuffer&&"TYPED_ARRAY_SUPPORT"in c&&!c.TYPED_ARRAY_SUPPORT,d=l.hasBuffer&&c.prototype||{};function u(){var e=a.slice();return e[196]=p(196),e[197]=f(197),e[198]=m(198),e[199]=p(199),e[200]=f(200),e[201]=m(201),e[202]=g(202,4,d.writeFloatBE||v,!0),e[203]=g(203,8,d.writeDoubleBE||w,!0),e[204]=p(204),e[205]=f(205),e[206]=m(206),e[207]=g(207,8,y),e[208]=p(208),e[209]=f(209),e[210]=m(210),e[211]=g(211,8,b),e[217]=p(217),e[218]=f(218),e[219]=m(219),e[220]=f(220),e[221]=m(221),e[222]=f(222),e[223]=m(223),e}function p(e){return function(t,n){var i=t.reserve(2),s=t.buffer;s[i++]=e,s[i]=n}}function f(e){return function(t,n){var i=t.reserve(3),s=t.buffer;s[i++]=e,s[i++]=n>>>8,s[i]=n}}function m(e){return function(t,n){var i=t.reserve(5),s=t.buffer;s[i++]=e,s[i++]=n>>>24,s[i++]=n>>>16,s[i++]=n>>>8,s[i]=n}}function g(e,t,n,i){return function(s,o){var r=s.reserve(t+1);s.buffer[r++]=e,n.call(s.buffer,o,r,i)}}function y(e,t){new o(this,t,e)}function b(e,t){new r(this,t,e)}function v(e,t){i.write(this,e,t,!1,23,4)}function w(e,t){i.write(this,e,t,!1,52,8)}t.getWriteToken=function(e){return e&&e.uint8array?((t=u())[202]=g(202,4,v),t[203]=g(203,8,w),t):h||l.hasBuffer&&e&&e.safe?function(){var e=a.slice();return e[196]=g(196,1,c.prototype.writeUInt8),e[197]=g(197,2,c.prototype.writeUInt16BE),e[198]=g(198,4,c.prototype.writeUInt32BE),e[199]=g(199,1,c.prototype.writeUInt8),e[200]=g(200,2,c.prototype.writeUInt16BE),e[201]=g(201,4,c.prototype.writeUInt32BE),e[202]=g(202,4,c.prototype.writeFloatBE),e[203]=g(203,8,c.prototype.writeDoubleBE),e[204]=g(204,1,c.prototype.writeUInt8),e[205]=g(205,2,c.prototype.writeUInt16BE),e[206]=g(206,4,c.prototype.writeUInt32BE),e[207]=g(207,8,y),e[208]=g(208,1,c.prototype.writeInt8),e[209]=g(209,2,c.prototype.writeInt16BE),e[210]=g(210,4,c.prototype.writeInt32BE),e[211]=g(211,8,b),e[217]=g(217,1,c.prototype.writeUInt8),e[218]=g(218,2,c.prototype.writeUInt16BE),e[219]=g(219,4,c.prototype.writeUInt32BE),e[220]=g(220,2,c.prototype.writeUInt16BE),e[221]=g(221,4,c.prototype.writeUInt32BE),e[222]=g(222,2,c.prototype.writeUInt16BE),e[223]=g(223,4,c.prototype.writeUInt32BE),e}():u();var t}},"./node_modules/msgpack-lite/lib/write-type.js":(e,t,n)=>{var i=n("../node_modules/isarray/index.js"),s=n("./node_modules/int64-buffer/int64-buffer.js"),o=s.Uint64BE,r=s.Int64BE,a=n("./node_modules/msgpack-lite/lib/bufferish.js"),l=n("./node_modules/msgpack-lite/lib/bufferish-proto.js"),c=n("./node_modules/msgpack-lite/lib/write-token.js"),h=n("./node_modules/msgpack-lite/lib/write-uint8.js").uint8,d=n("./node_modules/msgpack-lite/lib/ext-buffer.js").ExtBuffer,u="undefined"!=typeof Uint8Array,p="undefined"!=typeof Map,f=[];f[1]=212,f[2]=213,f[4]=214,f[8]=215,f[16]=216,t.getWriteType=function(e){var t,n=c.getWriteToken(e),s=e&&e.useraw,m=u&&e&&e.binarraybuffer,g=m?a.isArrayBuffer:a.isBuffer,y=m?function(e,t){x(e,new Uint8Array(t))}:x,b=p&&e&&e.usemap?function(e,t){if(!(t instanceof Map))return k(e,t);var i=t.size;n[i<16?128+i:i<=65535?222:223](e,i);var s=e.codec.encode;t.forEach(function(t,n,i){s(e,n),s(e,t)})}:k;return{boolean:function(e,t){n[t?195:194](e,t)},function:w,number:function(e,t){var i=0|t;t===i?n[-32<=i&&i<=127?255&i:0<=i?i<=255?204:i<=65535?205:206:-128<=i?208:-32768<=i?209:210](e,i):n[203](e,t)},object:s?function(e,t){if(g(t))return function(e,t){var i=t.length;n[i<32?160+i:i<=65535?218:219](e,i),e.send(t)}(e,t);v(e,t)}:v,string:(t=s?function(e){return e<32?1:e<=65535?3:5}:function(e){return e<32?1:e<=255?2:e<=65535?3:5},function(e,i){var s=i.length,o=5+3*s;e.offset=e.reserve(o);var r=e.buffer,a=t(s),c=e.offset+a;s=l.write.call(r,i,c);var h=t(s);if(a!==h){var d=c+h-a,u=c+s;l.copy.call(r,r,d,c,u)}n[1===h?160+s:h<=3?215+h:219](e,s),e.offset+=s}),symbol:w,undefined:w};function v(e,t){if(null===t)return w(e,t);if(g(t))return y(e,t);if(i(t))return function(e,t){var i=t.length;n[i<16?144+i:i<=65535?220:221](e,i);for(var s=e.codec.encode,o=0;o<i;o++)s(e,t[o])}(e,t);if(o.isUint64BE(t))return function(e,t){n[207](e,t.toArray())}(e,t);if(r.isInt64BE(t))return function(e,t){n[211](e,t.toArray())}(e,t);var s=e.codec.getExtPacker(t);if(s&&(t=s(t)),t instanceof d)return function(e,t){var i=t.buffer,s=i.length,o=f[s]||(s<255?199:s<=65535?200:201);n[o](e,s),h[t.type](e),e.send(i)}(e,t);b(e,t)}function w(e,t){n[192](e,t)}function x(e,t){var i=t.length;n[i<255?196:i<=65535?197:198](e,i),e.send(t)}function k(e,t){var i=Object.keys(t),s=i.length;n[s<16?128+s:s<=65535?222:223](e,s);var o=e.codec.encode;i.forEach(function(n){o(e,n),o(e,t[n])})}}},"./node_modules/msgpack-lite/lib/write-uint8.js":(e,t)=>{for(var n=t.uint8=new Array(256),i=0;i<=255;i++)n[i]=s(i);function s(e){return function(t){var n=t.reserve(1);t.buffer[n]=e}}},"../node_modules/assertion-error/index.js":e=>{function t(){var e=[].slice.call(arguments);function t(t,n){Object.keys(n).forEach(function(i){~e.indexOf(i)||(t[i]=n[i])})}return function(){for(var e=[].slice.call(arguments),n=0,i={};n<e.length;n++)t(i,e[n]);return i}}function n(e,i,s){var o=t("name","message","stack","constructor","toJSON")(i||{});for(var r in this.message=e||"Unspecified AssertionError",this.showDiff=!1,o)this[r]=o[r];if(s=s||n,Error.captureStackTrace)Error.captureStackTrace(this,s);else try{throw new Error}catch(e){this.stack=e.stack}}e.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.name="AssertionError",n.prototype.constructor=n,n.prototype.toJSON=function(e){var n=t("constructor","toJSON","stack")({name:this.name},this);return!1!==e&&this.stack&&(n.stack=this.stack),n}},"../node_modules/chai/index.js":(e,t,n)=>{e.exports=n("../node_modules/chai/lib/chai.js")},"../node_modules/chai/lib/chai.js":(e,t,n)=>{var i=[];t.version="4.3.3",t.AssertionError=n("../node_modules/assertion-error/index.js");var s=n("../node_modules/chai/lib/chai/utils/index.js");t.use=function(e){return~i.indexOf(e)||(e(t,s),i.push(e)),t},t.util=s;var o=n("../node_modules/chai/lib/chai/config.js");t.config=o;var r=n("../node_modules/chai/lib/chai/assertion.js");t.use(r);var a=n("../node_modules/chai/lib/chai/core/assertions.js");t.use(a);var l=n("../node_modules/chai/lib/chai/interface/expect.js");t.use(l);var c=n("../node_modules/chai/lib/chai/interface/should.js");t.use(c);var h=n("../node_modules/chai/lib/chai/interface/assert.js");t.use(h)},"../node_modules/chai/lib/chai/assertion.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/config.js");e.exports=function(e,t){var n=e.AssertionError,s=t.flag;function o(e,n,i,r){return s(this,"ssfi",i||o),s(this,"lockSsfi",r),s(this,"object",e),s(this,"message",n),t.proxify(this)}e.Assertion=o,Object.defineProperty(o,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),i.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),i.includeStack=e}}),Object.defineProperty(o,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),i.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),i.showDiff=e}}),o.addProperty=function(e,n){t.addProperty(this.prototype,e,n)},o.addMethod=function(e,n){t.addMethod(this.prototype,e,n)},o.addChainableMethod=function(e,n,i){t.addChainableMethod(this.prototype,e,n,i)},o.overwriteProperty=function(e,n){t.overwriteProperty(this.prototype,e,n)},o.overwriteMethod=function(e,n){t.overwriteMethod(this.prototype,e,n)},o.overwriteChainableMethod=function(e,n,i){t.overwriteChainableMethod(this.prototype,e,n,i)},o.prototype.assert=function(e,o,r,a,l,c){var h=t.test(this,arguments);if(!1!==c&&(c=!0),void 0===a&&void 0===l&&(c=!1),!0!==i.showDiff&&(c=!1),!h){o=t.getMessage(this,arguments);var d={actual:t.getActual(this,arguments),expected:a,showDiff:c},u=t.getOperator(this,arguments);throw u&&(d.operator=u),new n(o,d,i.includeStack?this.assert:s(this,"ssfi"))}},Object.defineProperty(o.prototype,"_obj",{get:function(){return s(this,"object")},set:function(e){s(this,"object",e)}})}},"../node_modules/chai/lib/chai/config.js":e=>{e.exports={includeStack:!1,showDiff:!0,truncateThreshold:40,useProxy:!0,proxyExcludedKeys:["then","catch","inspect","toJSON"]}},"../node_modules/chai/lib/chai/core/assertions.js":e=>{e.exports=function(e,t){var n=e.Assertion,i=e.AssertionError,s=t.flag;function o(e,n){n&&s(this,"message",n),e=e.toLowerCase();var i=s(this,"object"),o=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(i).toLowerCase(),"expected #{this} to be "+o+e,"expected #{this} not to be "+o+e)}function r(e,n){return t.isNaN(e)&&t.isNaN(n)||e===n}function a(){s(this,"contains",!0)}function l(e,o){o&&s(this,"message",o);var a=s(this,"object"),l=t.type(a).toLowerCase(),c=s(this,"message"),h=s(this,"negate"),d=s(this,"ssfi"),u=s(this,"deep"),p=u?"deep ":"";c=c?c+": ":"";var f=!1;switch(l){case"string":f=-1!==a.indexOf(e);break;case"weakset":if(u)throw new i(c+"unable to use .deep.include with WeakSet",void 0,d);f=a.has(e);break;case"map":var m=u?t.eql:r;a.forEach(function(t){f=f||m(t,e)});break;case"set":u?a.forEach(function(n){f=f||t.eql(n,e)}):f=a.has(e);break;case"array":f=u?a.some(function(n){return t.eql(n,e)}):-1!==a.indexOf(e);break;default:if(e!==Object(e))throw new i(c+"the given combination of arguments ("+l+" and "+t.type(e).toLowerCase()+") is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a "+t.type(e).toLowerCase(),void 0,d);var g=Object.keys(e),y=null,b=0;if(g.forEach(function(o){var r=new n(a);if(t.transferFlags(this,r,!0),s(r,"lockSsfi",!0),h&&1!==g.length)try{r.property(o,e[o])}catch(e){if(!t.checkError.compatibleConstructor(e,i))throw e;null===y&&(y=e),b++}else r.property(o,e[o])},this),h&&g.length>1&&b===g.length)throw y;return}this.assert(f,"expected #{this} to "+p+"include "+t.inspect(e),"expected #{this} to not "+p+"include "+t.inspect(e))}function c(){var e=s(this,"object");this.assert(null!=e,"expected #{this} to exist","expected #{this} to not exist")}function h(){var e=s(this,"object"),n=t.type(e);this.assert("Arguments"===n,"expected #{this} to be arguments but got "+n,"expected #{this} to not be arguments")}function d(e,t){t&&s(this,"message",t);var n=s(this,"object");if(s(this,"deep")){var i=s(this,"lockSsfi");s(this,"lockSsfi",!0),this.eql(e),s(this,"lockSsfi",i)}else this.assert(e===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function u(e,n){n&&s(this,"message",n),this.assert(t.eql(e,s(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function p(e,o){o&&s(this,"message",o);var r,a=s(this,"object"),l=s(this,"doLength"),c=s(this,"message"),h=c?c+": ":"",d=s(this,"ssfi"),u=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),f=!0;if(l&&"map"!==u&&"set"!==u&&new n(a,c,d,!0).to.have.property("length"),l||"date"!==u||"date"===p?"number"===p||!l&&"number"!==u?l||"date"===u||"number"===u?f=!1:r=h+"expected "+("string"===u?"'"+a+"'":a)+" to be a number or a date":r=h+"the argument to above must be a number":r=h+"the argument to above must be a date",f)throw new i(r,void 0,d);if(l){var m,g="length";"map"===u||"set"===u?(g="size",m=a.size):m=a.length,this.assert(m>e,"expected #{this} to have a "+g+" above #{exp} but got #{act}","expected #{this} to not have a "+g+" above #{exp}",e,m)}else this.assert(a>e,"expected #{this} to be above #{exp}","expected #{this} to be at most #{exp}",e)}function f(e,o){o&&s(this,"message",o);var r,a=s(this,"object"),l=s(this,"doLength"),c=s(this,"message"),h=c?c+": ":"",d=s(this,"ssfi"),u=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),f=!0;if(l&&"map"!==u&&"set"!==u&&new n(a,c,d,!0).to.have.property("length"),l||"date"!==u||"date"===p?"number"===p||!l&&"number"!==u?l||"date"===u||"number"===u?f=!1:r=h+"expected "+("string"===u?"'"+a+"'":a)+" to be a number or a date":r=h+"the argument to least must be a number":r=h+"the argument to least must be a date",f)throw new i(r,void 0,d);if(l){var m,g="length";"map"===u||"set"===u?(g="size",m=a.size):m=a.length,this.assert(m>=e,"expected #{this} to have a "+g+" at least #{exp} but got #{act}","expected #{this} to have a "+g+" below #{exp}",e,m)}else this.assert(a>=e,"expected #{this} to be at least #{exp}","expected #{this} to be below #{exp}",e)}function m(e,o){o&&s(this,"message",o);var r,a=s(this,"object"),l=s(this,"doLength"),c=s(this,"message"),h=c?c+": ":"",d=s(this,"ssfi"),u=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),f=!0;if(l&&"map"!==u&&"set"!==u&&new n(a,c,d,!0).to.have.property("length"),l||"date"!==u||"date"===p?"number"===p||!l&&"number"!==u?l||"date"===u||"number"===u?f=!1:r=h+"expected "+("string"===u?"'"+a+"'":a)+" to be a number or a date":r=h+"the argument to below must be a number":r=h+"the argument to below must be a date",f)throw new i(r,void 0,d);if(l){var m,g="length";"map"===u||"set"===u?(g="size",m=a.size):m=a.length,this.assert(m<e,"expected #{this} to have a "+g+" below #{exp} but got #{act}","expected #{this} to not have a "+g+" below #{exp}",e,m)}else this.assert(a<e,"expected #{this} to be below #{exp}","expected #{this} to be at least #{exp}",e)}function g(e,o){o&&s(this,"message",o);var r,a=s(this,"object"),l=s(this,"doLength"),c=s(this,"message"),h=c?c+": ":"",d=s(this,"ssfi"),u=t.type(a).toLowerCase(),p=t.type(e).toLowerCase(),f=!0;if(l&&"map"!==u&&"set"!==u&&new n(a,c,d,!0).to.have.property("length"),l||"date"!==u||"date"===p?"number"===p||!l&&"number"!==u?l||"date"===u||"number"===u?f=!1:r=h+"expected "+("string"===u?"'"+a+"'":a)+" to be a number or a date":r=h+"the argument to most must be a number":r=h+"the argument to most must be a date",f)throw new i(r,void 0,d);if(l){var m,g="length";"map"===u||"set"===u?(g="size",m=a.size):m=a.length,this.assert(m<=e,"expected #{this} to have a "+g+" at most #{exp} but got #{act}","expected #{this} to have a "+g+" above #{exp}",e,m)}else this.assert(a<=e,"expected #{this} to be at most #{exp}","expected #{this} to be above #{exp}",e)}function y(e,n){n&&s(this,"message",n);var o=s(this,"object"),r=s(this,"ssfi"),a=s(this,"message");try{var l=o instanceof e}catch(n){if(n instanceof TypeError)throw new i((a=a?a+": ":"")+"The instanceof assertion needs a constructor but "+t.type(e)+" was given.",void 0,r);throw n}var c=t.getName(e);null===c&&(c="an unnamed constructor"),this.assert(l,"expected #{this} to be an instance of "+c,"expected #{this} to not be an instance of "+c)}function b(e,n,o){o&&s(this,"message",o);var r=s(this,"nested"),a=s(this,"own"),l=s(this,"message"),c=s(this,"object"),h=s(this,"ssfi"),d=typeof e;if(l=l?l+": ":"",r){if("string"!==d)throw new i(l+"the argument to property must be a string when using nested syntax",void 0,h)}else if("string"!==d&&"number"!==d&&"symbol"!==d)throw new i(l+"the argument to property must be a string, number, or symbol",void 0,h);if(r&&a)throw new i(l+'The "nested" and "own" flags cannot be combined.',void 0,h);if(null==c)throw new i(l+"Target cannot be null or undefined.",void 0,h);var u,p=s(this,"deep"),f=s(this,"negate"),m=r?t.getPathInfo(c,e):null,g=r?m.value:c[e],y="";p&&(y+="deep "),a&&(y+="own "),r&&(y+="nested "),y+="property ",u=a?Object.prototype.hasOwnProperty.call(c,e):r?m.exists:t.hasProperty(c,e),f&&1!==arguments.length||this.assert(u,"expected #{this} to have "+y+t.inspect(e),"expected #{this} to not have "+y+t.inspect(e)),arguments.length>1&&this.assert(u&&(p?t.eql(n,g):n===g),"expected #{this} to have "+y+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have "+y+t.inspect(e)+" of #{act}",n,g),s(this,"object",g)}function v(e,t,n){s(this,"own",!0),b.apply(this,arguments)}function w(e,n,i){"string"==typeof n&&(i=n,n=null),i&&s(this,"message",i);var o=s(this,"object"),r=Object.getOwnPropertyDescriptor(Object(o),e);r&&n?this.assert(t.eql(n,r),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to match "+t.inspect(n)+", got "+t.inspect(r),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to not match "+t.inspect(n),n,r,!0):this.assert(r,"expected #{this} to have an own property descriptor for "+t.inspect(e),"expected #{this} to not have an own property descriptor for "+t.inspect(e)),s(this,"object",r)}function x(){s(this,"doLength",!0)}function k(e,i){i&&s(this,"message",i);var o,r=s(this,"object"),a=t.type(r).toLowerCase(),l=s(this,"message"),c=s(this,"ssfi"),h="length";switch(a){case"map":case"set":h="size",o=r.size;break;default:new n(r,l,c,!0).to.have.property("length"),o=r.length}this.assert(o==e,"expected #{this} to have a "+h+" of #{exp} but got #{act}","expected #{this} to not have a "+h+" of #{act}",e,o)}function S(e,t){t&&s(this,"message",t);var n=s(this,"object");this.assert(e.exec(n),"expected #{this} to match "+e,"expected #{this} not to match "+e)}function _(e){var n,o,r=s(this,"object"),a=t.type(r),l=t.type(e),c=s(this,"ssfi"),h=s(this,"deep"),d="",u=!0,p=s(this,"message"),f=(p=p?p+": ":"")+"when testing keys against an object or an array you must give a single Array|Object|String argument or multiple String arguments";if("Map"===a||"Set"===a)d=h?"deeply ":"",o=[],r.forEach(function(e,t){o.push(t)}),"Array"!==l&&(e=Array.prototype.slice.call(arguments));else{switch(o=t.getOwnEnumerableProperties(r),l){case"Array":if(arguments.length>1)throw new i(f,void 0,c);break;case"Object":if(arguments.length>1)throw new i(f,void 0,c);e=Object.keys(e);break;default:e=Array.prototype.slice.call(arguments)}e=e.map(function(e){return"symbol"==typeof e?e:String(e)})}if(!e.length)throw new i(p+"keys required",void 0,c);var m=e.length,g=s(this,"any"),y=s(this,"all"),b=e;if(g||y||(y=!0),g&&(u=b.some(function(e){return o.some(function(n){return h?t.eql(e,n):e===n})})),y&&(u=b.every(function(e){return o.some(function(n){return h?t.eql(e,n):e===n})}),s(this,"contains")||(u=u&&e.length==o.length)),m>1){var v=(e=e.map(function(e){return t.inspect(e)})).pop();y&&(n=e.join(", ")+", and "+v),g&&(n=e.join(", ")+", or "+v)}else n=t.inspect(e[0]);n=(m>1?"keys ":"key ")+n,n=(s(this,"contains")?"contain ":"have ")+n,this.assert(u,"expected #{this} to "+d+n,"expected #{this} to not "+d+n,b.slice(0).sort(t.compareByInspect),o.sort(t.compareByInspect),!0)}function P(e,i,o){o&&s(this,"message",o);var r,a=s(this,"object"),l=s(this,"ssfi"),c=s(this,"message"),h=s(this,"negate")||!1;new n(a,c,l,!0).is.a("function"),(e instanceof RegExp||"string"==typeof e)&&(i=e,e=null);try{a()}catch(e){r=e}var d=void 0===e&&void 0===i,u=Boolean(e&&i),p=!1,f=!1;if(d||!d&&!h){var m="an error";e instanceof Error?m="#{exp}":e&&(m=t.checkError.getConstructorName(e)),this.assert(r,"expected #{this} to throw "+m,"expected #{this} to not throw an error but #{act} was thrown",e&&e.toString(),r instanceof Error?r.toString():"string"==typeof r?r:r&&t.checkError.getConstructorName(r))}if(e&&r&&(e instanceof Error&&t.checkError.compatibleInstance(r,e)===h&&(u&&h?p=!0:this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(r&&!h?" but #{act} was thrown":""),e.toString(),r.toString())),t.checkError.compatibleConstructor(r,e)===h&&(u&&h?p=!0:this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(r?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),r instanceof Error?r.toString():r&&t.checkError.getConstructorName(r)))),r&&null!=i){var g="including";i instanceof RegExp&&(g="matching"),t.checkError.compatibleMessage(r,i)===h&&(u&&h?f=!0:this.assert(h,"expected #{this} to throw error "+g+" #{exp} but got #{act}","expected #{this} to throw error not "+g+" #{exp}",i,t.checkError.getMessage(r)))}p&&f&&this.assert(h,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(r?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),r instanceof Error?r.toString():r&&t.checkError.getConstructorName(r)),s(this,"object",r)}function M(e,n){n&&s(this,"message",n);var i=s(this,"object"),o=s(this,"itself"),r="function"!=typeof i||o?i[e]:i.prototype[e];this.assert("function"==typeof r,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}function j(e,n){n&&s(this,"message",n);var i=e(s(this,"object"));this.assert(i,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),!s(this,"negate"),i)}function E(e,t,o){o&&s(this,"message",o);var r=s(this,"object"),a=s(this,"message"),l=s(this,"ssfi");if(new n(r,a,l,!0).is.a("number"),"number"!=typeof e||"number"!=typeof t)throw new i((a=a?a+": ":"")+"the arguments to closeTo or approximately must be numbers"+(void 0===t?", and a delta is required":""),void 0,l);this.assert(Math.abs(r-e)<=t,"expected #{this} to be close to "+e+" +/- "+t,"expected #{this} not to be close to "+e+" +/- "+t)}function T(e,t,i){i&&s(this,"message",i);var o,r=s(this,"object"),a=s(this,"message"),l=s(this,"ssfi");new n(r,a,l,!0).is.a("function"),t?(new n(e,a,l,!0).to.have.property(t),o=e[t]):(new n(e,a,l,!0).is.a("function"),o=e()),r();var c=null==t?e():e[t],h=null==t?o:"."+t;s(this,"deltaMsgObj",h),s(this,"initialDeltaValue",o),s(this,"finalDeltaValue",c),s(this,"deltaBehavior","change"),s(this,"realDelta",c!==o),this.assert(o!==c,"expected "+h+" to change","expected "+h+" to not change")}function C(e,t,i){i&&s(this,"message",i);var o,r=s(this,"object"),a=s(this,"message"),l=s(this,"ssfi");new n(r,a,l,!0).is.a("function"),t?(new n(e,a,l,!0).to.have.property(t),o=e[t]):(new n(e,a,l,!0).is.a("function"),o=e()),new n(o,a,l,!0).is.a("number"),r();var c=null==t?e():e[t],h=null==t?o:"."+t;s(this,"deltaMsgObj",h),s(this,"initialDeltaValue",o),s(this,"finalDeltaValue",c),s(this,"deltaBehavior","increase"),s(this,"realDelta",c-o),this.assert(c-o>0,"expected "+h+" to increase","expected "+h+" to not increase")}function I(e,t,i){i&&s(this,"message",i);var o,r=s(this,"object"),a=s(this,"message"),l=s(this,"ssfi");new n(r,a,l,!0).is.a("function"),t?(new n(e,a,l,!0).to.have.property(t),o=e[t]):(new n(e,a,l,!0).is.a("function"),o=e()),new n(o,a,l,!0).is.a("number"),r();var c=null==t?e():e[t],h=null==t?o:"."+t;s(this,"deltaMsgObj",h),s(this,"initialDeltaValue",o),s(this,"finalDeltaValue",c),s(this,"deltaBehavior","decrease"),s(this,"realDelta",o-c),this.assert(c-o<0,"expected "+h+" to decrease","expected "+h+" to not decrease")}["to","be","been","is","and","has","have","with","that","which","at","of","same","but","does","still","also"].forEach(function(e){n.addProperty(e)}),n.addProperty("not",function(){s(this,"negate",!0)}),n.addProperty("deep",function(){s(this,"deep",!0)}),n.addProperty("nested",function(){s(this,"nested",!0)}),n.addProperty("own",function(){s(this,"own",!0)}),n.addProperty("ordered",function(){s(this,"ordered",!0)}),n.addProperty("any",function(){s(this,"any",!0),s(this,"all",!1)}),n.addProperty("all",function(){s(this,"all",!0),s(this,"any",!1)}),n.addChainableMethod("an",o),n.addChainableMethod("a",o),n.addChainableMethod("include",l,a),n.addChainableMethod("contain",l,a),n.addChainableMethod("contains",l,a),n.addChainableMethod("includes",l,a),n.addProperty("ok",function(){this.assert(s(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),n.addProperty("true",function(){this.assert(!0===s(this,"object"),"expected #{this} to be true","expected #{this} to be false",!s(this,"negate"))}),n.addProperty("false",function(){this.assert(!1===s(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!s(this,"negate"))}),n.addProperty("null",function(){this.assert(null===s(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),n.addProperty("undefined",function(){this.assert(void 0===s(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),n.addProperty("NaN",function(){this.assert(t.isNaN(s(this,"object")),"expected #{this} to be NaN","expected #{this} not to be NaN")}),n.addProperty("exist",c),n.addProperty("exists",c),n.addProperty("empty",function(){var e,n=s(this,"object"),o=s(this,"ssfi"),r=s(this,"message");switch(r=r?r+": ":"",t.type(n).toLowerCase()){case"array":case"string":e=n.length;break;case"map":case"set":e=n.size;break;case"weakmap":case"weakset":throw new i(r+".empty was passed a weak collection",void 0,o);case"function":var a=r+".empty was passed a function "+t.getName(n);throw new i(a.trim(),void 0,o);default:if(n!==Object(n))throw new i(r+".empty was passed non-string primitive "+t.inspect(n),void 0,o);e=Object.keys(n).length}this.assert(0===e,"expected #{this} to be empty","expected #{this} not to be empty")}),n.addProperty("arguments",h),n.addProperty("Arguments",h),n.addMethod("equal",d),n.addMethod("equals",d),n.addMethod("eq",d),n.addMethod("eql",u),n.addMethod("eqls",u),n.addMethod("above",p),n.addMethod("gt",p),n.addMethod("greaterThan",p),n.addMethod("least",f),n.addMethod("gte",f),n.addMethod("greaterThanOrEqual",f),n.addMethod("below",m),n.addMethod("lt",m),n.addMethod("lessThan",m),n.addMethod("most",g),n.addMethod("lte",g),n.addMethod("lessThanOrEqual",g),n.addMethod("within",function(e,o,r){r&&s(this,"message",r);var a,l=s(this,"object"),c=s(this,"doLength"),h=s(this,"message"),d=h?h+": ":"",u=s(this,"ssfi"),p=t.type(l).toLowerCase(),f=t.type(e).toLowerCase(),m=t.type(o).toLowerCase(),g=!0,y="date"===f&&"date"===m?e.toISOString()+".."+o.toISOString():e+".."+o;if(c&&"map"!==p&&"set"!==p&&new n(l,h,u,!0).to.have.property("length"),c||"date"!==p||"date"===f&&"date"===m?"number"===f&&"number"===m||!c&&"number"!==p?c||"date"===p||"number"===p?g=!1:a=d+"expected "+("string"===p?"'"+l+"'":l)+" to be a number or a date":a=d+"the arguments to within must be numbers":a=d+"the arguments to within must be dates",g)throw new i(a,void 0,u);if(c){var b,v="length";"map"===p||"set"===p?(v="size",b=l.size):b=l.length,this.assert(b>=e&&b<=o,"expected #{this} to have a "+v+" within "+y,"expected #{this} to not have a "+v+" within "+y)}else this.assert(l>=e&&l<=o,"expected #{this} to be within "+y,"expected #{this} to not be within "+y)}),n.addMethod("instanceof",y),n.addMethod("instanceOf",y),n.addMethod("property",b),n.addMethod("ownProperty",v),n.addMethod("haveOwnProperty",v),n.addMethod("ownPropertyDescriptor",w),n.addMethod("haveOwnPropertyDescriptor",w),n.addChainableMethod("length",k,x),n.addChainableMethod("lengthOf",k,x),n.addMethod("match",S),n.addMethod("matches",S),n.addMethod("string",function(e,i){i&&s(this,"message",i);var o=s(this,"object"),r=s(this,"message"),a=s(this,"ssfi");new n(o,r,a,!0).is.a("string"),this.assert(~o.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))}),n.addMethod("keys",_),n.addMethod("key",_),n.addMethod("throw",P),n.addMethod("throws",P),n.addMethod("Throw",P),n.addMethod("respondTo",M),n.addMethod("respondsTo",M),n.addProperty("itself",function(){s(this,"itself",!0)}),n.addMethod("satisfy",j),n.addMethod("satisfies",j),n.addMethod("closeTo",E),n.addMethod("approximately",E),n.addMethod("members",function(e,i){i&&s(this,"message",i);var o=s(this,"object"),r=s(this,"message"),a=s(this,"ssfi");new n(o,r,a,!0).to.be.an("array"),new n(e,r,a,!0).to.be.an("array");var l,c,h,d=s(this,"contains"),u=s(this,"ordered");d?(c="expected #{this} to be "+(l=u?"an ordered superset":"a superset")+" of #{exp}",h="expected #{this} to not be "+l+" of #{exp}"):(c="expected #{this} to have the same "+(l=u?"ordered members":"members")+" as #{exp}",h="expected #{this} to not have the same "+l+" as #{exp}");var p=s(this,"deep")?t.eql:void 0;this.assert(function(e,t,n,i,s){if(!i){if(e.length!==t.length)return!1;t=t.slice()}return e.every(function(e,o){if(s)return n?n(e,t[o]):e===t[o];if(!n){var r=t.indexOf(e);return-1!==r&&(i||t.splice(r,1),!0)}return t.some(function(s,o){return!!n(e,s)&&(i||t.splice(o,1),!0)})})}(e,o,p,d,u),c,h,e,o,!0)}),n.addMethod("oneOf",function(e,i){i&&s(this,"message",i);var o=s(this,"object"),r=s(this,"message"),a=s(this,"ssfi"),l=s(this,"contains"),c=s(this,"deep");new n(e,r,a,!0).to.be.an("array"),l?this.assert(e.some(function(e){return o.indexOf(e)>-1}),"expected #{this} to contain one of #{exp}","expected #{this} to not contain one of #{exp}",e,o):c?this.assert(e.some(function(e){return t.eql(o,e)}),"expected #{this} to deeply equal one of #{exp}","expected #{this} to deeply equal one of #{exp}",e,o):this.assert(e.indexOf(o)>-1,"expected #{this} to be one of #{exp}","expected #{this} to not be one of #{exp}",e,o)}),n.addMethod("change",T),n.addMethod("changes",T),n.addMethod("increase",C),n.addMethod("increases",C),n.addMethod("decrease",I),n.addMethod("decreases",I),n.addMethod("by",function(e,t){t&&s(this,"message",t);var n,i=s(this,"deltaMsgObj"),o=s(this,"initialDeltaValue"),r=s(this,"finalDeltaValue"),a=s(this,"deltaBehavior"),l=s(this,"realDelta");n="change"===a?Math.abs(r-o)===Math.abs(e):l===Math.abs(e),this.assert(n,"expected "+i+" to "+a+" by "+e,"expected "+i+" to not "+a+" by "+e)}),n.addProperty("extensible",function(){var e=s(this,"object"),t=e===Object(e)&&Object.isExtensible(e);this.assert(t,"expected #{this} to be extensible","expected #{this} to not be extensible")}),n.addProperty("sealed",function(){var e=s(this,"object"),t=e!==Object(e)||Object.isSealed(e);this.assert(t,"expected #{this} to be sealed","expected #{this} to not be sealed")}),n.addProperty("frozen",function(){var e=s(this,"object"),t=e!==Object(e)||Object.isFrozen(e);this.assert(t,"expected #{this} to be frozen","expected #{this} to not be frozen")}),n.addProperty("finite",function(e){var t=s(this,"object");this.assert("number"==typeof t&&isFinite(t),"expected #{this} to be a finite number","expected #{this} to not be a finite number")})}},"../node_modules/chai/lib/chai/interface/assert.js":e=>{e.exports=function(e,t){var n=e.Assertion,i=t.flag,s=e.assert=function(t,i){new n(null,null,e.assert,!0).assert(t,i,"[ negation message unavailable ]")};s.fail=function(t,n,i,o){throw arguments.length<2&&(i=t,t=void 0),i=i||"assert.fail()",new e.AssertionError(i,{actual:t,expected:n,operator:o},s.fail)},s.isOk=function(e,t){new n(e,t,s.isOk,!0).is.ok},s.isNotOk=function(e,t){new n(e,t,s.isNotOk,!0).is.not.ok},s.equal=function(e,t,o){var r=new n(e,o,s.equal,!0);r.assert(t==i(r,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e,!0)},s.notEqual=function(e,t,o){var r=new n(e,o,s.notEqual,!0);r.assert(t!=i(r,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e,!0)},s.strictEqual=function(e,t,i){new n(e,i,s.strictEqual,!0).to.equal(t)},s.notStrictEqual=function(e,t,i){new n(e,i,s.notStrictEqual,!0).to.not.equal(t)},s.deepEqual=s.deepStrictEqual=function(e,t,i){new n(e,i,s.deepEqual,!0).to.eql(t)},s.notDeepEqual=function(e,t,i){new n(e,i,s.notDeepEqual,!0).to.not.eql(t)},s.isAbove=function(e,t,i){new n(e,i,s.isAbove,!0).to.be.above(t)},s.isAtLeast=function(e,t,i){new n(e,i,s.isAtLeast,!0).to.be.least(t)},s.isBelow=function(e,t,i){new n(e,i,s.isBelow,!0).to.be.below(t)},s.isAtMost=function(e,t,i){new n(e,i,s.isAtMost,!0).to.be.most(t)},s.isTrue=function(e,t){new n(e,t,s.isTrue,!0).is.true},s.isNotTrue=function(e,t){new n(e,t,s.isNotTrue,!0).to.not.equal(!0)},s.isFalse=function(e,t){new n(e,t,s.isFalse,!0).is.false},s.isNotFalse=function(e,t){new n(e,t,s.isNotFalse,!0).to.not.equal(!1)},s.isNull=function(e,t){new n(e,t,s.isNull,!0).to.equal(null)},s.isNotNull=function(e,t){new n(e,t,s.isNotNull,!0).to.not.equal(null)},s.isNaN=function(e,t){new n(e,t,s.isNaN,!0).to.be.NaN},s.isNotNaN=function(e,t){new n(e,t,s.isNotNaN,!0).not.to.be.NaN},s.exists=function(e,t){new n(e,t,s.exists,!0).to.exist},s.notExists=function(e,t){new n(e,t,s.notExists,!0).to.not.exist},s.isUndefined=function(e,t){new n(e,t,s.isUndefined,!0).to.equal(void 0)},s.isDefined=function(e,t){new n(e,t,s.isDefined,!0).to.not.equal(void 0)},s.isFunction=function(e,t){new n(e,t,s.isFunction,!0).to.be.a("function")},s.isNotFunction=function(e,t){new n(e,t,s.isNotFunction,!0).to.not.be.a("function")},s.isObject=function(e,t){new n(e,t,s.isObject,!0).to.be.a("object")},s.isNotObject=function(e,t){new n(e,t,s.isNotObject,!0).to.not.be.a("object")},s.isArray=function(e,t){new n(e,t,s.isArray,!0).to.be.an("array")},s.isNotArray=function(e,t){new n(e,t,s.isNotArray,!0).to.not.be.an("array")},s.isString=function(e,t){new n(e,t,s.isString,!0).to.be.a("string")},s.isNotString=function(e,t){new n(e,t,s.isNotString,!0).to.not.be.a("string")},s.isNumber=function(e,t){new n(e,t,s.isNumber,!0).to.be.a("number")},s.isNotNumber=function(e,t){new n(e,t,s.isNotNumber,!0).to.not.be.a("number")},s.isFinite=function(e,t){new n(e,t,s.isFinite,!0).to.be.finite},s.isBoolean=function(e,t){new n(e,t,s.isBoolean,!0).to.be.a("boolean")},s.isNotBoolean=function(e,t){new n(e,t,s.isNotBoolean,!0).to.not.be.a("boolean")},s.typeOf=function(e,t,i){new n(e,i,s.typeOf,!0).to.be.a(t)},s.notTypeOf=function(e,t,i){new n(e,i,s.notTypeOf,!0).to.not.be.a(t)},s.instanceOf=function(e,t,i){new n(e,i,s.instanceOf,!0).to.be.instanceOf(t)},s.notInstanceOf=function(e,t,i){new n(e,i,s.notInstanceOf,!0).to.not.be.instanceOf(t)},s.include=function(e,t,i){new n(e,i,s.include,!0).include(t)},s.notInclude=function(e,t,i){new n(e,i,s.notInclude,!0).not.include(t)},s.deepInclude=function(e,t,i){new n(e,i,s.deepInclude,!0).deep.include(t)},s.notDeepInclude=function(e,t,i){new n(e,i,s.notDeepInclude,!0).not.deep.include(t)},s.nestedInclude=function(e,t,i){new n(e,i,s.nestedInclude,!0).nested.include(t)},s.notNestedInclude=function(e,t,i){new n(e,i,s.notNestedInclude,!0).not.nested.include(t)},s.deepNestedInclude=function(e,t,i){new n(e,i,s.deepNestedInclude,!0).deep.nested.include(t)},s.notDeepNestedInclude=function(e,t,i){new n(e,i,s.notDeepNestedInclude,!0).not.deep.nested.include(t)},s.ownInclude=function(e,t,i){new n(e,i,s.ownInclude,!0).own.include(t)},s.notOwnInclude=function(e,t,i){new n(e,i,s.notOwnInclude,!0).not.own.include(t)},s.deepOwnInclude=function(e,t,i){new n(e,i,s.deepOwnInclude,!0).deep.own.include(t)},s.notDeepOwnInclude=function(e,t,i){new n(e,i,s.notDeepOwnInclude,!0).not.deep.own.include(t)},s.match=function(e,t,i){new n(e,i,s.match,!0).to.match(t)},s.notMatch=function(e,t,i){new n(e,i,s.notMatch,!0).to.not.match(t)},s.property=function(e,t,i){new n(e,i,s.property,!0).to.have.property(t)},s.notProperty=function(e,t,i){new n(e,i,s.notProperty,!0).to.not.have.property(t)},s.propertyVal=function(e,t,i,o){new n(e,o,s.propertyVal,!0).to.have.property(t,i)},s.notPropertyVal=function(e,t,i,o){new n(e,o,s.notPropertyVal,!0).to.not.have.property(t,i)},s.deepPropertyVal=function(e,t,i,o){new n(e,o,s.deepPropertyVal,!0).to.have.deep.property(t,i)},s.notDeepPropertyVal=function(e,t,i,o){new n(e,o,s.notDeepPropertyVal,!0).to.not.have.deep.property(t,i)},s.ownProperty=function(e,t,i){new n(e,i,s.ownProperty,!0).to.have.own.property(t)},s.notOwnProperty=function(e,t,i){new n(e,i,s.notOwnProperty,!0).to.not.have.own.property(t)},s.ownPropertyVal=function(e,t,i,o){new n(e,o,s.ownPropertyVal,!0).to.have.own.property(t,i)},s.notOwnPropertyVal=function(e,t,i,o){new n(e,o,s.notOwnPropertyVal,!0).to.not.have.own.property(t,i)},s.deepOwnPropertyVal=function(e,t,i,o){new n(e,o,s.deepOwnPropertyVal,!0).to.have.deep.own.property(t,i)},s.notDeepOwnPropertyVal=function(e,t,i,o){new n(e,o,s.notDeepOwnPropertyVal,!0).to.not.have.deep.own.property(t,i)},s.nestedProperty=function(e,t,i){new n(e,i,s.nestedProperty,!0).to.have.nested.property(t)},s.notNestedProperty=function(e,t,i){new n(e,i,s.notNestedProperty,!0).to.not.have.nested.property(t)},s.nestedPropertyVal=function(e,t,i,o){new n(e,o,s.nestedPropertyVal,!0).to.have.nested.property(t,i)},s.notNestedPropertyVal=function(e,t,i,o){new n(e,o,s.notNestedPropertyVal,!0).to.not.have.nested.property(t,i)},s.deepNestedPropertyVal=function(e,t,i,o){new n(e,o,s.deepNestedPropertyVal,!0).to.have.deep.nested.property(t,i)},s.notDeepNestedPropertyVal=function(e,t,i,o){new n(e,o,s.notDeepNestedPropertyVal,!0).to.not.have.deep.nested.property(t,i)},s.lengthOf=function(e,t,i){new n(e,i,s.lengthOf,!0).to.have.lengthOf(t)},s.hasAnyKeys=function(e,t,i){new n(e,i,s.hasAnyKeys,!0).to.have.any.keys(t)},s.hasAllKeys=function(e,t,i){new n(e,i,s.hasAllKeys,!0).to.have.all.keys(t)},s.containsAllKeys=function(e,t,i){new n(e,i,s.containsAllKeys,!0).to.contain.all.keys(t)},s.doesNotHaveAnyKeys=function(e,t,i){new n(e,i,s.doesNotHaveAnyKeys,!0).to.not.have.any.keys(t)},s.doesNotHaveAllKeys=function(e,t,i){new n(e,i,s.doesNotHaveAllKeys,!0).to.not.have.all.keys(t)},s.hasAnyDeepKeys=function(e,t,i){new n(e,i,s.hasAnyDeepKeys,!0).to.have.any.deep.keys(t)},s.hasAllDeepKeys=function(e,t,i){new n(e,i,s.hasAllDeepKeys,!0).to.have.all.deep.keys(t)},s.containsAllDeepKeys=function(e,t,i){new n(e,i,s.containsAllDeepKeys,!0).to.contain.all.deep.keys(t)},s.doesNotHaveAnyDeepKeys=function(e,t,i){new n(e,i,s.doesNotHaveAnyDeepKeys,!0).to.not.have.any.deep.keys(t)},s.doesNotHaveAllDeepKeys=function(e,t,i){new n(e,i,s.doesNotHaveAllDeepKeys,!0).to.not.have.all.deep.keys(t)},s.throws=function(e,t,o,r){("string"==typeof t||t instanceof RegExp)&&(o=t,t=null);var a=new n(e,r,s.throws,!0).to.throw(t,o);return i(a,"object")},s.doesNotThrow=function(e,t,i,o){("string"==typeof t||t instanceof RegExp)&&(i=t,t=null),new n(e,o,s.doesNotThrow,!0).to.not.throw(t,i)},s.operator=function(o,r,a,l){var c;switch(r){case"==":c=o==a;break;case"===":c=o===a;break;case">":c=o>a;break;case">=":c=o>=a;break;case"<":c=o<a;break;case"<=":c=o<=a;break;case"!=":c=o!=a;break;case"!==":c=o!==a;break;default:throw l=l?l+": ":l,new e.AssertionError(l+'Invalid operator "'+r+'"',void 0,s.operator)}var h=new n(c,l,s.operator,!0);h.assert(!0===i(h,"object"),"expected "+t.inspect(o)+" to be "+r+" "+t.inspect(a),"expected "+t.inspect(o)+" to not be "+r+" "+t.inspect(a))},s.closeTo=function(e,t,i,o){new n(e,o,s.closeTo,!0).to.be.closeTo(t,i)},s.approximately=function(e,t,i,o){new n(e,o,s.approximately,!0).to.be.approximately(t,i)},s.sameMembers=function(e,t,i){new n(e,i,s.sameMembers,!0).to.have.same.members(t)},s.notSameMembers=function(e,t,i){new n(e,i,s.notSameMembers,!0).to.not.have.same.members(t)},s.sameDeepMembers=function(e,t,i){new n(e,i,s.sameDeepMembers,!0).to.have.same.deep.members(t)},s.notSameDeepMembers=function(e,t,i){new n(e,i,s.notSameDeepMembers,!0).to.not.have.same.deep.members(t)},s.sameOrderedMembers=function(e,t,i){new n(e,i,s.sameOrderedMembers,!0).to.have.same.ordered.members(t)},s.notSameOrderedMembers=function(e,t,i){new n(e,i,s.notSameOrderedMembers,!0).to.not.have.same.ordered.members(t)},s.sameDeepOrderedMembers=function(e,t,i){new n(e,i,s.sameDeepOrderedMembers,!0).to.have.same.deep.ordered.members(t)},s.notSameDeepOrderedMembers=function(e,t,i){new n(e,i,s.notSameDeepOrderedMembers,!0).to.not.have.same.deep.ordered.members(t)},s.includeMembers=function(e,t,i){new n(e,i,s.includeMembers,!0).to.include.members(t)},s.notIncludeMembers=function(e,t,i){new n(e,i,s.notIncludeMembers,!0).to.not.include.members(t)},s.includeDeepMembers=function(e,t,i){new n(e,i,s.includeDeepMembers,!0).to.include.deep.members(t)},s.notIncludeDeepMembers=function(e,t,i){new n(e,i,s.notIncludeDeepMembers,!0).to.not.include.deep.members(t)},s.includeOrderedMembers=function(e,t,i){new n(e,i,s.includeOrderedMembers,!0).to.include.ordered.members(t)},s.notIncludeOrderedMembers=function(e,t,i){new n(e,i,s.notIncludeOrderedMembers,!0).to.not.include.ordered.members(t)},s.includeDeepOrderedMembers=function(e,t,i){new n(e,i,s.includeDeepOrderedMembers,!0).to.include.deep.ordered.members(t)},s.notIncludeDeepOrderedMembers=function(e,t,i){new n(e,i,s.notIncludeDeepOrderedMembers,!0).to.not.include.deep.ordered.members(t)},s.oneOf=function(e,t,i){new n(e,i,s.oneOf,!0).to.be.oneOf(t)},s.changes=function(e,t,i,o){3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.changes,!0).to.change(t,i)},s.changesBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.changesBy,!0).to.change(t,i).by(o)},s.doesNotChange=function(e,t,i,o){return 3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.doesNotChange,!0).to.not.change(t,i)},s.changesButNotBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.changesButNotBy,!0).to.change(t,i).but.not.by(o)},s.increases=function(e,t,i,o){return 3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.increases,!0).to.increase(t,i)},s.increasesBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.increasesBy,!0).to.increase(t,i).by(o)},s.doesNotIncrease=function(e,t,i,o){return 3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.doesNotIncrease,!0).to.not.increase(t,i)},s.increasesButNotBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.increasesButNotBy,!0).to.increase(t,i).but.not.by(o)},s.decreases=function(e,t,i,o){return 3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.decreases,!0).to.decrease(t,i)},s.decreasesBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.decreasesBy,!0).to.decrease(t,i).by(o)},s.doesNotDecrease=function(e,t,i,o){return 3===arguments.length&&"function"==typeof t&&(o=i,i=null),new n(e,o,s.doesNotDecrease,!0).to.not.decrease(t,i)},s.doesNotDecreaseBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);return new n(e,r,s.doesNotDecreaseBy,!0).to.not.decrease(t,i).by(o)},s.decreasesButNotBy=function(e,t,i,o,r){if(4===arguments.length&&"function"==typeof t){var a=o;o=i,r=a}else 3===arguments.length&&(o=i,i=null);new n(e,r,s.decreasesButNotBy,!0).to.decrease(t,i).but.not.by(o)},s.ifError=function(e){if(e)throw e},s.isExtensible=function(e,t){new n(e,t,s.isExtensible,!0).to.be.extensible},s.isNotExtensible=function(e,t){new n(e,t,s.isNotExtensible,!0).to.not.be.extensible},s.isSealed=function(e,t){new n(e,t,s.isSealed,!0).to.be.sealed},s.isNotSealed=function(e,t){new n(e,t,s.isNotSealed,!0).to.not.be.sealed},s.isFrozen=function(e,t){new n(e,t,s.isFrozen,!0).to.be.frozen},s.isNotFrozen=function(e,t){new n(e,t,s.isNotFrozen,!0).to.not.be.frozen},s.isEmpty=function(e,t){new n(e,t,s.isEmpty,!0).to.be.empty},s.isNotEmpty=function(e,t){new n(e,t,s.isNotEmpty,!0).to.not.be.empty},function e(t,n){return s[n]=s[t],e}("isOk","ok")("isNotOk","notOk")("throws","throw")("throws","Throw")("isExtensible","extensible")("isNotExtensible","notExtensible")("isSealed","sealed")("isNotSealed","notSealed")("isFrozen","frozen")("isNotFrozen","notFrozen")("isEmpty","empty")("isNotEmpty","notEmpty")}},"../node_modules/chai/lib/chai/interface/expect.js":e=>{e.exports=function(e,t){e.expect=function(t,n){return new e.Assertion(t,n)},e.expect.fail=function(t,n,i,s){throw arguments.length<2&&(i=t,t=void 0),i=i||"expect.fail()",new e.AssertionError(i,{actual:t,expected:n,operator:s},e.expect.fail)}}},"../node_modules/chai/lib/chai/interface/should.js":e=>{e.exports=function(e,t){var n=e.Assertion;function i(){Object.defineProperty(Object.prototype,"should",{set:function(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})},get:function e(){return this instanceof String||this instanceof Number||this instanceof Boolean||"function"==typeof Symbol&&this instanceof Symbol||"function"==typeof BigInt&&this instanceof BigInt?new n(this.valueOf(),null,e):new n(this,null,e)},configurable:!0});var t={fail:function(n,i,s,o){throw arguments.length<2&&(s=n,n=void 0),s=s||"should.fail()",new e.AssertionError(s,{actual:n,expected:i,operator:o},t.fail)},equal:function(e,t,i){new n(e,i).to.equal(t)},Throw:function(e,t,i,s){new n(e,s).to.Throw(t,i)},exist:function(e,t){new n(e,t).to.exist},not:{}};return t.not.equal=function(e,t,i){new n(e,i).to.not.equal(t)},t.not.Throw=function(e,t,i,s){new n(e,s).to.not.Throw(t,i)},t.not.exist=function(e,t){new n(e,t).to.not.exist},t.throw=t.Throw,t.not.throw=t.not.Throw,t}e.should=i,e.Should=i}},"../node_modules/chai/lib/chai/utils/addChainableMethod.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/addLengthGuard.js"),s=n("../node_modules/chai/lib/chai.js"),o=n("../node_modules/chai/lib/chai/utils/flag.js"),r=n("../node_modules/chai/lib/chai/utils/proxify.js"),a=n("../node_modules/chai/lib/chai/utils/transferFlags.js"),l="function"==typeof Object.setPrototypeOf,c=function(){},h=Object.getOwnPropertyNames(c).filter(function(e){var t=Object.getOwnPropertyDescriptor(c,e);return"object"!=typeof t||!t.configurable}),d=Function.prototype.call,u=Function.prototype.apply;e.exports=function(e,t,n,c){"function"!=typeof c&&(c=function(){});var p={method:n,chainingBehavior:c};e.__methods||(e.__methods={}),e.__methods[t]=p,Object.defineProperty(e,t,{get:function(){p.chainingBehavior.call(this);var n=function(){o(this,"lockSsfi")||o(this,"ssfi",n);var e=p.method.apply(this,arguments);if(void 0!==e)return e;var t=new s.Assertion;return a(this,t),t};if(i(n,t,!0),l){var c=Object.create(this);c.call=d,c.apply=u,Object.setPrototypeOf(n,c)}else Object.getOwnPropertyNames(e).forEach(function(t){if(-1===h.indexOf(t)){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i)}});return a(this,n),r(n)},configurable:!0})}},"../node_modules/chai/lib/chai/utils/addLengthGuard.js":e=>{var t=Object.getOwnPropertyDescriptor(function(){},"length");e.exports=function(e,n,i){return t.configurable?(Object.defineProperty(e,"length",{get:function(){if(i)throw Error("Invalid Chai property: "+n+'.length. Due to a compatibility issue, "length" cannot directly follow "'+n+'". Use "'+n+'.lengthOf" instead.');throw Error("Invalid Chai property: "+n+'.length. See docs for proper usage of "'+n+'".')}}),e):e}},"../node_modules/chai/lib/chai/utils/addMethod.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/addLengthGuard.js"),s=n("../node_modules/chai/lib/chai.js"),o=n("../node_modules/chai/lib/chai/utils/flag.js"),r=n("../node_modules/chai/lib/chai/utils/proxify.js"),a=n("../node_modules/chai/lib/chai/utils/transferFlags.js");e.exports=function(e,t,n){var l=function(){o(this,"lockSsfi")||o(this,"ssfi",l);var e=n.apply(this,arguments);if(void 0!==e)return e;var t=new s.Assertion;return a(this,t),t};i(l,t,!1),e[t]=r(l,t)}},"../node_modules/chai/lib/chai/utils/addProperty.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai.js"),s=n("../node_modules/chai/lib/chai/utils/flag.js"),o=n("../node_modules/chai/lib/chai/utils/isProxyEnabled.js"),r=n("../node_modules/chai/lib/chai/utils/transferFlags.js");e.exports=function(e,t,n){n=void 0===n?function(){}:n,Object.defineProperty(e,t,{get:function e(){o()||s(this,"lockSsfi")||s(this,"ssfi",e);var t=n.call(this);if(void 0!==t)return t;var a=new i.Assertion;return r(this,a),a},configurable:!0})}},"../node_modules/chai/lib/chai/utils/compareByInspect.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/inspect.js");e.exports=function(e,t){return i(e)<i(t)?-1:1}},"../node_modules/chai/lib/chai/utils/expectTypes.js":(e,t,n)=>{var i=n("../node_modules/assertion-error/index.js"),s=n("../node_modules/chai/lib/chai/utils/flag.js"),o=n("../node_modules/type-detect/type-detect.js");e.exports=function(e,t){var n=s(e,"message"),r=s(e,"ssfi");n=n?n+": ":"",e=s(e,"object"),(t=t.map(function(e){return e.toLowerCase()})).sort();var a=t.map(function(e,n){var i=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an":"a";return(t.length>1&&n===t.length-1?"or ":"")+i+" "+e}).join(", "),l=o(e).toLowerCase();if(!t.some(function(e){return l===e}))throw new i(n+"object tested must be "+a+", but "+l+" given",void 0,r)}},"../node_modules/chai/lib/chai/utils/flag.js":e=>{e.exports=function(e,t,n){var i=e.__flags||(e.__flags=Object.create(null));if(3!==arguments.length)return i[t];i[t]=n}},"../node_modules/chai/lib/chai/utils/getActual.js":e=>{e.exports=function(e,t){return t.length>4?t[4]:e._obj}},"../node_modules/chai/lib/chai/utils/getMessage.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/flag.js"),s=n("../node_modules/chai/lib/chai/utils/getActual.js"),o=n("../node_modules/chai/lib/chai/utils/objDisplay.js");e.exports=function(e,t){var n=i(e,"negate"),r=i(e,"object"),a=t[3],l=s(e,t),c=n?t[2]:t[1],h=i(e,"message");return"function"==typeof c&&(c=c()),c=(c=c||"").replace(/#\{this\}/g,function(){return o(r)}).replace(/#\{act\}/g,function(){return o(l)}).replace(/#\{exp\}/g,function(){return o(a)}),h?h+": "+c:c}},"../node_modules/chai/lib/chai/utils/getOperator.js":(e,t,n)=>{var i=n("../node_modules/type-detect/type-detect.js"),s=n("../node_modules/chai/lib/chai/utils/flag.js");e.exports=function(e,t){var n=s(e,"operator"),o=s(e,"negate"),r=t[3],a=o?t[2]:t[1];if(n)return n;if("function"==typeof a&&(a=a()),(a=a||"")&&!/\shave\s/.test(a)){var l=function(e){var t=i(e);return-1!==["Array","Object","function"].indexOf(t)}(r);return/\snot\s/.test(a)?l?"notDeepStrictEqual":"notStrictEqual":l?"deepStrictEqual":"strictEqual"}}},"../node_modules/chai/lib/chai/utils/getOwnEnumerableProperties.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/getOwnEnumerablePropertySymbols.js");e.exports=function(e){return Object.keys(e).concat(i(e))}},"../node_modules/chai/lib/chai/utils/getOwnEnumerablePropertySymbols.js":e=>{e.exports=function(e){return"function"!=typeof Object.getOwnPropertySymbols?[]:Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}},"../node_modules/chai/lib/chai/utils/getProperties.js":e=>{e.exports=function(e){var t=Object.getOwnPropertyNames(e);function n(e){-1===t.indexOf(e)&&t.push(e)}for(var i=Object.getPrototypeOf(e);null!==i;)Object.getOwnPropertyNames(i).forEach(n),i=Object.getPrototypeOf(i);return t}},"../node_modules/chai/lib/chai/utils/index.js":(e,t,n)=>{var i=n("../node_modules/pathval/index.js");t.test=n("../node_modules/chai/lib/chai/utils/test.js"),t.type=n("../node_modules/type-detect/type-detect.js"),t.expectTypes=n("../node_modules/chai/lib/chai/utils/expectTypes.js"),t.getMessage=n("../node_modules/chai/lib/chai/utils/getMessage.js"),t.getActual=n("../node_modules/chai/lib/chai/utils/getActual.js"),t.inspect=n("../node_modules/chai/lib/chai/utils/inspect.js"),t.objDisplay=n("../node_modules/chai/lib/chai/utils/objDisplay.js"),t.flag=n("../node_modules/chai/lib/chai/utils/flag.js"),t.transferFlags=n("../node_modules/chai/lib/chai/utils/transferFlags.js"),t.eql=n("../node_modules/deep-eql/index.js"),t.getPathInfo=i.getPathInfo,t.hasProperty=i.hasProperty,t.getName=n("../node_modules/get-func-name/index.js"),t.addProperty=n("../node_modules/chai/lib/chai/utils/addProperty.js"),t.addMethod=n("../node_modules/chai/lib/chai/utils/addMethod.js"),t.overwriteProperty=n("../node_modules/chai/lib/chai/utils/overwriteProperty.js"),t.overwriteMethod=n("../node_modules/chai/lib/chai/utils/overwriteMethod.js"),t.addChainableMethod=n("../node_modules/chai/lib/chai/utils/addChainableMethod.js"),t.overwriteChainableMethod=n("../node_modules/chai/lib/chai/utils/overwriteChainableMethod.js"),t.compareByInspect=n("../node_modules/chai/lib/chai/utils/compareByInspect.js"),t.getOwnEnumerablePropertySymbols=n("../node_modules/chai/lib/chai/utils/getOwnEnumerablePropertySymbols.js"),t.getOwnEnumerableProperties=n("../node_modules/chai/lib/chai/utils/getOwnEnumerableProperties.js"),t.checkError=n("../node_modules/check-error/index.js"),t.proxify=n("../node_modules/chai/lib/chai/utils/proxify.js"),t.addLengthGuard=n("../node_modules/chai/lib/chai/utils/addLengthGuard.js"),t.isProxyEnabled=n("../node_modules/chai/lib/chai/utils/isProxyEnabled.js"),t.isNaN=n("../node_modules/chai/lib/chai/utils/isNaN.js"),t.getOperator=n("../node_modules/chai/lib/chai/utils/getOperator.js")},"../node_modules/chai/lib/chai/utils/inspect.js":(e,t,n)=>{n("../node_modules/get-func-name/index.js");var i=n("../node_modules/loupe/loupe.js"),s=n("../node_modules/chai/lib/chai/config.js");e.exports=function(e,t,n,o){var r={colors:o,depth:void 0===n?2:n,showHidden:t,truncate:s.truncateThreshold?s.truncateThreshold:1/0};return i.inspect(e,r)}},"../node_modules/chai/lib/chai/utils/isNaN.js":e=>{e.exports=Number.isNaN||function(e){return e!=e}},"../node_modules/chai/lib/chai/utils/isProxyEnabled.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/config.js");e.exports=function(){return i.useProxy&&"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect}},"../node_modules/chai/lib/chai/utils/objDisplay.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/inspect.js"),s=n("../node_modules/chai/lib/chai/config.js");e.exports=function(e){var t=i(e),n=Object.prototype.toString.call(e);if(s.truncateThreshold&&t.length>=s.truncateThreshold){if("[object Function]"===n)return e.name&&""!==e.name?"[Function: "+e.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+e.length+") ]";if("[object Object]"===n){var o=Object.keys(e);return"{ Object ("+(o.length>2?o.splice(0,2).join(", ")+", ...":o.join(", "))+") }"}return t}return t}},"../node_modules/chai/lib/chai/utils/overwriteChainableMethod.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai.js"),s=n("../node_modules/chai/lib/chai/utils/transferFlags.js");e.exports=function(e,t,n,o){var r=e.__methods[t],a=r.chainingBehavior;r.chainingBehavior=function(){var e=o(a).call(this);if(void 0!==e)return e;var t=new i.Assertion;return s(this,t),t};var l=r.method;r.method=function(){var e=n(l).apply(this,arguments);if(void 0!==e)return e;var t=new i.Assertion;return s(this,t),t}}},"../node_modules/chai/lib/chai/utils/overwriteMethod.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/addLengthGuard.js"),s=n("../node_modules/chai/lib/chai.js"),o=n("../node_modules/chai/lib/chai/utils/flag.js"),r=n("../node_modules/chai/lib/chai/utils/proxify.js"),a=n("../node_modules/chai/lib/chai/utils/transferFlags.js");e.exports=function(e,t,n){var l=e[t],c=function(){throw new Error(t+" is not a function")};l&&"function"==typeof l&&(c=l);var h=function(){o(this,"lockSsfi")||o(this,"ssfi",h);var e=o(this,"lockSsfi");o(this,"lockSsfi",!0);var t=n(c).apply(this,arguments);if(o(this,"lockSsfi",e),void 0!==t)return t;var i=new s.Assertion;return a(this,i),i};i(h,t,!1),e[t]=r(h,t)}},"../node_modules/chai/lib/chai/utils/overwriteProperty.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai.js"),s=n("../node_modules/chai/lib/chai/utils/flag.js"),o=n("../node_modules/chai/lib/chai/utils/isProxyEnabled.js"),r=n("../node_modules/chai/lib/chai/utils/transferFlags.js");e.exports=function(e,t,n){var a=Object.getOwnPropertyDescriptor(e,t),l=function(){};a&&"function"==typeof a.get&&(l=a.get),Object.defineProperty(e,t,{get:function e(){o()||s(this,"lockSsfi")||s(this,"ssfi",e);var t=s(this,"lockSsfi");s(this,"lockSsfi",!0);var a=n(l).call(this);if(s(this,"lockSsfi",t),void 0!==a)return a;var c=new i.Assertion;return r(this,c),c},configurable:!0})}},"../node_modules/chai/lib/chai/utils/proxify.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/config.js"),s=n("../node_modules/chai/lib/chai/utils/flag.js"),o=n("../node_modules/chai/lib/chai/utils/getProperties.js"),r=n("../node_modules/chai/lib/chai/utils/isProxyEnabled.js"),a=["__flags","__methods","_obj","assert"];e.exports=function(e,t){return r()?new Proxy(e,{get:function e(n,r){if("string"==typeof r&&-1===i.proxyExcludedKeys.indexOf(r)&&!Reflect.has(n,r)){if(t)throw Error("Invalid Chai property: "+t+"."+r+'. See docs for proper usage of "'+t+'".');var l=null,c=4;throw o(n).forEach(function(e){if(!Object.prototype.hasOwnProperty(e)&&-1===a.indexOf(e)){var t=function(e,t,n){if(Math.abs(e.length-t.length)>=n)return n;for(var i=[],s=0;s<=e.length;s++)i[s]=Array(t.length+1).fill(0),i[s][0]=s;for(var o=0;o<t.length;o++)i[0][o]=o;for(s=1;s<=e.length;s++){var r=e.charCodeAt(s-1);for(o=1;o<=t.length;o++)Math.abs(s-o)>=n?i[s][o]=n:i[s][o]=Math.min(i[s-1][o]+1,i[s][o-1]+1,i[s-1][o-1]+(r===t.charCodeAt(o-1)?0:1))}return i[e.length][t.length]}(r,e,c);t<c&&(l=e,c=t)}}),null!==l?Error("Invalid Chai property: "+r+'. Did you mean "'+l+'"?'):Error("Invalid Chai property: "+r)}return-1!==a.indexOf(r)||s(n,"lockSsfi")||s(n,"ssfi",e),Reflect.get(n,r)}}):e}},"../node_modules/chai/lib/chai/utils/test.js":(e,t,n)=>{var i=n("../node_modules/chai/lib/chai/utils/flag.js");e.exports=function(e,t){var n=i(e,"negate"),s=t[0];return n?!s:s}},"../node_modules/chai/lib/chai/utils/transferFlags.js":e=>{e.exports=function(e,t,n){var i=e.__flags||(e.__flags=Object.create(null));for(var s in t.__flags||(t.__flags=Object.create(null)),n=3!==arguments.length||n,i)(n||"object"!==s&&"ssfi"!==s&&"lockSsfi"!==s&&"message"!=s)&&(t.__flags[s]=i[s])}},"../node_modules/check-error/index.js":e=>{"use strict";var t=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\(\/]+)/;function n(e){var n="";if(void 0===e.name){var i=String(e).match(t);i&&(n=i[1])}else n=e.name;return n}e.exports={compatibleInstance:function(e,t){return t instanceof Error&&e===t},compatibleConstructor:function(e,t){return t instanceof Error?e.constructor===t.constructor||e instanceof t.constructor:(t.prototype instanceof Error||t===Error)&&(e.constructor===t||e instanceof t)},compatibleMessage:function(e,t){var n="string"==typeof e?e:e.message;return t instanceof RegExp?t.test(n):"string"==typeof t&&-1!==n.indexOf(t)},getMessage:function(e){var t="";return e&&e.message?t=e.message:"string"==typeof e&&(t=e),t},getConstructorName:function(e){var t=e;return e instanceof Error?t=n(e.constructor):"function"==typeof e&&(t=n(e).trim()||n(new e)),t}}},"../node_modules/decode-uri-component/index.js":e=>{"use strict";var t="%[a-f0-9]{2}",n=new RegExp("("+t+")|([^%]+?)","gi"),i=new RegExp("("+t+")+","gi");function s(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],s(n),s(i))}function o(e){try{return decodeURIComponent(e)}catch(o){for(var t=e.match(n)||[],i=1;i<t.length;i++)t=(e=s(t,i).join("")).match(n)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var s=o(n[0]);s!==n[0]&&(t[n[0]]=s)}n=i.exec(e)}t["%C2"]="";for(var r=Object.keys(t),a=0;a<r.length;a++){var l=r[a];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},"../node_modules/deep-eql/index.js":(e,t,n)=>{"use strict";var i=n("../node_modules/type-detect/type-detect.js");function s(){this._key="chai/deep-eql__"+Math.random()+Date.now()}s.prototype={get:function(e){return e[this._key]},set:function(e,t){Object.isExtensible(e)&&Object.defineProperty(e,this._key,{value:t,configurable:!0})}};var o="function"==typeof WeakMap?WeakMap:s;function r(e,t,n){if(!n||y(e)||y(t))return null;var i=n.get(e);if(i){var s=i.get(t);if("boolean"==typeof s)return s}return null}function a(e,t,n,i){if(n&&!y(e)&&!y(t)){var s=n.get(e);s?s.set(t,i):((s=new o).set(t,i),n.set(e,s))}}function l(e,t,n){if(n&&n.comparator)return h(e,t,n);var i=c(e,t);return null!==i?i:h(e,t,n)}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t||!y(e)&&!y(t)&&null}function h(e,t,n){(n=n||{}).memoize=!1!==n.memoize&&(n.memoize||new o);var s=n&&n.comparator,h=r(e,t,n.memoize);if(null!==h)return h;var y=r(t,e,n.memoize);if(null!==y)return y;if(s){var v=s(e,t);if(!1===v||!0===v)return a(e,t,n.memoize,v),v;var w=c(e,t);if(null!==w)return w}var x=i(e);if(x!==i(t))return a(e,t,n.memoize,!1),!1;a(e,t,n.memoize,!0);var k=function(e,t,n,i){switch(n){case"String":case"Number":case"Boolean":case"Date":return l(e.valueOf(),t.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":return e===t;case"Error":return g(e,t,["name","message","code"],i);case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return d(e,t,i);case"RegExp":return function(e,t){return e.toString()===t.toString()}(e,t);case"Generator":return function(e,t,n){return d(p(e),p(t),n)}(e,t,i);case"DataView":return d(new Uint8Array(e.buffer),new Uint8Array(t.buffer),i);case"ArrayBuffer":return d(new Uint8Array(e),new Uint8Array(t),i);case"Set":case"Map":return function(e,t,n){if(e.size!==t.size)return!1;if(0===e.size)return!0;var i=[],s=[];return e.forEach(function(e,t){i.push([e,t])}),t.forEach(function(e,t){s.push([e,t])}),d(i.sort(),s.sort(),n)}(e,t,i);case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.Instant":case"Temporal.ZonedDateTime":case"Temporal.PlainYearMonth":case"Temporal.PlainMonthDay":return e.equals(t);case"Temporal.Duration":return e.total("nanoseconds")===t.total("nanoseconds");case"Temporal.TimeZone":case"Temporal.Calendar":return e.toString()===t.toString();default:return function(e,t,n){var i=f(e),s=f(t),o=m(e),r=m(t);if(i=i.concat(o),s=s.concat(r),i.length&&i.length===s.length)return!1!==d(b(i).sort(),b(s).sort())&&g(e,t,i,n);var a=u(e),l=u(t);return a.length&&a.length===l.length?(a.sort(),l.sort(),d(a,l,n)):0===i.length&&0===a.length&&0===s.length&&0===l.length}(e,t,i)}}(e,t,x,n);return a(e,t,n.memoize,k),k}function d(e,t,n){var i=e.length;if(i!==t.length)return!1;if(0===i)return!0;for(var s=-1;++s<i;)if(!1===l(e[s],t[s],n))return!1;return!0}function u(e){if(function(e){return"undefined"!=typeof Symbol&&"object"==typeof e&&void 0!==Symbol.iterator&&"function"==typeof e[Symbol.iterator]}(e))try{return p(e[Symbol.iterator]())}catch(e){return[]}return[]}function p(e){for(var t=e.next(),n=[t.value];!1===t.done;)t=e.next(),n.push(t.value);return n}function f(e){var t=[];for(var n in e)t.push(n);return t}function m(e){for(var t=[],n=Object.getOwnPropertySymbols(e),i=0;i<n.length;i+=1){var s=n[i];Object.getOwnPropertyDescriptor(e,s).enumerable&&t.push(s)}return t}function g(e,t,n,i){var s=n.length;if(0===s)return!0;for(var o=0;o<s;o+=1)if(!1===l(e[n[o]],t[n[o]],i))return!1;return!0}function y(e){return null===e||"object"!=typeof e}function b(e){return e.map(function(e){return"symbol"==typeof e?e.toString():e})}e.exports=l,e.exports.MemoizeMap=o},"../node_modules/dijkstrajs/dijkstra.js":e=>{"use strict";var t={single_source_shortest_paths:function(e,n,i){var s={},o={};o[n]=0;var r,a,l,c,h,d,u,p=t.PriorityQueue.make();for(p.push(n,0);!p.empty();)for(l in a=(r=p.pop()).value,c=r.cost,h=e[a]||{})h.hasOwnProperty(l)&&(d=c+h[l],u=o[l],(void 0===o[l]||u>d)&&(o[l]=d,p.push(l,d),s[l]=a));if(void 0!==i&&void 0===o[i]){var f=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(f)}return s},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],i=t;i;)n.push(i),e[i],i=e[i];return n.reverse(),n},find_path:function(e,n,i){var s=t.single_source_shortest_paths(e,n,i);return t.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(e){var n,i=t.PriorityQueue,s={};for(n in e=e||{},i)i.hasOwnProperty(n)&&(s[n]=i[n]);return s.queue=[],s.sorter=e.sorter||i.default_sorter,s},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},"../node_modules/encode-utf8/index.js":e=>{"use strict";e.exports=function(e){for(var t=[],n=e.length,i=0;i<n;i++){var s=e.charCodeAt(i);if(s>=55296&&s<=56319&&n>i+1){var o=e.charCodeAt(i+1);o>=56320&&o<=57343&&(s=1024*(s-55296)+o-56320+65536,i+=1)}s<128?t.push(s):s<2048?(t.push(s>>6|192),t.push(63&s|128)):s<55296||s>=57344&&s<65536?(t.push(s>>12|224),t.push(s>>6&63|128),t.push(63&s|128)):s>=65536&&s<=1114111?(t.push(s>>18|240),t.push(s>>12&63|128),t.push(s>>6&63|128),t.push(63&s|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},"../node_modules/eventemitter3/index.js":e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function i(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,i,o,r){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new s(i,o||e,r),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function r(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,i,s=[];if(0===this._eventsCount)return s;for(i in e=this._events)t.call(e,i)&&s.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,o=i.length,r=new Array(o);s<o;s++)r[s]=i[s].fn;return r},a.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,s,o,r){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,h=this._events[a],d=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),d){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,s),!0;case 5:return h.fn.call(h.context,t,i,s,o),!0;case 6:return h.fn.call(h.context,t,i,s,o,r),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];h.fn.apply(h.context,l)}else{var u,p=h.length;for(c=0;c<p;c++)switch(h[c].once&&this.removeListener(e,h[c].fn,void 0,!0),d){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,t);break;case 3:h[c].fn.call(h[c].context,t,i);break;case 4:h[c].fn.call(h[c].context,t,i,s);break;default:if(!l)for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];h[c].fn.apply(h[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,i,s){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return r(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||s&&!a.once||i&&a.context!==i||r(this,o);else{for(var l=0,c=[],h=a.length;l<h;l++)(a[l].fn!==t||s&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:r(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&r(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},"../node_modules/filter-obj/index.js":e=>{"use strict";e.exports=function(e,t){for(var n={},i=Object.keys(e),s=Array.isArray(t),o=0;o<i.length;o++){var r=i[o],a=e[r];(s?-1!==t.indexOf(r):t(r,a,e))&&(n[r]=a)}return n}},"../node_modules/get-func-name/index.js":e=>{"use strict";var t=Function.prototype.toString,n=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\s\(\/]+)/;e.exports=function(e){if("function"!=typeof e)return null;var i="";if(void 0===Function.prototype.name&&void 0===e.name){var s=t.call(e).match(n);s&&(i=s[1])}else i=e.name;return i}},"../node_modules/isarray/index.js":e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},"../node_modules/loglevel/lib/loglevel.js":function(e,t,n){var i,s;!function(){"use strict";i=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function r(t,n){for(var s=0;s<i.length;s++){var o=i[s];this[o]=s<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function a(e,n,i){return function(){typeof console!==t&&(r.call(this,n,i),this[e].apply(this,arguments))}}function l(i,r,l){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?o:void 0!==console[i]?s(console,i):void 0!==console.log?s(console,"log"):e)}(i)||a.apply(this,arguments)}function c(e,n,s){var o,a=this;n=null==n?"WARN":n;var c="loglevel";function h(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(c)+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=s||l,a.getLevel=function(){return o},a.setLevel=function(n,s){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==s&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),r.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,h()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),function(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=h();null==d&&(d=n),a.setLevel(d,!1)}var h=new c,d={};h.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new c(e,h.getLevel(),h.methodFactory)),t};var u=typeof window!==t?window.log:void 0;return h.noConflict=function(){return typeof window!==t&&window.log===h&&(window.log=u),h},h.getLoggers=function(){return d},h.default=h,h},void 0===(s=i.call(t,n,t,e))||(e.exports=s)}()},"../node_modules/loupe/loupe.js":function(e,t,n){!function(e){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,s=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o={bold:["1","22"],dim:["2","22"],italic:["3","23"],underline:["4","24"],inverse:["7","27"],hidden:["8","28"],strike:["9","29"],black:["30","39"],red:["31","39"],green:["32","39"],yellow:["33","39"],blue:["34","39"],magenta:["35","39"],cyan:["36","39"],white:["37","39"],brightblack:["30;1","39"],brightred:["31;1","39"],brightgreen:["32;1","39"],brightyellow:["33;1","39"],brightblue:["34;1","39"],brightmagenta:["35;1","39"],brightcyan:["36;1","39"],brightwhite:["37;1","39"],grey:["90","39"]},r={special:"cyan",number:"yellow",bigint:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",symbol:"green",date:"magenta",regexp:"red"},a="";function l(e,t){var n=o[r[t]]||o[t];return n?"[".concat(n[0],"m").concat(String(e),"[").concat(n[1],"m"):String(e)}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a;e=String(e);var i=n.length,s=e.length;return i>t&&s>i?n:s>t&&s>i?"".concat(e.slice(0,t-i)).concat(n):e}function h(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:", ";n=n||t.inspect;var s=e.length;if(0===s)return"";for(var o=t.truncate,r="",l="",c="",h=0;h<s;h+=1){var d=h+1===e.length,u=h+2===e.length;c="".concat(a,"(").concat(e.length-h,")");var p=e[h];t.truncate=o-r.length-(d?0:i.length);var f=l||n(p,t)+(d?"":i),m=r.length+f.length,g=m+c.length;if(d&&m>o&&r.length+c.length<=o)break;if(!d&&!u&&g>o)break;if(l=d?"":n(e[h+1],t)+(u?"":i),!d&&u&&g>o&&m+l.length>o)break;if(r+=f,!d&&!u&&m+l.length>=o){c="".concat(a,"(").concat(e.length-h-1,")");break}c=""}return"".concat(r).concat(c)}function d(e,t){var n=i(e,2),s=n[0],o=n[1];return t.truncate-=2,"string"==typeof s?s=function(e){return e.match(/^[a-zA-Z_][a-zA-Z_0-9]*$/)?e:JSON.stringify(e).replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'")}(s):"number"!=typeof s&&(s="[".concat(t.inspect(s,t),"]")),t.truncate-=s.length,o=t.inspect(o,t),"".concat(s,": ").concat(o)}var u=Function.prototype.toString,p=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\s\(\/]+)/;var f=function(e){if("function"!=typeof e)return null;var t="";if(void 0===Function.prototype.name&&void 0===e.name){var n=u.call(e).match(p);n&&(t=n[1])}else t=e.name;return t};function m(e,t){var n=function(e){return"function"==typeof Buffer&&e instanceof Buffer?"Buffer":e[Symbol.toStringTag]?e[Symbol.toStringTag]:f(e.constructor)}(e);t.truncate-=n.length+4;var i=Object.keys(e).slice(e.length);if(!e.length&&!i.length)return"".concat(n,"[]");for(var s="",o=0;o<e.length;o++){var r="".concat(t.stylize(c(e[o],t.truncate),"number")).concat(o===e.length-1?"":", ");if(t.truncate-=r.length,e[o]!==e.length&&t.truncate<=3){s+="".concat(a,"(").concat(e.length-e[o]+1,")");break}s+=r}var l="";return i.length&&(l=h(i.map(function(t){return[t,e[t]]}),t,d)),"".concat(n,"[ ").concat(s).concat(l?", ".concat(l):""," ]")}function g(e,t){var n=f(e);return n?t.stylize("[Function ".concat(c(n,t.truncate-11),"]"),"special"):t.stylize("[Function]","special")}function y(e,t){var n=i(e,2),s=n[0],o=n[1];return t.truncate-=4,s=t.inspect(s,t),t.truncate-=s.length,o=t.inspect(o,t),"".concat(s," => ").concat(o)}var b=Number.isNaN||function(e){return e!=e};function v(e,t){return b(e)?t.stylize("NaN","number"):e===1/0?t.stylize("Infinity","number"):e===-1/0?t.stylize("-Infinity","number"):0===e?t.stylize(1/e==1/0?"+0":"-0","number"):t.stylize(c(e,t.truncate),"number")}function w(e,t){var n=c(e.toString(),t.truncate-1);return n!==a&&(n+="n"),t.stylize(n,"bigint")}var x=new RegExp("['\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]","g"),k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};function S(e){return k[e]||"\\u".concat("0000".concat(e.charCodeAt(0).toString(16)).slice(-4))}function _(e,t){return x.test(e)&&(e=e.replace(x,S)),t.stylize("'".concat(c(e,t.truncate-2),"'"),"string")}function P(e){return"description"in Symbol.prototype?e.description?"Symbol(".concat(e.description,")"):"Symbol()":e.toString()}var M=function(){return"Promise{}"};try{var j=process.binding("util"),E=j.getPromiseDetails,T=j.kPending,C=j.kRejected;Array.isArray(E(Promise.resolve()))&&(M=function(e,t){var n=i(E(e),2),s=n[0],o=n[1];return s===T?"Promise{<pending>}":"Promise".concat(s===C?"!":"","{").concat(t.inspect(o,t),"}")})}catch(e){}var I=M;function A(e,t){var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[];if(0===n.length&&0===i.length)return"{}";if(t.truncate-=4,t.seen=t.seen||[],t.seen.indexOf(e)>=0)return"[Circular]";t.seen.push(e);var s=h(n.map(function(t){return[t,e[t]]}),t,d),o=h(i.map(function(t){return[t,e[t]]}),t,d);t.seen.pop();var r="";return s&&o&&(r=", "),"{ ".concat(s).concat(r).concat(o," }")}var N=!("undefined"==typeof Symbol||!Symbol.toStringTag)&&Symbol.toStringTag;var O=["stack","line","column","name","message","fileName","lineNumber","columnNumber","number","description"];function R(e,t){var n=i(e,2),s=n[0],o=n[1];return t.truncate-=3,o?"".concat(t.stylize(s,"yellow"),"=").concat(t.stylize('"'.concat(o,'"'),"string")):"".concat(t.stylize(s,"yellow"))}function L(e,t){return h(e,t,D,"\n")}function D(e,t){var n=e.getAttributeNames(),i=e.tagName.toLowerCase(),s=t.stylize("<".concat(i),"special"),o=t.stylize(">","special"),r=t.stylize("</".concat(i,">"),"special");t.truncate-=2*i.length+5;var l="";n.length>0&&(l+=" ",l+=h(n.map(function(t){return[t,e.getAttribute(t)]}),t,R," ")),t.truncate-=l.length;var c=t.truncate,d=L(e.children,t);return d&&d.length>c&&(d="".concat(a,"(").concat(e.children.length,")")),"".concat(s).concat(l).concat(o).concat(d).concat(r)}var z="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("chai/inspect"):"@@chai/inspect",B=!1;try{var U=n("?9a07");B=!!U.inspect&&U.inspect.custom}catch(e){B=!1}function $(){this.key="chai/loupe__"+Math.random()+Date.now()}$.prototype={get:function(e){return e[this.key]},has:function(e){return this.key in e},set:function(e,t){Object.isExtensible(e)&&Object.defineProperty(e,this.key,{value:t,configurable:!0})}};var q=new("function"==typeof WeakMap?WeakMap:$),F={},V={undefined:function(e,t){return t.stylize("undefined","undefined")},null:function(e,t){return t.stylize(null,"null")},boolean:function(e,t){return t.stylize(e,"boolean")},Boolean:function(e,t){return t.stylize(e,"boolean")},number:v,Number:v,bigint:w,BigInt:w,string:_,String:_,function:g,Function:g,symbol:P,Symbol:P,Array:function(e,t){var n=Object.keys(e).slice(e.length);if(!e.length&&!n.length)return"[]";t.truncate-=4;var i=h(e,t);t.truncate-=i.length;var s="";return n.length&&(s=h(n.map(function(t){return[t,e[t]]}),t,d)),"[ ".concat(i).concat(s?", ".concat(s):""," ]")},Date:function(e,t){var n=e.toJSON();if(null===n)return"Invalid Date";var i=n.split("T"),s=i[0];return t.stylize("".concat(s,"T").concat(c(i[1],t.truncate-s.length-1)),"date")},Map:function(e,t){return e.size-1<=0?"Map{}":(t.truncate-=7,"Map{ ".concat(h(function(e){var t=[];return e.forEach(function(e,n){t.push([n,e])}),t}(e),t,y)," }"))},Set:function(e,t){return 0===e.size?"Set{}":(t.truncate-=7,"Set{ ".concat(h(function(e){var t=[];return e.forEach(function(e){t.push(e)}),t}(e),t)," }"))},RegExp:function(e,t){var n=e.toString().split("/")[2],i=t.truncate-(2+n.length),s=e.source;return t.stylize("/".concat(c(s,i),"/").concat(n),"regexp")},Promise:I,WeakSet:function(e,t){return t.stylize("WeakSet{}","special")},WeakMap:function(e,t){return t.stylize("WeakMap{}","special")},Arguments:function(e,t){return 0===e.length?"Arguments[]":(t.truncate-=13,"Arguments[ ".concat(h(e,t)," ]"))},Int8Array:m,Uint8Array:m,Uint8ClampedArray:m,Int16Array:m,Uint16Array:m,Int32Array:m,Uint32Array:m,Float32Array:m,Float64Array:m,Generator:function(){return""},DataView:function(){return""},ArrayBuffer:function(){return""},Error:function(e,t){var n=Object.getOwnPropertyNames(e).filter(function(e){return-1===O.indexOf(e)}),i=e.name;t.truncate-=i.length;var s="";"string"==typeof e.message?s=c(e.message,t.truncate):n.unshift("message"),s=s?": ".concat(s):"",t.truncate-=s.length+5;var o=h(n.map(function(t){return[t,e[t]]}),t,d);return"".concat(i).concat(s).concat(o?" { ".concat(o," }"):"")},HTMLCollection:L,NodeList:L},H=Object.prototype.toString;function W(e,n){(n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.showHidden,n=void 0!==t&&t,i=e.depth,s=void 0===i?2:i,o=e.colors,r=void 0!==o&&o,a=e.customInspect,c=void 0===a||a,h=e.showProxy,d=void 0!==h&&h,u=e.maxArrayLength,p=void 0===u?1/0:u,f=e.breakLength,m=void 0===f?1/0:f,g=e.seen,y=void 0===g?[]:g,b=e.truncate,v=void 0===b?1/0:b,w=e.stylize,x=void 0===w?String:w,k={showHidden:Boolean(n),depth:Number(s),colors:Boolean(r),customInspect:Boolean(c),showProxy:Boolean(d),maxArrayLength:Number(p),breakLength:Number(m),truncate:Number(v),seen:y,stylize:x};return k.colors&&(k.stylize=l),k}(n)).inspect=W;var i=n.customInspect,s=null===e?"null":t(e);if("object"===s&&(s=H.call(e).slice(8,-1)),V[s])return V[s](e,n);if(i&&e){var o=function(e,t,n){return z in e&&"function"==typeof e[z]?e[z](t):B&&B in e&&"function"==typeof e[B]?e[B](t.depth,t):"inspect"in e&&"function"==typeof e.inspect?e.inspect(t.depth,t):"constructor"in e&&q.has(e.constructor)?q.get(e.constructor)(e,t):F[n]?F[n](e,t):""}(e,n,s);if(o)return"string"==typeof o?o:W(o,n)}var r=!!e&&Object.getPrototypeOf(e);return r===Object.prototype||null===r?A(e,n):e&&"function"==typeof HTMLElement&&e instanceof HTMLElement?D(e,n):"constructor"in e?e.constructor!==Object?function(e,t){var n="";return N&&N in e&&(n=e[N]),(n=n||f(e.constructor))&&"_class"!==n||(n="<Anonymous Class>"),t.truncate-=n.length,"".concat(n).concat(A(e,t))}(e,n):A(e,n):e===Object(e)?A(e,n):n.stylize(String(e),s)}var G=z;e.custom=G,e.default=W,e.inspect=W,e.registerConstructor=function(e,t){return!q.has(e)&&(q.set(e,t),!0)},e.registerStringTag=function(e,t){return!(e in F)&&(F[e]=t,!0)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},"../node_modules/pathval/index.js":e=>{"use strict";function t(e,t){return null!=e&&t in Object(e)}function n(e){return e.replace(/([^\\])\[/g,"$1.[").match(/(\\\.|[^.]+?)+/g).map(function(e){if("constructor"===e||"__proto__"===e||"prototype"===e)return{};var t=/^\[(\d+)\]$/.exec(e);return t?{i:parseFloat(t[1])}:{p:e.replace(/\\([.[\]])/g,"$1")}})}function i(e,t,n){var i=e,s=null;n=void 0===n?t.length:n;for(var o=0;o<n;o++){var r=t[o];i&&(i=void 0===r.p?i[r.i]:i[r.p],o===n-1&&(s=i))}return s}function s(e,s){var o=n(s),r=o[o.length-1],a={parent:o.length>1?i(e,o,o.length-1):e,name:r.p||r.i,value:i(e,o)};return a.exists=t(a.parent,a.name),a}e.exports={hasProperty:t,getPathInfo:s,getPathValue:function(e,t){return s(e,t).value},setPathValue:function(e,t,i){return function(e,t,n){for(var i=e,s=n.length,o=null,r=0;r<s;r++){var a=null,l=null;if(o=n[r],r===s-1)i[a=void 0===o.p?o.i:o.p]=t;else if(void 0!==o.p&&i[o.p])i=i[o.p];else if(void 0!==o.i&&i[o.i])i=i[o.i];else{var c=n[r+1];a=void 0===o.p?o.i:o.p,l=void 0===c.p?[]:{},i[a]=l,i=i[a]}}}(e,i,n(t)),e}}},"../node_modules/qrcode/lib/browser.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/can-promise.js"),s=n("../node_modules/qrcode/lib/core/qrcode.js"),o=n("../node_modules/qrcode/lib/renderer/canvas.js"),r=n("../node_modules/qrcode/lib/renderer/svg-tag.js");function a(e,t,n,o,r){const a=[].slice.call(arguments,1),l=a.length,c="function"==typeof a[l-1];if(!c&&!i())throw new Error("Callback required as last argument");if(!c){if(l<1)throw new Error("Too few arguments provided");return 1===l?(n=t,t=o=void 0):2!==l||t.getContext||(o=n,n=t,t=void 0),new Promise(function(i,r){try{const r=s.create(n,o);i(e(r,t,o))}catch(e){r(e)}})}if(l<2)throw new Error("Too few arguments provided");2===l?(r=n,n=t,t=o=void 0):3===l&&(t.getContext&&void 0===r?(r=o,o=void 0):(r=o,o=n,n=t,t=void 0));try{const i=s.create(n,o);r(null,e(i,t,o))}catch(e){r(e)}}t.create=s.create,t.toCanvas=a.bind(null,o.render),t.toDataURL=a.bind(null,o.renderToDataURL),t.toString=a.bind(null,function(e,t,n){return r.render(e,n)})},"../node_modules/qrcode/lib/can-promise.js":e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},"../node_modules/qrcode/lib/core/alignment-pattern.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/utils.js").getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];const t=Math.floor(e/7)+2,n=i(e),s=145===n?26:2*Math.ceil((n-13)/(2*t-2)),o=[n-7];for(let e=1;e<t-1;e++)o[e]=o[e-1]-s;return o.push(6),o.reverse()},t.getPositions=function(e){const n=[],i=t.getRowColCoords(e),s=i.length;for(let e=0;e<s;e++)for(let t=0;t<s;t++)0===e&&0===t||0===e&&t===s-1||e===s-1&&0===t||n.push([i[e],i[t]]);return n}},"../node_modules/qrcode/lib/core/alphanumeric-data.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/mode.js"),s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function o(e){this.mode=i.ALPHANUMERIC,this.data=e}o.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*s.indexOf(this.data[t]);n+=s.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(s.indexOf(this.data[t]),6)},e.exports=o},"../node_modules/qrcode/lib/core/bit-buffer.js":e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},"../node_modules/qrcode/lib/core/bit-matrix.js":e=>{function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,i){const s=e*this.size+t;this.data[s]=n,i&&(this.reservedBit[s]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},"../node_modules/qrcode/lib/core/byte-data.js":(e,t,n)=>{const i=n("../node_modules/encode-utf8/index.js"),s=n("../node_modules/qrcode/lib/core/mode.js");function o(e){this.mode=s.BYTE,"string"==typeof e&&(e=i(e)),this.data=new Uint8Array(e)}o.getBitsLength=function(e){return 8*e},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=o},"../node_modules/qrcode/lib/core/error-correction-code.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/error-correction-level.js"),s=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],o=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case i.L:return s[4*(e-1)+0];case i.M:return s[4*(e-1)+1];case i.Q:return s[4*(e-1)+2];case i.H:return s[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case i.L:return o[4*(e-1)+0];case i.M:return o[4*(e-1)+1];case i.Q:return o[4*(e-1)+2];case i.H:return o[4*(e-1)+3];default:return}}},"../node_modules/qrcode/lib/core/error-correction-level.js":(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return n}}},"../node_modules/qrcode/lib/core/finder-pattern.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/utils.js").getSymbolSize;t.getPositions=function(e){const t=i(e);return[[0,0],[t-7,0],[0,t-7]]}},"../node_modules/qrcode/lib/core/format-info.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/utils.js"),s=i.getBCHDigit(1335);t.getEncodedBits=function(e,t){const n=e.bit<<3|t;let o=n<<10;for(;i.getBCHDigit(o)-s>=0;)o^=1335<<i.getBCHDigit(o)-s;return 21522^(n<<10|o)}},"../node_modules/qrcode/lib/core/galois-field.js":(e,t)=>{const n=new Uint8Array(512),i=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)n[t]=e,i[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return i[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[i[e]+i[t]]}},"../node_modules/qrcode/lib/core/kanji-data.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/mode.js"),s=n("../node_modules/qrcode/lib/core/utils.js");function o(e){this.mode=i.KANJI,this.data=e}o.getBitsLength=function(e){return 13*e},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=s.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}},e.exports=o},"../node_modules/qrcode/lib/core/mask-pattern.js":(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function n(e,n,i){switch(e){case t.Patterns.PATTERN000:return(n+i)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return i%3==0;case t.Patterns.PATTERN011:return(n+i)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2==0;case t.Patterns.PATTERN101:return n*i%2+n*i%3==0;case t.Patterns.PATTERN110:return(n*i%2+n*i%3)%2==0;case t.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){const t=e.size;let n=0,i=0,s=0,o=null,r=null;for(let a=0;a<t;a++){i=s=0,o=r=null;for(let l=0;l<t;l++){let t=e.get(a,l);t===o?i++:(i>=5&&(n+=i-5+3),o=t,i=1),t=e.get(l,a),t===r?s++:(s>=5&&(n+=s-5+3),r=t,s=1)}i>=5&&(n+=i-5+3),s>=5&&(n+=s-5+3)}return n},t.getPenaltyN2=function(e){const t=e.size;let n=0;for(let i=0;i<t-1;i++)for(let s=0;s<t-1;s++){const t=e.get(i,s)+e.get(i,s+1)+e.get(i+1,s)+e.get(i+1,s+1);4!==t&&0!==t||n++}return 3*n},t.getPenaltyN3=function(e){const t=e.size;let n=0,i=0,s=0;for(let o=0;o<t;o++){i=s=0;for(let r=0;r<t;r++)i=i<<1&2047|e.get(o,r),r>=10&&(1488===i||93===i)&&n++,s=s<<1&2047|e.get(r,o),r>=10&&(1488===s||93===s)&&n++}return 40*n},t.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let i=0;i<n;i++)t+=e.data[i];return 10*Math.abs(Math.ceil(100*t/n/5)-10)},t.applyMask=function(e,t){const i=t.size;for(let s=0;s<i;s++)for(let o=0;o<i;o++)t.isReserved(o,s)||t.xor(o,s,n(e,o,s))},t.getBestMask=function(e,n){const i=Object.keys(t.Patterns).length;let s=0,o=1/0;for(let r=0;r<i;r++){n(r),t.applyMask(r,e);const i=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(r,e),i<o&&(o=i,s=r)}return s}},"../node_modules/qrcode/lib/core/mode.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/version-check.js"),s=n("../node_modules/qrcode/lib/core/regex.js");t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!i.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return s.testNumeric(e)?t.NUMERIC:s.testAlphanumeric(e)?t.ALPHANUMERIC:s.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(e){return n}}},"../node_modules/qrcode/lib/core/numeric-data.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/mode.js");function s(e){this.mode=i.NUMERIC,this.data=e.toString()}s.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t,n,i;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),i=parseInt(n,10),e.put(i,10);const s=this.data.length-t;s>0&&(n=this.data.substr(t),i=parseInt(n,10),e.put(i,3*s+1))},e.exports=s},"../node_modules/qrcode/lib/core/polynomial.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/galois-field.js");t.mul=function(e,t){const n=new Uint8Array(e.length+t.length-1);for(let s=0;s<e.length;s++)for(let o=0;o<t.length;o++)n[s+o]^=i.mul(e[s],t[o]);return n},t.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){const e=n[0];for(let s=0;s<t.length;s++)n[s]^=i.mul(t[s],e);let s=0;for(;s<n.length&&0===n[s];)s++;n=n.slice(s)}return n},t.generateECPolynomial=function(e){let n=new Uint8Array([1]);for(let s=0;s<e;s++)n=t.mul(n,new Uint8Array([1,i.exp(s)]));return n}},"../node_modules/qrcode/lib/core/qrcode.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/utils.js"),s=n("../node_modules/qrcode/lib/core/error-correction-level.js"),o=n("../node_modules/qrcode/lib/core/bit-buffer.js"),r=n("../node_modules/qrcode/lib/core/bit-matrix.js"),a=n("../node_modules/qrcode/lib/core/alignment-pattern.js"),l=n("../node_modules/qrcode/lib/core/finder-pattern.js"),c=n("../node_modules/qrcode/lib/core/mask-pattern.js"),h=n("../node_modules/qrcode/lib/core/error-correction-code.js"),d=n("../node_modules/qrcode/lib/core/reed-solomon-encoder.js"),u=n("../node_modules/qrcode/lib/core/version.js"),p=n("../node_modules/qrcode/lib/core/format-info.js"),f=n("../node_modules/qrcode/lib/core/mode.js"),m=n("../node_modules/qrcode/lib/core/segments.js");function g(e,t,n){const i=e.size,s=p.getEncodedBits(t,n);let o,r;for(o=0;o<15;o++)r=1==(s>>o&1),o<6?e.set(o,8,r,!0):o<8?e.set(o+1,8,r,!0):e.set(i-15+o,8,r,!0),o<8?e.set(8,i-o-1,r,!0):o<9?e.set(8,15-o-1+1,r,!0):e.set(8,15-o-1,r,!0);e.set(i-8,8,1,!0)}function y(e,t,n,s){let p;if(Array.isArray(e))p=m.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let i=t;if(!i){const t=m.rawSplit(e);i=u.getBestVersionForData(t,n)}p=m.fromString(e,i||40)}}const y=u.getBestVersionForData(p,n);if(!y)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<y)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+y+".\n")}else t=y;const b=function(e,t,n){const s=new o;n.forEach(function(t){s.put(t.mode.bit,4),s.put(t.getLength(),f.getCharCountIndicator(t.mode,e)),t.write(s)});const r=8*(i.getSymbolTotalCodewords(e)-h.getTotalCodewordsCount(e,t));for(s.getLengthInBits()+4<=r&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);const a=(r-s.getLengthInBits())/8;for(let e=0;e<a;e++)s.put(e%2?17:236,8);return function(e,t,n){const s=i.getSymbolTotalCodewords(t),o=s-h.getTotalCodewordsCount(t,n),r=h.getBlocksCount(t,n),a=r-s%r,l=Math.floor(s/r),c=Math.floor(o/r),u=c+1,p=l-c,f=new d(p);let m=0;const g=new Array(r),y=new Array(r);let b=0;const v=new Uint8Array(e.buffer);for(let e=0;e<r;e++){const t=e<a?c:u;g[e]=v.slice(m,m+t),y[e]=f.encode(g[e]),m+=t,b=Math.max(b,t)}const w=new Uint8Array(s);let x,k,S=0;for(x=0;x<b;x++)for(k=0;k<r;k++)x<g[k].length&&(w[S++]=g[k][x]);for(x=0;x<p;x++)for(k=0;k<r;k++)w[S++]=y[k][x];return w}(s,e,t)}(t,n,p),v=i.getSymbolSize(t),w=new r(v);return function(e,t){const n=e.size,i=l.getPositions(t);for(let t=0;t<i.length;t++){const s=i[t][0],o=i[t][1];for(let t=-1;t<=7;t++)if(!(s+t<=-1||n<=s+t))for(let i=-1;i<=7;i++)o+i<=-1||n<=o+i||(t>=0&&t<=6&&(0===i||6===i)||i>=0&&i<=6&&(0===t||6===t)||t>=2&&t<=4&&i>=2&&i<=4?e.set(s+t,o+i,!0,!0):e.set(s+t,o+i,!1,!0))}}(w,t),function(e){const t=e.size;for(let n=8;n<t-8;n++){const t=n%2==0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(w),function(e,t){const n=a.getPositions(t);for(let t=0;t<n.length;t++){const i=n[t][0],s=n[t][1];for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)-2===t||2===t||-2===n||2===n||0===t&&0===n?e.set(i+t,s+n,!0,!0):e.set(i+t,s+n,!1,!0)}}(w,t),g(w,n,0),t>=7&&function(e,t){const n=e.size,i=u.getEncodedBits(t);let s,o,r;for(let t=0;t<18;t++)s=Math.floor(t/3),o=t%3+n-8-3,r=1==(i>>t&1),e.set(s,o,r,!0),e.set(o,s,r,!0)}(w,t),function(e,t){const n=e.size;let i=-1,s=n-1,o=7,r=0;for(let a=n-1;a>0;a-=2)for(6===a&&a--;;){for(let n=0;n<2;n++)if(!e.isReserved(s,a-n)){let i=!1;r<t.length&&(i=1==(t[r]>>>o&1)),e.set(s,a-n,i),o--,-1===o&&(r++,o=7)}if(s+=i,s<0||n<=s){s-=i,i=-i;break}}}(w,b),isNaN(s)&&(s=c.getBestMask(w,g.bind(null,w,n))),c.applyMask(s,w),g(w,n,s),{modules:w,version:t,errorCorrectionLevel:n,maskPattern:s,segments:p}}t.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");let n,o,r=s.M;return void 0!==t&&(r=s.from(t.errorCorrectionLevel,s.M),n=u.from(t.version),o=c.from(t.maskPattern),t.toSJISFunc&&i.setToSJISFunction(t.toSJISFunc)),y(e,n,r,o)}},"../node_modules/qrcode/lib/core/reed-solomon-encoder.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/polynomial.js");function s(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}s.prototype.initialize=function(e){this.degree=e,this.genPoly=i.generateECPolynomial(this.degree)},s.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=i.mod(t,this.genPoly),s=this.degree-n.length;if(s>0){const e=new Uint8Array(this.degree);return e.set(n,s),e}return n},e.exports=s},"../node_modules/qrcode/lib/core/regex.js":(e,t)=>{const n="[0-9]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+")(?:.|[\r\n]))+";t.KANJI=new RegExp(i,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(s,"g"),t.NUMERIC=new RegExp(n,"g"),t.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const o=new RegExp("^"+i+"$"),r=new RegExp("^"+n+"$"),a=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return o.test(e)},t.testNumeric=function(e){return r.test(e)},t.testAlphanumeric=function(e){return a.test(e)}},"../node_modules/qrcode/lib/core/segments.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/mode.js"),s=n("../node_modules/qrcode/lib/core/numeric-data.js"),o=n("../node_modules/qrcode/lib/core/alphanumeric-data.js"),r=n("../node_modules/qrcode/lib/core/byte-data.js"),a=n("../node_modules/qrcode/lib/core/kanji-data.js"),l=n("../node_modules/qrcode/lib/core/regex.js"),c=n("../node_modules/qrcode/lib/core/utils.js"),h=n("../node_modules/dijkstrajs/dijkstra.js");function d(e){return unescape(encodeURIComponent(e)).length}function u(e,t,n){const i=[];let s;for(;null!==(s=e.exec(n));)i.push({data:s[0],index:s.index,mode:t,length:s[0].length});return i}function p(e){const t=u(l.NUMERIC,i.NUMERIC,e),n=u(l.ALPHANUMERIC,i.ALPHANUMERIC,e);let s,o;return c.isKanjiModeEnabled()?(s=u(l.BYTE,i.BYTE,e),o=u(l.KANJI,i.KANJI,e)):(s=u(l.BYTE_KANJI,i.BYTE,e),o=[]),t.concat(n,s,o).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function f(e,t){switch(t){case i.NUMERIC:return s.getBitsLength(e);case i.ALPHANUMERIC:return o.getBitsLength(e);case i.KANJI:return a.getBitsLength(e);case i.BYTE:return r.getBitsLength(e)}}function m(e,t){let n;const l=i.getBestModeForData(e);if(n=i.from(t,l),n!==i.BYTE&&n.bit<l.bit)throw new Error('"'+e+'" cannot be encoded with mode '+i.toString(n)+".\n Suggested mode is: "+i.toString(l));switch(n!==i.KANJI||c.isKanjiModeEnabled()||(n=i.BYTE),n){case i.NUMERIC:return new s(e);case i.ALPHANUMERIC:return new o(e);case i.KANJI:return new a(e);case i.BYTE:return new r(e)}}t.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(m(t,null)):t.data&&e.push(m(t.data,t.mode)),e},[])},t.fromString=function(e,n){const s=function(e){const t=[];for(let n=0;n<e.length;n++){const s=e[n];switch(s.mode){case i.NUMERIC:t.push([s,{data:s.data,mode:i.ALPHANUMERIC,length:s.length},{data:s.data,mode:i.BYTE,length:s.length}]);break;case i.ALPHANUMERIC:t.push([s,{data:s.data,mode:i.BYTE,length:s.length}]);break;case i.KANJI:t.push([s,{data:s.data,mode:i.BYTE,length:d(s.data)}]);break;case i.BYTE:t.push([{data:s.data,mode:i.BYTE,length:d(s.data)}])}}return t}(p(e,c.isKanjiModeEnabled())),o=function(e,t){const n={},s={start:{}};let o=["start"];for(let r=0;r<e.length;r++){const a=e[r],l=[];for(let e=0;e<a.length;e++){const c=a[e],h=""+r+e;l.push(h),n[h]={node:c,lastCount:0},s[h]={};for(let e=0;e<o.length;e++){const r=o[e];n[r]&&n[r].node.mode===c.mode?(s[r][h]=f(n[r].lastCount+c.length,c.mode)-f(n[r].lastCount,c.mode),n[r].lastCount+=c.length):(n[r]&&(n[r].lastCount=c.length),s[r][h]=f(c.length,c.mode)+4+i.getCharCountIndicator(c.mode,t))}}o=l}for(let e=0;e<o.length;e++)s[o[e]].end=0;return{map:s,table:n}}(s,n),r=h.find_path(o.map,"start","end"),a=[];for(let e=1;e<r.length-1;e++)a.push(o.table[r[e]].node);return t.fromArray(a.reduce(function(e,t){const n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[]))},t.rawSplit=function(e){return t.fromArray(p(e,c.isKanjiModeEnabled()))}},"../node_modules/qrcode/lib/core/utils.js":(e,t)=>{let n;const i=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return i[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return void 0!==n},t.toSJIS=function(e){return n(e)}},"../node_modules/qrcode/lib/core/version-check.js":(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},"../node_modules/qrcode/lib/core/version.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/core/utils.js"),s=n("../node_modules/qrcode/lib/core/error-correction-code.js"),o=n("../node_modules/qrcode/lib/core/error-correction-level.js"),r=n("../node_modules/qrcode/lib/core/mode.js"),a=n("../node_modules/qrcode/lib/core/version-check.js"),l=i.getBCHDigit(7973);function c(e,t){return r.getCharCountIndicator(e,t)+4}function h(e,t){let n=0;return e.forEach(function(e){const i=c(e.mode,t);n+=i+e.getBitsLength()}),n}t.from=function(e,t){return a.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!a.isValid(e))throw new Error("Invalid QR Code version");void 0===n&&(n=r.BYTE);const o=8*(i.getSymbolTotalCodewords(e)-s.getTotalCodewordsCount(e,t));if(n===r.MIXED)return o;const l=o-c(n,e);switch(n){case r.NUMERIC:return Math.floor(l/10*3);case r.ALPHANUMERIC:return Math.floor(l/11*2);case r.KANJI:return Math.floor(l/13);case r.BYTE:default:return Math.floor(l/8)}},t.getBestVersionForData=function(e,n){let i;const s=o.from(n,o.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(let i=1;i<=40;i++)if(h(e,i)<=t.getCapacity(i,n,r.MIXED))return i}(e,s);if(0===e.length)return 1;i=e[0]}else i=e;return function(e,n,i){for(let s=1;s<=40;s++)if(n<=t.getCapacity(s,i,e))return s}(i.mode,i.getLength(),s)},t.getEncodedBits=function(e){if(!a.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;i.getBCHDigit(t)-l>=0;)t^=7973<<i.getBCHDigit(t)-l;return e<<12|t}},"../node_modules/qrcode/lib/renderer/canvas.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/renderer/utils.js");t.render=function(e,t,n){let s=n,o=t;void 0!==s||t&&t.getContext||(s=t,t=void 0),t||(o=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),s=i.getOptions(s);const r=i.getImageWidth(e.modules.size,s),a=o.getContext("2d"),l=a.createImageData(r,r);return i.qrToImageData(l.data,e,s),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(a,o,r),a.putImageData(l,0,0),o},t.renderToDataURL=function(e,n,i){let s=i;void 0!==s||n&&n.getContext||(s=n,n=void 0),s||(s={});const o=t.render(e,n,s),r=s.type||"image/png",a=s.rendererOpts||{};return o.toDataURL(r,a.quality)}},"../node_modules/qrcode/lib/renderer/svg-tag.js":(e,t,n)=>{const i=n("../node_modules/qrcode/lib/renderer/utils.js");function s(e,t){const n=e.a/255,i=t+'="'+e.hex+'"';return n<1?i+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':i}function o(e,t,n){let i=e+t;return void 0!==n&&(i+=" "+n),i}t.render=function(e,t,n){const r=i.getOptions(t),a=e.modules.size,l=e.modules.data,c=a+2*r.margin,h=r.color.light.a?"<path "+s(r.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",d="<path "+s(r.color.dark,"stroke")+' d="'+function(e,t,n){let i="",s=0,r=!1,a=0;for(let l=0;l<e.length;l++){const c=Math.floor(l%t),h=Math.floor(l/t);c||r||(r=!0),e[l]?(a++,l>0&&c>0&&e[l-1]||(i+=r?o("M",c+n,.5+h+n):o("m",s,0),s=0,r=!1),c+1<t&&e[l+1]||(i+=o("h",a),a=0)):s++}return i}(l,a,r.margin)+'"/>',u='viewBox="0 0 '+c+" "+c+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(r.width?'width="'+r.width+'" height="'+r.width+'" ':"")+u+' shape-rendering="crispEdges">'+h+d+"</svg>\n";return"function"==typeof n&&n(null,p),p}},"../node_modules/qrcode/lib/renderer/utils.js":(e,t)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");const n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});const t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,i=e.width&&e.width>=21?e.width:void 0,s=e.scale||4;return{width:i,scale:i?4:s,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){const i=t.getScale(e,n);return Math.floor((e+2*n.margin)*i)},t.qrToImageData=function(e,n,i){const s=n.modules.size,o=n.modules.data,r=t.getScale(s,i),a=Math.floor((s+2*i.margin)*r),l=i.margin*r,c=[i.color.light,i.color.dark];for(let t=0;t<a;t++)for(let n=0;n<a;n++){let h=4*(t*a+n),d=i.color.light;t>=l&&n>=l&&t<a-l&&n<a-l&&(d=c[o[Math.floor((t-l)/r)*s+Math.floor((n-l)/r)]?1:0]),e[h++]=d.r,e[h++]=d.g,e[h++]=d.b,e[h]=d.a}}},"../node_modules/query-string/index.js":(e,t,n)=>{"use strict";const i=n("../node_modules/strict-uri-encode/index.js"),s=n("../node_modules/decode-uri-component/index.js"),o=n("../node_modules/split-on-first/index.js"),r=n("../node_modules/filter-obj/index.js");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function l(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function c(e,t){return t.decode?s(e):e}function h(e){return Array.isArray(e)?e.sort():"object"==typeof e?h(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=>e[t]):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const s="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!s&&c(n,e).includes(e.arrayFormatSeparator);n=o?c(n,e):n;const r=s||o?n.split(e.arrayFormatSeparator).map(t=>c(t,e)):null===n?n:c(n,e);i[t]=r};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const s of e.split("&")){if(""===s)continue;let[e,r]=o(t.decode?s.replace(/\+/g," "):s,"=");r=void 0===r?null:["comma","separator"].includes(t.arrayFormat)?r:c(r,t),n(c(e,t),r,i)}for(const e of Object.keys(i)){const n=i[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else i[e]=p(n,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((e,t)=>{const n=i[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=h(n):e[t]=n,e},Object.create(null))}t.extract=u,t.parse=f,t.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const s=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[l(t,e),"[",s,"]"].join("")]:[...n,[l(t,e),"[",l(s,e),"]=",l(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[l(t,e),"[]"].join("")]:[...n,[l(t,e),"[]=",l(i,e)].join("")];case"comma":case"separator":return t=>(n,i)=>null==i||0===i.length?n:0===n.length?[[l(t,e),"=",l(i,e)].join("")]:[[n,l(i,e)].join(e.arrayFormatSeparator)];default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,l(t,e)]:[...n,[l(t,e),"=",l(i,e)].join("")]}}(t),s={};for(const t of Object.keys(e))n(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const s=e[n];return void 0===s?"":null===s?l(n,t):Array.isArray(s)?s.reduce(i(n),[]).join("&"):l(n,t)+"="+l(s,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=o(e,"#");return Object.assign({url:n.split("?")[0]||"",query:f(u(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const i=d(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),r=Object.assign(o,e.query);let a=t.stringify(r,n);a&&(a=`?${a}`);let c=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(c=`#${l(e.fragmentIdentifier,n)}`),`${i}${a}${c}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:s,query:o,fragmentIdentifier:a}=t.parseUrl(e,i);return t.stringifyUrl({url:s,query:r(o,n),fragmentIdentifier:a},i)},t.exclude=(e,n,i)=>{const s=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,s,i)}},"../node_modules/split-on-first/index.js":e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},"../node_modules/strict-uri-encode/index.js":e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},"./src/debugging.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEV:()=>s});var i=n("../node_modules/loglevel/lib/loglevel.js");const s=!0;s&&i.enableAll()},"./src/defaultinput.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{DefaultInput:()=>r,DefaultInputReader:()=>a});var i=n("./src/netcode/types.ts"),s=n("./src/utils.ts"),o=n("./src/vec2.ts");class r extends i.NetplayInput{constructor(){super(...arguments),this.keysPressed={},this.keysHeld={},this.keysReleased={},this.touches=[],this.gamepads=[]}arrowKeys(){return new o.Vec2((this.keysHeld.ArrowLeft?-1:0)+(this.keysHeld.ArrowRight?1:0),(this.keysHeld.ArrowDown?-1:0)+(this.keysHeld.ArrowUp?1:0))}wasd(){return new o.Vec2((this.keysHeld.a?-1:0)+(this.keysHeld.d?1:0),(this.keysHeld.s?-1:0)+(this.keysHeld.w?1:0))}}class a{getCanvasScale(){const e=this.canvas.getBoundingClientRect();return{x:this.canvasSize.width/e.width,y:this.canvasSize.height/e.height}}projectClientPosition(e,t){const n=this.canvas.getBoundingClientRect(),i=this.getCanvasScale();return{x:(e-n.left)*i.x,y:(t-n.top)*i.y}}constructor(e=document.body,t,n,i=!1,s=!1,o={}){this.keysPressed={},this.keysHeld={},this.keysReleased={},this.mousePosition=null,this.mouseDelta=null,this.touches=[],this.previousGamepadState=new Map,this.canvas=t,this.canvasSize=n,this.touchControls=o,e.addEventListener("keydown",e=>{e.repeat||(this.keysHeld[e.key]=!0,this.keysPressed[e.key]=!0)},!1),e.addEventListener("keyup",e=>{this.keysHeld[e.key]=!1,this.keysReleased[e.key]=!0},!1),t.addEventListener("mouseenter",e=>this.updateMousePosition(e),!1),t.addEventListener("mousemove",e=>this.updateMousePosition(e),!1),t.addEventListener("mouseleave",e=>{this.mousePosition=null},!1),t.addEventListener("touchstart",e=>this.updateTouches(e),!1),t.addEventListener("touchmove",e=>this.updateTouches(e),!1),t.addEventListener("touchend",e=>this.updateTouches(e),!1),t.addEventListener("mousedown",()=>{i&&t.requestPointerLock()}),t.addEventListener("contextmenu",e=>{s&&e.preventDefault()})}updateMousePosition(e){if(document.pointerLockElement===this.canvas)if(this.mousePosition){const t=this.getCanvasScale();this.mousePosition.x+=e.movementX*t.x,this.mousePosition.y+=e.movementY*t.y}else this.mousePosition=this.projectClientPosition(e.clientX,e.clientY);else this.mousePosition=this.projectClientPosition(e.clientX,e.clientY)}updateTouches(e){this.touches.length=e.targetTouches.length;for(let t=0;t<e.targetTouches.length;++t)this.touches[t]=this.projectClientPosition(e.targetTouches[t].clientX,e.targetTouches[t].clientY)}getInput(){let e=new r;for(let t in this.keysPressed)this.keysPressed[t]&&(e.keysPressed[t]=!0,e.keysHeld[t]=!0);for(let t in this.keysHeld)this.keysHeld[t]&&(e.keysHeld[t]=!0);for(let t in this.keysReleased)this.keysReleased[t]&&(e.keysReleased[t]=!0);this.mousePosition&&(e.mousePosition=s.clone(this.mousePosition)),e.touches=s.clone(this.touches);for(let[t,n]of Object.entries(this.touchControls))e.touchControls=e.touchControls||{},e.touchControls[t]=s.clone(n.getValue());return navigator.getGamepads&&navigator.getGamepads().forEach((t,n)=>{if(!t)return null;const i=this.previousGamepadState.get(n)||{buttons:t.buttons.map(()=>!1)},o=t.buttons.map((e,t)=>{const n=e.pressed;return{held:n,pressed:!i.buttons[t]&&n,released:i.buttons[t]&&!n}});e.gamepads.push({axes:s.clone(t.axes),buttons:o}),this.previousGamepadState.set(n,{buttons:t.buttons.map(e=>e.pressed)})}),this.keysPressed={},this.keysReleased={},e}}},"./src/ewmasd.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});class i{constructor(e){this.discount=e,this.est_average=0,this.est_variance=0,this.initialized=!1}update(e){if(this.initialized){let t=e-this.est_average;this.est_variance=(1-this.discount)*(this.est_variance+this.discount*t*t),this.est_average=this.discount*e+(1-this.discount)*this.est_average}else this.est_average=e,this.initialized=!0}average(){return this.est_average}variance(){return this.est_variance}stddev(){return Math.sqrt(this.est_variance)}}},"./src/game.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{Game:()=>s});var i=n("./src/netcode/types.ts");class s extends i.NetplayState{}},"./src/matchmaking/client.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_SERVER_URL:()=>a,MatchmakingClient:()=>l});var i=n("../node_modules/loglevel/lib/loglevel.js"),s=n.n(i),o=n("../netplayjs-common/typedevent.ts"),r=n("./src/matchmaking/peerconnection.ts");const a="https://netplayjs.varunramesh.net";class l{constructor(e=a){this.connections=new Map,this.onHostMatch=new o.TypedEvent,this.onJoinMatch=new o.TypedEvent,this.onConnection=new o.TypedEvent,this.onRegistered=new o.TypedEvent,this.serverURL=e,this.ws=new WebSocket(function(e){const t=new URL(e);if("http:"===t.protocol)return`ws://${t.hostname}:${t.port}/`;if("https:"===t.protocol)return`wss://${t.hostname}:${t.port}/`;throw new Error(`Unknown protocol: ${t.protocol}`)}(this.serverURL)),this.ws.onmessage=e=>{s().debug(`Server -> Client: ${e.data}`),this.onServerMessage(JSON.parse(e.data))}}send(e){const t=JSON.stringify(e);s().debug(`Client -> Server: ${t}`),this.ws.send(t)}onServerMessage(e){if("registration-success"===e.kind)this.clientID=e.clientID,this.iceServers=e.iceServers,this.onRegistered.emit(this.clientID);else if("peer-message"===e.kind){if(!this.connections.has(e.sourceID)){const t=new r.PeerConnection(this,e.sourceID,!1);this.connections.set(e.sourceID,t),this.onConnection.emit(t)}this.connections.get(e.sourceID).onSignalingMessage(e.type,e.payload)}else"host-match"===e.kind?this.onHostMatch.emit({clientIDs:e.clientIDs}):"join-match"===e.kind&&this.onJoinMatch.emit({hostID:e.hostID})}connectPeer(e){const t=new r.PeerConnection(this,e,!0);return this.connections.set(e,t),this.onConnection.emit(t),t}sendMatchRequest(e,t,n){this.send({kind:"match-request",gameID:e,minPlayers:t,maxPlayers:n})}}},"./src/matchmaking/peerconnection.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{PeerConnection:()=>h});var i=n("../node_modules/eventemitter3/index.mjs"),s=n("../node_modules/loglevel/lib/loglevel.js"),o=n.n(s),r=n("./node_modules/msgpack-lite/lib/browser.js"),a=n("./src/matchmaking/stats.ts"),l=n("../netplayjs-common/typedevent.ts"),c=function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})};class h extends i.default{constructor(e,t,n){super(),this.sendStats=new a.ConnectionStats,this.receiveStats=new a.ConnectionStats,this.onClose=new l.TypedEvent,this.closed=!1,this.client=e,this.peerID=t,this.peerConnection=new RTCPeerConnection({iceServers:e.iceServers}),window.addEventListener("beforeunload",e=>{var t;this.peerConnection.close(),null===(t=this.dataChannel)||void 0===t||t.close()}),this.peerConnection.onicecandidate=e=>{e.candidate&&this.client.send({kind:"send-message",type:"candidate",destinationID:t,payload:e.candidate})},this.peerConnection.onconnectionstatechange=e=>{o().debug(`ConnectionStateChange: ${this.peerConnection.connectionState}`),"disconnected"===this.peerConnection.connectionState&&this.close()},n?(this.peerConnection.onnegotiationneeded=()=>c(this,void 0,void 0,function*(){const e=yield this.peerConnection.createOffer();this.client.send({kind:"send-message",type:"offer",destinationID:t,payload:e}),yield this.peerConnection.setLocalDescription(e)}),this.setDataChannel(this.peerConnection.createDataChannel("data",{ordered:!0}))):this.peerConnection.ondatachannel=e=>{this.setDataChannel(e.channel)}}close(){var e;closed||(this.closed=!0,this.peerConnection.close(),null===(e=this.dataChannel)||void 0===e||e.close(),this.onClose.emit())}setDataChannel(e){this.dataChannel=e,this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=e=>{this.emit("open")},this.dataChannel.onmessage=e=>{this.receiveStats.onMessage(e.data.byteLength),this.emit("data",r.decode(new Uint8Array(e.data)))},this.dataChannel.onclose=e=>{o().debug("Data channel closed..."),this.close()}}onSignalingMessage(e,t){return c(this,void 0,void 0,function*(){if(o().debug(`onSignalingMessage: ${e}, ${JSON.stringify(t)}`),"offer"===e){yield this.peerConnection.setRemoteDescription(t),o().debug("Generating answer...");const e=yield this.peerConnection.createAnswer();yield this.peerConnection.setLocalDescription(e),this.client.send({kind:"send-message",type:"answer",destinationID:this.peerID,payload:e})}else"answer"===e?yield this.peerConnection.setRemoteDescription(t):"candidate"===e&&(yield this.peerConnection.addIceCandidate(t))})}send(e){var t;if("open"!==(null===(t=this.dataChannel)||void 0===t?void 0:t.readyState))return;let n=r.encode(e);this.sendStats.onMessage(n.byteLength),this.dataChannel.send(n)}}},"./src/matchmaking/stats.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{ConnectionStats:()=>i});class i{constructor(e=5e3){this.window=[],this.windowDuration=e}updateWindow(){const e=performance.now()-this.windowDuration;for(;this.window.length>0&&this.window[0].timestamp<e;)this.window.shift()}onMessage(e){this.window.push({timestamp:performance.now(),bytes:e}),this.updateWindow()}getPacketsPerSecond(){return this.updateWindow(),1e3*this.window.length/this.windowDuration}getAveragePacketSize(){return this.updateWindow(),this.window.reduce((e,t)=>e+t.bytes,0)/this.window.length}getBytesPerSecond(){return this.updateWindow(),1e3*this.window.reduce((e,t)=>e+t.bytes,0)/this.windowDuration}formatStats(){return`${this.getPacketsPerSecond().toFixed(2)} msgs/sec, ${this.getAveragePacketSize().toFixed(2)} bytes/msg, ${this.getBytesPerSecond()} bytes/sec`}}},"./src/netcode/lockstep.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{LockstepNetcode:()=>r});var i=n("./src/debugging.ts"),s=n("../node_modules/chai/index.mjs"),o=n("./src/utils.ts");class r{constructor(e,t,n,i,s,o,r,a){this.frame=0,this.inputs=new Map,this.missedFrames=0,this.stateSyncsReceived=0,this.stateSyncsSent=0,this.isHost=e,this.state=t,this.players=n,this.timestep=i,this.pollInput=o,this.broadcastInput=r,this.stateSyncPeriod=s;for(let e of this.players)this.inputs.set(e,[]);if(this.isHost&&this.stateSyncPeriod>0){if(!a)throw new Error("Expected a broadcastState argument");this.broadcastState=a}}getLocalPlayer(){return this.players.filter(e=>e.isLocalPlayer())[0]}checkAllInputsReady(){for(let e of this.players)if(0===(0,o.get)(this.inputs,e).length)return!1;return!0}tryAdvanceState(){if(!this.checkAllInputsReady())return void this.missedFrames++;let e=new Map;for(let t of this.players){let n=(0,o.get)(this.inputs,t),r=(0,o.shift)(n);i.DEV&&s.assert.equal(r.frame,this.frame),e.set(t,r.input)}this.state.tick(e),this.frame++,this.tryStateSync(),this.processLocalInput()}start(){this.tryStateSync(),this.processLocalInput(),setInterval(()=>{this.tryAdvanceState()},this.timestep)}onStateSync(e,t){i.DEV&&s.assert.equal(e,this.frame,"Unexpected state sync frame."),this.state.deserialize(t),this.stateSyncsReceived++}tryStateSync(){this.isHost&&this.stateSyncPeriod>0&&this.frame%this.stateSyncPeriod==0&&(this.broadcastState(this.frame,this.state.serialize()),this.stateSyncsSent++)}processLocalInput(){let e=this.getLocalPlayer(),t=this.pollInput();i.DEV&&s.assert.isEmpty(this.inputs.get(e),"Local player already has input stored."),(0,o.get)(this.inputs,e).push({frame:this.frame,input:t}),this.broadcastInput(this.frame,t)}onRemoteInput(e,t,n){i.DEV&&s.assert.isTrue(t.isRemotePlayer(),"'player' must be remote.");const r=(0,o.get)(this.inputs,t),a=0===r.length?this.frame:r[r.length-1].frame+1;i.DEV&&s.assert.equal(e,a,"Unexpected Frame"),r.push({frame:e,input:n})}}},"./src/netcode/rollback.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{RollbackNetcode:()=>l});var i=n("./src/utils.ts"),s=n("../node_modules/loglevel/lib/loglevel.js"),o=n("./src/debugging.ts"),r=n("../node_modules/chai/index.mjs");class a{constructor(e,t,n){this.frame=e,this.state=t,this.inputs=n}isPlayerInputPredicted(e){return(0,i.get)(this.inputs,e).isPrediction}anyInputPredicted(){for(const[e,{isPrediction:t}]of this.inputs.entries())if(t)return!0;return!1}allInputsSynced(){return!this.anyInputPredicted()}}class l{onStateSync(e,t){o.DEV&&r.assert.isFalse(this.isHost,"Only clients recieve state syncs.");let n=0;for(;this.history.length>1&&(o.DEV&&r.assert.isTrue(this.history[0].allInputsSynced()),this.history[0].frame<e);)(0,i.shift)(this.history),n++;o.DEV&&s.debug(`Cleaned up ${n} states.`),o.DEV&&r.assert.equal(this.history[0].frame,e),this.history[0].state=t,this.state.deserialize(t);for(let e=1;e<this.history.length;++e){let t=this.history[e];this.state.tick(this.getStateInputs(t.inputs)),t.state=(0,i.clone)(this.state.serialize())}o.DEV&&s.debug(`Resimulated ${this.history.length-1} states after state sync.`)}onRemoteInput(e,t,n){o.DEV&&r.assert.isTrue(t.isRemotePlayer(),"'player' must be a remote player."),o.DEV&&r.assert.isNotEmpty(this.history,"'history' cannot be empty.");let a=(0,i.get)(this.highestFrameReceived,t)+1;if(o.DEV&&r.assert.equal(a,e),this.highestFrameReceived.set(t,a),e>this.history[this.history.length-1].frame)return void(0,i.get)(this.future,t).push({frame:e,input:n});let l=null;for(let e=0;e<this.history.length;++e)if(this.history[e].isPlayerInputPredicted(t)){l=e;break}o.DEV&&r.assert.exists(l),o.DEV&&r.assert.equal(this.history[l].frame,e);let c=this.history[l-1];this.state.deserialize(c.state);for(let s=l;s<this.history.length;++s){let a=this.history[s],c=(0,i.get)(a.inputs,t);if(o.DEV&&r.assert.isTrue(c.isPrediction),s===l)o.DEV&&r.assert.equal(a.frame,e),c.isPrediction=!1,c.input=n;else{let e=this.history[s-1],n=(0,i.get)(e.inputs,t);c.input=n.input.predictNext()}this.state.tick(this.getStateInputs(a.inputs)),a.state=(0,i.clone)(this.state.serialize())}if(o.DEV&&s.debug(`Resimulated ${this.history.length-l} states after rollback.`),this.isHost){let e=0;for(;this.history.length>=2;){let t=this.history[0],n=this.history[1];if(o.DEV&&r.assert.isTrue(t.allInputsSynced()),!n.allInputsSynced())break;{let t=(0,i.shift)(this.history);e++,this.broadcastState(t.frame,t.state)}}o.DEV&&s.debug(`Cleaned up ${e} states.`)}}constructor(e,t,n,s,o,r,l,c,h,d){if(this.isHost=e,this.state=t,this.players=n,this.maxPredictedFrames=o,this.broadcastInput=h,this.pingMeasure=r,this.timestep=l,this.pollInput=c,e){if(!d)throw new Error("Expected a broadcast state function.");this.broadcastState=d}let u=new Map;for(const[e,t]of s.entries())u.set(e,{input:t,isPrediction:!1});this.history=[new a(0,(0,i.clone)(this.state.serialize()),u)],this.future=new Map,this.highestFrameReceived=new Map;for(let e of this.players)this.future.set(e,[]),this.highestFrameReceived.set(e,0)}currentFrame(){return o.DEV&&r.assert.isNotEmpty(this.history,"'history' cannot be empty."),this.history[this.history.length-1].frame}largestFutureSize(){return Math.max(...Array.from(this.future.values()).map(e=>e.length))}predictedFrames(){for(let e=0;e<this.history.length;++e)if(!this.history[e].allInputsSynced())return this.history.length-e;return 0}shouldStall(){return this.predictedFrames()>this.maxPredictedFrames}tick(){if(o.DEV&&r.assert.isNotEmpty(this.history,"'history' cannot be empty."),this.shouldStall())return;const e=this.history[this.history.length-1],t=new Map;for(const[n,s]of e.inputs.entries())if(n.isLocalPlayer()){let i=this.pollInput();t.set(n,{input:i,isPrediction:!1}),this.broadcastInput(e.frame+1,i)}else if((0,i.get)(this.future,n).length>0){let s=(0,i.shift)((0,i.get)(this.future,n));o.DEV&&r.assert.equal(e.frame+1,s.frame),t.set(n,{input:s.input,isPrediction:!1})}else t.set(n,{input:s.input.predictNext(),isPrediction:!0});this.state.tick(this.getStateInputs(t)),this.history.push(new a(e.frame+1,(0,i.clone)(this.state.serialize()),t))}getStateInputs(e){let t=new Map;for(const[n,{input:i}]of e.entries())t.set(n,i);return t}start(){setInterval(()=>{let e=1;this.largestFutureSize()>0&&(e=2);for(let t=0;t<e;++t)this.tick()},this.timestep)}}},"./src/netcode/types.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{NetplayInput:()=>o,NetplayPlayer:()=>r,NetplayState:()=>s});var i=n("./src/serialization/autoserialize.ts");class s{serialize(){return i.serialize(this)}deserialize(e){i.deserialize(e,this)}}class o{predictNext(){return this}serialize(){return i.serialize(this)}deserialize(e){i.deserialize(e,this)}}class r{constructor(e,t,n){this.id=e,this.isLocal=t,this.isHost=n}isLocalPlayer(){return this.isLocal}isRemotePlayer(){return!this.isLocal}isServer(){return this.isHost}isClient(){return!this.isHost}getID(){return this.id}}},"./src/serialization/autoserialize.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{deserialize:()=>o,serialize:()=>s});var i=n("./src/serialization/serialize.ts");function s(e){const t={};for(let n of Object.keys(e))t[n]=i.serialize(e[n]);return t}function o(e,t){for(const[n,s]of Object.entries(e))t[n]=i.deserialize(e[n])}},"./src/serialization/serialize.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{CUSTOM_TYPES:()=>i,deserialize:()=>r,registerCustomType:()=>s,serialize:()=>o});const i=[];function s(e,t,n,s){i.push({klass:e,typeName:t,serializer:n,deserializer:s})}function o(e){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e)return e;if(void 0===e)return{__type:"undefined"};if(Array.isArray(e))return e.map(o);if("object"==typeof e){for(let t of i)if(e instanceof t.klass)return{__type:t.typeName,data:t.serializer(e)};const t={};for(let n of Object.keys(e))t[n]=o(e[n]);return t}throw new Error("Failed to serialize unknown type.")}function r(e){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e)return e;if(Array.isArray(e))return e.map(r);if("object"!=typeof e)throw new Error("Failed to deserialize unknown type.");if(!e.__type){const t={};for(let n of Object.keys(e))t[n]=r(e[n]);return t}if("undefined"!==e.__type)for(let t of i)if(e.__type===t.typeName)return t.deserializer(e.data)}s(Map,"Map",e=>{let t=[];for(let[n,i]of e.entries())t.push([o(n),o(i)]);return t},e=>{const t=new Map;for(let[n,i]of e)t.set(r(n),r(i));return t}),s(Set,"Set",e=>{let t=[];for(let n of e.values())t.push(o(n));return t},e=>{const t=new Set;for(let n of e)t.add(r(n));return console.log(t),t})},"./src/touchcontrols.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{TouchControl:()=>i,VirtualJoystick:()=>s});class i{}class s extends i{constructor(){super(),this.value={x:0,y:0},this.base=document.createElement("div"),this.base.style.width="1.5in",this.base.style.height="1.5in",this.base.style.backgroundColor="rgba(255, 255, 255, 0.5)",this.base.style.zIndex="3",this.base.style.borderRadius="50%",this.base.style.position="absolute",this.base.style.left="10px",this.base.style.bottom="10px",this.base.style.display="none",this.nub=document.createElement("div"),this.nub.style.width="0.5in",this.nub.style.height="0.5in",this.nub.style.backgroundColor="rgba(255, 255, 255, 1.0)",this.nub.style.zIndex="4",this.nub.style.borderRadius="50%",this.nub.style.pointerEvents="none",this.nub.style.position="absolute",this.nub.style.transform="translate(-50%, -50%)",this.nub.style.display="none",document.body.appendChild(this.base),document.body.appendChild(this.nub),this.base.addEventListener("touchstart",e=>{let t=e.targetTouches[0];this.updateTouch(t)}),this.base.addEventListener("touchmove",e=>{let t=e.targetTouches[0];this.updateTouch(t)}),this.base.addEventListener("touchend",e=>{e.targetTouches[0],this.updateTouch()})}show(){this.base.style.display="inherit",this.nub.style.display="inherit",this.updateTouch()}updateTouch(e){let t=this.base.getBoundingClientRect();if(e){let n={x:2*((e.clientX-t.left)/t.width-.5),y:2*((e.clientY-t.top)/t.height-.5)},i=Math.sqrt(n.x*n.x+n.y*n.y);i>1&&(n.x=n.x/i,n.y=n.y/i),this.value={x:n.x,y:-n.y},this.nub.style.left=`${(n.x/2+.5)*t.width+t.left}px`,this.nub.style.top=`${(n.y/2+.5)*t.height+t.top}px`}else this.nub.style.left=`${.5*t.width+t.left}px`,this.nub.style.top=`${.5*t.height+t.top}px`,this.value={x:0,y:0}}getValue(){return this.value}}},"./src/ui/gamemenu.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{GameMenu:()=>l});var i=n("../node_modules/lit-html/development/lit-html.js"),s=n("./src/matchmaking/client.ts"),o=n("../node_modules/query-string/index.js"),r=n("../node_modules/qrcode/lib/browser.js"),a=n("../netplayjs-common/typedevent.ts");class l{connectToHost(e){this.updateState({kind:"connecting-to-host"});const t=this.matchmaker.connectPeer(e);t.on("open",()=>{this.onClientStart.emit(t),this.updateState({kind:"game-in-progress"}),t.onClose.on(()=>{this.updateState({kind:"connection-closed"})})})}constructor(){this.state={kind:"connecting-to-server"},this.onClientStart=new a.TypedEvent,this.onHostStart=new a.TypedEvent,this.root=this.createRootElement(),this.gameURL=window.location.href.split("#")[0];const e=o.parse(window.location.hash),t=e.server||this.getLocalStorageServerOverride()||s.DEFAULT_SERVER_URL;this.matchmaker=new s.MatchmakingClient(t),this.matchmaker.onRegistered.once(()=>{if(e.room){const t=e.room;this.connectToHost(t)}else{const e=this.matchmaker.clientID,t=this.getJoinURL(e),n=document.createElement("canvas");r.toCanvas(n,t),this.updateState({kind:"registered",clientID:e,joinURL:t,qrCanvas:n}),this.startHostListening()}}),this.render()}startHostListening(){this.hostListeningHandle=this.matchmaker.onConnection.on(e=>{e.on("open",()=>{this.onHostStart.emit(e),this.updateState({kind:"game-in-progress"}),e.onClose.on(()=>{this.updateState({kind:"connection-closed"})})})})}stopHostListening(){this.hostListeningHandle.dispose()}startMatchmaking(){this.stopHostListening(),this.matchmaker.sendMatchRequest(this.gameURL,2,2),this.updateState({kind:"searching-for-matches"}),this.matchmaker.onHostMatch.once(e=>{this.updateState({kind:"hosting-public-match"}),this.startHostListening()}),this.matchmaker.onJoinMatch.once(e=>{this.connectToHost(e.hostID)})}updateState(e){this.state=e,this.render()}getLocalStorageServerOverride(){try{return window.localStorage.getItem("NETPLAYJS_SERVER_OVERRIDE")}catch(e){return null}}getJoinURL(e){let t={room:e};return this.matchmaker.serverURL!==s.DEFAULT_SERVER_URL&&(t.server=this.matchmaker.serverURL),`${this.gameURL}#${o.stringify(t)}`}centeredText(e){return i.html`<div
      style="display: flex; width: 100%; height: 100%; align-items: center; justify-content: center;"
    >
      <div style="font-size: 1.5em;">${e}</div>
    </div>`}menuContent(){return"connecting-to-server"===this.state.kind?this.centeredText("Connecting to NetplayJS server..."):"registered"===this.state.kind?i.html` <div
        style="display: grid; width: 100%; height: 100%; grid-template-columns: 1fr 1px 1fr; grid-column-gap: 10px;"
      >
        <div
          style="display: flex; flex-direction: column; align-items: center;"
        >
          <h1 style="margin: 5px;">Public Match</h1>
          <p>Play with random strangers on the internet.</p>
          <button
            style="font-size: 1.5em; background-color: #4CAF50; color: white; padding: 0.5em; border: none; cursor: pointer;"
            @click=${()=>this.startMatchmaking()}
          >
            Start Matchmaking
          </button>
        </div>
        <div
          style="display: flex; width: 100%; height: 100%; align-items: center; justify-content: center;"
        >
          <div style="background-color: black; width: 1px; height: 75%;"></div>
        </div>

        <div
          style="display: flex; flex-direction: column; align-items: center;"
        >
          <h1 style="margin: 5px;">Private Match</h1>
          <p>Invite players to a game via a link or QR code.</p>
          Join URL (send this to a friend):

          <a target="_blank" href="${this.state.joinURL}">
            ${this.state.joinURL}
          </a>
          <div>${this.state.qrCanvas}</div>
        </div>
      </div>`:"connecting-to-host"===this.state.kind?this.centeredText("Connecting to host..."):"searching-for-matches"===this.state.kind?this.centeredText("Searching for matches..."):"hosting-public-match"===this.state.kind?this.centeredText("You are the host. Waiting for client to connect..."):"connection-closed"===this.state.kind?this.centeredText("The connection was closed..."):void 0}render(){(0,i.render)(i.html`
        ${this.menuContent()}
        <div style="position: absolute; right: 10px; bottom: 10px;">
          <a
            target="_blank"
            style="text-decoration: none; color: black;"
            href="https://github.com/rameshvarun/netplayjs"
            >NetplayJS v${n("./package.json").version}</a
          >
        </div>
      `,this.root),"game-in-progress"===this.state.kind?this.root.style.display="none":this.root.style.display="inherit"}createRootElement(){const e=document.createElement("div");return e.style.zIndex="1",e.style.position="absolute",e.style.backgroundColor="white",e.style.padding="10px",e.style.left="50%",e.style.top="50%",e.style.boxShadow="0px 0px 10px black",e.style.transform="translate(-50%, -50%)",e.style.boxSizing="border-box",e.style.borderRadius="5px",e.style.width="960px",e.style.height="400px",e.style.maxWidth="95%",e.style.maxHeight="95%",e.style.fontFamily="sans-serif",document.body.appendChild(e),e}}},"./src/utils.ts":(e,t,n)=>{"use strict";function i(e,t){let n=e.get(t);if(void 0!==n)return n;throw new Error(`Key ${String(t)} not in Map ${e.toString()}`)}function s(e){return JSON.parse(JSON.stringify(e))}function o(e){let t=e.shift();if(void 0!==t)return t;throw new Error(`Shift returned undefined from Array ${e.toString()}`)}function r(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}n.r(t),n.d(t,{clone:()=>s,createElementFromHTML:()=>r,get:()=>i,shift:()=>o})},"./src/vec2.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{Vec2:()=>s});var i=n("./src/serialization/serialize.ts");class s{constructor(e=0,t=0){this.x=e,this.y=t}multiplyScalar(e){return new s(this.x*e,this.y*e)}add(e){return new s(this.x+e.x,this.y+e.y)}subtract(e){return new s(this.x-e.x,this.y-e.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const e=this.length();return 0===e?new s(0,0):new s(this.x/e,this.y/e)}}i.registerCustomType(s,"netplayjs.Vec2",e=>[e.x,e.y],e=>new s(e[0],e[1]))},"./src/wrappers/gamewrapper.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{GameWrapper:()=>d});var i=n("./src/defaultinput.ts"),s=n("./src/netcode/types.ts"),o=n("../node_modules/loglevel/lib/loglevel.js"),r=n("../node_modules/chai/index.mjs"),a=n("../node_modules/lit-html/development/lit-html.js"),l=n("./src/ui/gamemenu.ts"),c=n("./src/ewmasd.ts"),h=function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})};class d{isChannelOrdered(e){return e.ordered}isChannelReliable(e){return null===e.maxPacketLifeTime&&null===e.maxRetransmits}checkChannel(e){r.assert.isTrue(this.isChannelOrdered(e),"Data Channel must be ordered."),r.assert.isTrue(this.isChannelReliable(e),"Channel must be reliable.")}constructor(e){this.pingMeasure=new c.default(.2),this.gameClass=e,this.canvas=document.createElement("canvas");const t=e.highDPI&&window.devicePixelRatio?window.devicePixelRatio:1;if(this.canvas.width=e.canvasSize.width*t,this.canvas.height=e.canvasSize.height*t,this.canvas.style.backgroundColor="black",this.canvas.style.position="absolute",this.canvas.style.zIndex="0",this.canvas.style.boxShadow="0px 0px 10px black",this.resize(),window.addEventListener("resize",()=>this.resize()),document.body.appendChild(this.canvas),this.stats=document.createElement("div"),this.stats.style.zIndex="1",this.stats.style.position="absolute",this.stats.style.backgroundColor="rgba(0, 0, 0, 0.5)",this.stats.style.color="white",this.stats.style.padding="5px",this.stats.style.display="none",document.body.appendChild(this.stats),this.playerPausedIndicator=(()=>{const e=document.createElement("div");return e.style.zIndex="1",e.style.position="absolute",e.style.backgroundColor="rgba(0, 0, 0, 0.5)",e.style.color="white",e.style.padding="10px",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",e.style.boxSizing="border-box",e.style.fontFamily="sans-serif",e.innerHTML='\n      <p align="center" style="margin: 3px">The other player has minimized or hidden their tab.</p>\n      <p align="center" style="margin: 3px">The game may run slowly until they return.</p>\n      ',e.style.display="none",document.body.appendChild(e),e})(),this.gameClass.touchControls&&window.navigator.userAgent.toLowerCase().includes("mobile"))for(let[e,t]of Object.entries(this.gameClass.touchControls))t.show();this.inputReader=new i.DefaultInputReader(document.body,this.canvas,this.gameClass.canvasSize,this.gameClass.pointerLock||!1,this.gameClass.preventContextMenu||!1,this.gameClass.touchControls||{})}calculateLayout(e,t){const n=e.width/t.width,i=e.height/t.height,s=t.width*i>=e.width,o=s?n:i;let r=t.width*o,a=t.height*o,l=0,c=0;return s?c=e.height/2-a/2:l=e.width/2-r/2,{width:r,height:a,left:l,top:c}}resize(){const e=this.calculateLayout({width:window.innerWidth,height:window.innerHeight},this.gameClass.canvasSize);o.debug("Calculating new layout: %o",e),this.canvas.style.width=`${e.width}px`,this.canvas.style.height=`${e.height}px`,this.canvas.style.top=`${e.top}px`,this.canvas.style.left=`${e.left}px`}start(){return h(this,void 0,void 0,function*(){const e=new l.GameMenu;e.onClientStart.once(e=>{const t=[new s.NetplayPlayer(0,!1,!0),new s.NetplayPlayer(1,!0,!1)];this.watchRTCStats(e.peerConnection),this.startPing(e),this.startVisibilityWatcher(e),this.startClient(t,e)}),e.onHostStart.once(e=>{const t=[new s.NetplayPlayer(0,!0,!0),new s.NetplayPlayer(1,!1,!1)];this.watchRTCStats(e.peerConnection),this.startPing(e),this.startVisibilityWatcher(e),this.startHost(t,e)})})}startVisibilityWatcher(e){e.send({type:"visibility-state",value:document.visibilityState}),document.addEventListener("visibilitychange",()=>{o.debug(`My visibility state changed to: ${document.visibilityState}.`),e.send({type:"visibility-state",value:document.visibilityState})}),e.on("data",e=>{"visibility-state"===e.type&&("hidden"===e.value?this.playerPausedIndicator.style.display="inherit":this.playerPausedIndicator.style.display="none")})}startPing(e){setInterval(()=>{e.send({type:"ping-req",sent_time:performance.now()})},100),e.on("data",t=>{"ping-req"==t.type?e.send({type:"ping-resp",sent_time:t.sent_time}):"ping-resp"==t.type&&this.pingMeasure.update(performance.now()-t.sent_time)})}renderRTCStats(e){return a.html`
      <details>
        <summary>WebRTC Stats</summary>
        ${[...e.values()].map(e=>a.html`<div style="margin-left: 10px;">
            <details>
              <summary>${e.type}</summary>
              ${Object.entries(e).map(([t,n])=>{if("type"!==t)return a.html`<div style="margin-left: 10px;">${t}: ${e[t]}</div>`})}
            </details>
          </div>`)}
      </details>
    `}watchRTCStats(e){return h(this,void 0,void 0,function*(){const t=yield e.getStats();this.rtcStats=this.renderRTCStats(t),setTimeout(()=>h(this,void 0,void 0,function*(){yield this.watchRTCStats(e)}),1e3)})}}},"./src/wrappers/localwrapper.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{LocalWrapper:()=>o});var i=n("./src/defaultinput.ts"),s=n("./src/netcode/types.ts");class o{getPlayers(e,t){let n=[];for(let i=0;i<t;++i)n.push(new s.NetplayPlayer(i,i==e,0==i));return n}constructor(e){this.instances=[],this.gameClass=e;let t=2;"number"==typeof e.numPlayers?t=e.numPlayers:"object"==typeof e.numPlayers&&(t=parseInt(prompt("How many players should there be?")),(t>e.numPlayers.max||t<e.numPlayers.min)&&(alert("Invalid number of players."),t=e.numPlayers.max)),document.body.style.padding="5px";for(let n=0;n<t;++n){const s=document.createElement("canvas"),o=e.highDPI&&window.devicePixelRatio?window.devicePixelRatio:1;s.width=e.canvasSize.width*o,s.height=e.canvasSize.height*o,s.tabIndex=0,s.style.backgroundColor="black",s.style.boxShadow="0px 0px 10px black",s.style.margin="5px",s.style.width=`${e.canvasSize.width}px`,s.style.height=`${e.canvasSize.height}px`,document.body.appendChild(s);const r=new i.DefaultInputReader(s,s,this.gameClass.canvasSize,this.gameClass.pointerLock||!1,this.gameClass.preventContextMenu||!1,{}),a=this.getPlayers(n,t),l=new this.gameClass(s,a);this.instances.push({canvas:s,inputReader:r,game:l,players:a})}}start(){let e=performance.now(),t=n=>{if(n>=e+this.gameClass.timestep){e=n;let t=this.instances.map(e=>e.inputReader.getInput());for(let e of this.instances){let n=new Map;e.players.forEach((e,i)=>{n.set(e,t[i])}),e.game.tick(n),e.game.draw(e.canvas)}}requestAnimationFrame(t)};requestAnimationFrame(t)}}},"./src/wrappers/lockstepwrapper.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{LockstepWrapper:()=>l});var i=n("./src/defaultinput.ts"),s=n("./src/netcode/lockstep.ts"),o=n("../node_modules/loglevel/lib/loglevel.js"),r=n("./src/wrappers/gamewrapper.ts"),a=n("../node_modules/chai/index.mjs");class l extends r.GameWrapper{constructor(e){super(e)}getStateSyncPeriod(){return this.gameClass.deterministic?0:1}startHost(e,t){var n;(0,a.assert)("open"===(null===(n=t.dataChannel)||void 0===n?void 0:n.readyState),"DataChannel must be open."),o.info("Starting a lockstep host."),this.game=new this.gameClass(this.canvas,e),this.lockstepNetcode=new s.LockstepNetcode(!0,this.game,e,this.gameClass.timestep,this.getStateSyncPeriod(),()=>this.inputReader.getInput(),(e,n)=>{t.send({type:"input",frame:e,input:n.serialize()})},(e,n)=>{t.send({type:"state",frame:e,state:n})}),t.on("data",t=>{if("input"===t.type){let n=new i.DefaultInput;n.deserialize(t.input),this.lockstepNetcode.onRemoteInput(t.frame,e[1],n)}}),console.log("Client has connected... Starting game..."),this.startGameLoop()}startClient(e,t){var n;(0,a.assert)("open"===(null===(n=t.dataChannel)||void 0===n?void 0:n.readyState),"DataChannel must be open."),o.info("Starting a lockstep client."),this.game=new this.gameClass(this.canvas,e),this.lockstepNetcode=new s.LockstepNetcode(!1,this.game,e,this.gameClass.timestep,this.getStateSyncPeriod(),()=>this.inputReader.getInput(),(e,n)=>{t.send({type:"input",frame:e,input:n.serialize()})}),t.on("data",t=>{if("input"===t.type){let n=new i.DefaultInput;n.deserialize(t.input),this.lockstepNetcode.onRemoteInput(t.frame,e[0],n)}else"state"===t.type&&this.lockstepNetcode.onStateSync(t.frame,t.state)}),console.log("Successfully connected to server... Starting game..."),this.startGameLoop()}startGameLoop(){this.stats.style.display="inherit",this.lockstepNetcode.start();let e=t=>{this.game.draw(this.canvas),this.stats.innerHTML=`\n      <div>Netcode Algorithm: Lockstep</div>\n      <div>Ping: ${this.pingMeasure.average().toFixed(2)} ms +/- ${this.pingMeasure.stddev().toFixed(2)} ms</div>\n      <div>Frame Number: ${this.lockstepNetcode.frame}</div>\n      <div>Missed Frames: ${this.lockstepNetcode.missedFrames}</div>\n\n      <div>State Syncs: ${this.lockstepNetcode.stateSyncsSent} sent, ${this.lockstepNetcode.stateSyncsReceived} received</div>\n      `,requestAnimationFrame(e)};requestAnimationFrame(e)}}},"./src/wrappers/multiplayerrollbackwrapper.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{MultiplayerRollbackWrapper:()=>d});var i=n("./src/defaultinput.ts"),s=n("./src/netcode/types.ts"),o=n("./src/wrappers/gamewrapper.ts"),r=n("./src/netcode/rollback.ts"),a=n("./src/matchmaking/client.ts"),l=n("../node_modules/lit-html/development/lit-html.js"),c=n("../node_modules/query-string/index.js"),h=n("../node_modules/qrcode/lib/browser.js");class d extends o.GameWrapper{constructor(e){super(e),this.connections=[],this.uiState={kind:"connecting-to-server"},this.menuRoot=document.createElement("div"),document.body.appendChild(this.menuRoot),Object.assign(this.menuRoot.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"100",backgroundColor:"white",fontFamily:"sans-serif"})}start(){return e=this,t=void 0,i=function*(){this.gameURL=window.location.href.split("#")[0];const e=c.parse(window.location.hash),t=e.server||window.localStorage.getItem("NETPLAYJS_SERVER_OVERRIDE")||a.DEFAULT_SERVER_URL;this.matchmaker=new a.MatchmakingClient(t),this.matchmaker.onRegistered.once(()=>{e.room?this.connectToHost(e.room):this.startHosting()}),this.renderUI()},new((n=void 0)||(n=Promise))(function(s,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())});var e,t,n,i}startHost(e,t){throw new Error("MultiplayerRollbackWrapper does not use startHost. Use startHosting instead.")}startClient(e,t){throw new Error("MultiplayerRollbackWrapper does not use startClient. Use connectToHost instead.")}startHosting(){let e={room:this.matchmaker.clientID};this.matchmaker.serverURL!==a.DEFAULT_SERVER_URL&&(e.server=this.matchmaker.serverURL);const t=`${this.gameURL}#${c.stringify(e)}`,n=document.createElement("canvas");h.toCanvas(n,t),this.connections=[],this.updateUI({kind:"hosting",joinURL:t,qrCanvas:n,connectedPlayers:1,onStartGame:()=>this.startGameHost(this.connections)}),this.matchmaker.onConnection.on(e=>{e.on("open",()=>{this.connections.push(e),this.updateUI({connectedPlayers:this.connections.length+1})})})}connectToHost(e){this.updateUI({kind:"connecting-to-host"});const t=this.matchmaker.connectPeer(e);t.on("open",()=>{this.startGameClient(t)}),t.onClose.on(()=>{this.updateUI({kind:"error",error:"Connection to host closed."})})}startGameHost(e){this.updateUI({kind:"game-in-progress"});const t=e.length+1,n=[];n.push(new s.NetplayPlayer(0,!0,!0));for(let i=0;i<e.length;i++)n.push(new s.NetplayPlayer(i+1,!1,!1)),e[i].send({type:"start",playerID:i+1,numPlayers:t}),this.watchRTCStats(e[i].peerConnection),this.startPing(e[i]),this.startVisibilityWatcher(e[i]);this.game=new this.gameClass(this.canvas,n),this.rollbackNetcode=new r.RollbackNetcode(!0,this.game,n,this.getInitialInputs(n),10,this.pingMeasure,this.gameClass.timestep,()=>this.inputReader.getInput(),(t,n)=>{for(const i of e)i.send({type:"input",playerID:0,frame:t,input:n.serialize()})},(t,n)=>{for(const i of e)i.send({type:"state",frame:t,state:n})});for(let t=0;t<e.length;t++){const s=e[t],o=t+1;s.on("data",s=>{if("input"===s.type){let r=new i.DefaultInput;r.deserialize(s.input),this.rollbackNetcode.onRemoteInput(s.frame,n[o],r);for(let n=0;n<e.length;n++)t!==n&&e[n].send({type:"input",playerID:o,frame:s.frame,input:s.input})}})}this.startGameLoop()}startGameClient(e){this.updateUI({kind:"connecting-to-host"}),e.on("data",t=>{if("start"===t.type){const n=t.playerID,o=t.numPlayers,a=[];for(let e=0;e<o;e++)a.push(new s.NetplayPlayer(e,e===n,0===e));this.game=new this.gameClass(this.canvas,a),this.rollbackNetcode=new r.RollbackNetcode(!1,this.game,a,this.getInitialInputs(a),10,this.pingMeasure,this.gameClass.timestep,()=>this.inputReader.getInput(),(t,n)=>{e.send({type:"input",frame:t,input:n.serialize()})}),e.on("data",e=>{if("input"===e.type){let t=new i.DefaultInput;t.deserialize(e.input),this.rollbackNetcode.onRemoteInput(e.frame,a[e.playerID],t)}else"state"===e.type&&this.rollbackNetcode.onStateSync(e.frame,e.state)}),this.watchRTCStats(e.peerConnection),this.startPing(e),this.startVisibilityWatcher(e),this.updateUI({kind:"game-in-progress"}),this.startGameLoop()}})}getInitialInputs(e){let t=new Map;for(let n of e)t.set(n,new i.DefaultInput);return t}startGameLoop(){this.stats.style.display="inherit",this.rollbackNetcode.start();let e=t=>{this.game.draw(this.canvas);const n=l.html`
        <div>Netcode Algorithm: Rollback</div>
        <div>Ping: ${this.pingMeasure.average().toFixed(2)} ms +/- ${this.pingMeasure.stddev().toFixed(2)} ms</div>
        <div>History Size: ${this.rollbackNetcode.history.length}</div>
        <div>Frame Number: ${this.rollbackNetcode.currentFrame()}</div>
        <div>Largest Future Size: ${this.rollbackNetcode.largestFutureSize()}</div>
        <div>Predicted Frames: ${this.rollbackNetcode.predictedFrames()}</div>
        <div title="If true, then the other player is running slow, so we wait for them.">Stalling: ${this.rollbackNetcode.shouldStall()}</div>
        ${this.rtcStats}`;l.render(n,this.stats),requestAnimationFrame(e)};requestAnimationFrame(e)}updateUI(e){this.uiState=Object.assign(Object.assign({},this.uiState),e),this.renderUI()}renderUI(){if("game-in-progress"===this.uiState.kind)return void(this.menuRoot.style.display="none");let e;"connecting-to-server"===this.uiState.kind?e=l.html`<div>Connecting to matchmaking server...</div>`:"hosting"===this.uiState.kind?e=l.html`
            <div style="text-align: center;">
                <h1>Waiting for Players</h1>
                <p>Connected: ${this.uiState.connectedPlayers}</p>
                <p>Share this URL:</p>
                <a href="${this.uiState.joinURL}" target="_blank">${this.uiState.joinURL}</a>
                <div>${this.uiState.qrCanvas}</div>
                <button style="font-size: 1.5em; margin-top: 10px;" @click=${this.uiState.onStartGame}>Start Game</button>
            </div>
          `:"connecting-to-host"===this.uiState.kind?e=l.html`<div>Connecting to host...</div>`:"error"===this.uiState.kind&&(e=l.html`<div>Error: ${this.uiState.error}</div>`),l.render(e,this.menuRoot)}}},"./src/wrappers/rollbackwrapper.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{RollbackWrapper:()=>c});var i=n("./src/defaultinput.ts"),s=n("../node_modules/loglevel/lib/loglevel.js"),o=n("./src/wrappers/gamewrapper.ts"),r=n("./src/netcode/rollback.ts"),a=n("../node_modules/chai/index.mjs"),l=n("../node_modules/lit-html/development/lit-html.js");class c extends o.GameWrapper{constructor(e){super(e)}getInitialInputs(e){let t=new Map;for(let n of e)t.set(n,new i.DefaultInput);return t}startHost(e,t){var n;(0,a.assert)("open"===(null===(n=t.dataChannel)||void 0===n?void 0:n.readyState),"DataChannel must be open."),s.info("Starting a lcokstep host."),this.game=new this.gameClass(this.canvas,e),this.rollbackNetcode=new r.RollbackNetcode(!0,this.game,e,this.getInitialInputs(e),10,this.pingMeasure,this.gameClass.timestep,()=>this.inputReader.getInput(),(e,n)=>{t.send({type:"input",frame:e,input:n.serialize()})},(e,n)=>{t.send({type:"state",frame:e,state:n})}),t.on("data",t=>{if("input"===t.type){let n=new i.DefaultInput;n.deserialize(t.input),this.rollbackNetcode.onRemoteInput(t.frame,e[1],n)}}),console.log("Client has connected... Starting game..."),this.startGameLoop()}startClient(e,t){var n;(0,a.assert)("open"===(null===(n=t.dataChannel)||void 0===n?void 0:n.readyState),"DataChannel must be open."),s.info("Starting a lockstep client."),this.game=new this.gameClass(this.canvas,e),this.rollbackNetcode=new r.RollbackNetcode(!1,this.game,e,this.getInitialInputs(e),10,this.pingMeasure,this.gameClass.timestep,()=>this.inputReader.getInput(),(e,n)=>{t.send({type:"input",frame:e,input:n.serialize()})}),t.on("data",t=>{if("input"===t.type){let n=new i.DefaultInput;n.deserialize(t.input),this.rollbackNetcode.onRemoteInput(t.frame,e[0],n)}else"state"===t.type&&this.rollbackNetcode.onStateSync(t.frame,t.state)}),console.log("Successfully connected to server... Starting game..."),this.startGameLoop()}startGameLoop(){this.stats.style.display="inherit",this.rollbackNetcode.start();let e=t=>{this.game.draw(this.canvas);const n=l.html`
        <div>Netcode Algorithm: Rollback</div>
        <div>Ping: ${this.pingMeasure.average().toFixed(2)} ms +/- ${this.pingMeasure.stddev().toFixed(2)} ms</div>
        <div>History Size: ${this.rollbackNetcode.history.length}</div>
        <div>Frame Number: ${this.rollbackNetcode.currentFrame()}</div>
        <div>Largest Future Size: ${this.rollbackNetcode.largestFutureSize()}</div>
        <div>Predicted Frames: ${this.rollbackNetcode.predictedFrames()}</div>
        <div title="If true, then the other player is running slow, so we wait for them.">Stalling: ${this.rollbackNetcode.shouldStall()}</div>
        ${this.rtcStats}`;l.render(n,this.stats),requestAnimationFrame(e)};requestAnimationFrame(e)}}},"../netplayjs-common/typedevent.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{TypedEvent:()=>i});class i{constructor(){this.listeners=[],this.listenersOncer=[],this.on=e=>(this.listeners.push(e),{dispose:()=>this.off(e)}),this.once=e=>{this.listenersOncer.push(e)},this.off=e=>{var t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)},this.emit=e=>{if(this.listeners.forEach(t=>t(e)),this.listenersOncer.length>0){const t=this.listenersOncer;this.listenersOncer=[],t.forEach(t=>t(e))}},this.pipe=e=>this.on(t=>e.emit(t))}}},"../node_modules/type-detect/type-detect.js":function(e,t,n){e.exports=function(){"use strict";var e="function"==typeof Promise,t="object"==typeof self?self:n.g,i="undefined"!=typeof Symbol,s="undefined"!=typeof Map,o="undefined"!=typeof Set,r="undefined"!=typeof WeakMap,a="undefined"!=typeof WeakSet,l="undefined"!=typeof DataView,c=i&&void 0!==Symbol.iterator,h=i&&void 0!==Symbol.toStringTag,d=o&&"function"==typeof Set.prototype.entries,u=s&&"function"==typeof Map.prototype.entries,p=d&&Object.getPrototypeOf((new Set).entries()),f=u&&Object.getPrototypeOf((new Map).entries()),m=c&&"function"==typeof Array.prototype[Symbol.iterator],g=m&&Object.getPrototypeOf([][Symbol.iterator]()),y=c&&"function"==typeof String.prototype[Symbol.iterator],b=y&&Object.getPrototypeOf(""[Symbol.iterator]());return function(n){var i=typeof n;if("object"!==i)return i;if(null===n)return"null";if(n===t)return"global";if(Array.isArray(n)&&(!1===h||!(Symbol.toStringTag in n)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&n===window.location)return"Location";if("object"==typeof window.document&&n===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&n===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&n===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&n instanceof window.HTMLElement){if("BLOCKQUOTE"===n.tagName)return"HTMLQuoteElement";if("TD"===n.tagName)return"HTMLTableDataCellElement";if("TH"===n.tagName)return"HTMLTableHeaderCellElement"}}var c=h&&n[Symbol.toStringTag];if("string"==typeof c)return c;var d=Object.getPrototypeOf(n);return d===RegExp.prototype?"RegExp":d===Date.prototype?"Date":e&&d===Promise.prototype?"Promise":o&&d===Set.prototype?"Set":s&&d===Map.prototype?"Map":a&&d===WeakSet.prototype?"WeakSet":r&&d===WeakMap.prototype?"WeakMap":l&&d===DataView.prototype?"DataView":s&&d===f?"Map Iterator":o&&d===p?"Set Iterator":m&&d===g?"Array Iterator":y&&d===b?"String Iterator":null===d?"Object":Object.prototype.toString.call(n).slice(8,-1)}}()},"?9a07":()=>{},"../node_modules/chai/index.mjs":(e,t,n)=>{"use strict";n.r(t),n.d(t,{Assertion:()=>r,AssertionError:()=>a,assert:()=>u,config:()=>c,core:()=>p,default:()=>f,expect:()=>s,should:()=>d,use:()=>h,util:()=>l,version:()=>o});var i=n("../node_modules/chai/index.js");const s=i.expect,o=i.version,r=i.Assertion,a=i.AssertionError,l=i.util,c=i.config,h=i.use,d=i.should,u=i.assert,p=i.core,f=i},"../node_modules/eventemitter3/index.mjs":(e,t,n)=>{"use strict";n.r(t),n.d(t,{EventEmitter:()=>i,default:()=>s});var i=n("../node_modules/eventemitter3/index.js");const s=i},"../node_modules/lit-html/development/lit-html.js":(e,t,n)=>{"use strict";var i,s,o,r;n.r(t),n.d(t,{_$LH:()=>Z,html:()=>R,noChange:()=>D,nothing:()=>z,render:()=>te,svg:()=>L});const a=window,l=e=>{a.emitLitDebugLogEvents&&a.dispatchEvent(new CustomEvent("lit-debug",{detail:e}))};let c,h=0;null!==(i=a.litIssuedWarnings)&&void 0!==i||(a.litIssuedWarnings=new Set),c=(e,t)=>{t+=e?` See https://lit.dev/msg/${e} for more information.`:"",a.litIssuedWarnings.has(t)||(console.warn(t),a.litIssuedWarnings.add(t))},c("dev-mode","Lit is in dev mode. Not recommended for production!");const d=(null===(s=a.ShadyDOM)||void 0===s?void 0:s.inUse)&&!0===(null===(o=a.ShadyDOM)||void 0===o?void 0:o.noPatch)?a.ShadyDOM.wrap:e=>e,u=a.trustedTypes,p=u?u.createPolicy("lit-html",{createHTML:e=>e}):void 0,f=e=>e,m=(e,t,n)=>f,g=(e,t,n)=>$(e,t,n),y="$lit$",b=`lit$${String(Math.random()).slice(9)}$`,v="?"+b,w=`<${v}>`,x=document,k=()=>x.createComment(""),S=e=>null===e||"object"!=typeof e&&"function"!=typeof e,_=Array.isArray,P=e=>_(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),M="[ \t\n\f\r]",j=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,E=/-->/g,T=/>/g,C=new RegExp(`>|${M}(?:([^\\s"'>=/]+)(${M}*=${M}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),I=/'/g,A=/"/g,N=/^(?:script|style|textarea|title)$/i,O=e=>(t,...n)=>(t.some(e=>void 0===e)&&console.warn("Some template strings are undefined.\nThis is probably caused by illegal octal escape sequences."),{_$litType$:e,strings:t,values:n}),R=O(1),L=O(2),D=Symbol.for("lit-noChange"),z=Symbol.for("lit-nothing"),B=new WeakMap,U=x.createTreeWalker(x,129,null,!1);let $=m;const q=(e,t)=>{const n=e.length-1,i=[];let s,o=2===t?"<svg>":"",r=j;for(let t=0;t<n;t++){const n=e[t];let a,l,c=-1,h=0;for(;h<n.length&&(r.lastIndex=h,l=r.exec(n),null!==l);)if(h=r.lastIndex,r===j){if("!--"===l[1])r=E;else if(void 0!==l[1])r=T;else if(void 0!==l[2])N.test(l[2])&&(s=new RegExp(`</${l[2]}`,"g")),r=C;else if(void 0!==l[3])throw new Error("Bindings in tag names are not supported. Please use static templates instead. See https://lit.dev/docs/templates/expressions/#static-expressions")}else r===C?">"===l[0]?(r=null!=s?s:j,c=-1):void 0===l[1]?c=-2:(c=r.lastIndex-l[2].length,a=l[1],r=void 0===l[3]?C:'"'===l[3]?A:I):r===A||r===I?r=C:r===E||r===T?r=j:(r=C,s=void 0);console.assert(-1===c||r===C||r===I||r===A,"unexpected parse state B");const d=r===C&&e[t+1].startsWith("/>")?" ":"";o+=r===j?n+w:c>=0?(i.push(a),n.slice(0,c)+y+n.slice(c)+b+d):n+b+(-2===c?(i.push(void 0),t):d)}const a=o+(e[n]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw")){let e="invalid template strings array";throw e="\n          Internal Error: expected template strings to be an array\n          with a 'raw' field. Faking a template strings array by\n          calling html or svg like an ordinary function is effectively\n          the same as calling unsafeHtml and can lead to major security\n          issues, e.g. opening your code up to XSS attacks.\n\n          If you're using the html or svg tagged template functions normally\n          and still seeing this error, please file a bug at\n          https://github.com/lit/lit/issues/new?template=bug_report.md\n          and include information about your build tooling, if any.\n        ".trim().replace(/\n */g,"\n"),new Error(e)}return[void 0!==p?p.createHTML(a):a,i]};class F{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let s=0,o=0;const r=e.length-1,a=this.parts,[h,d]=q(e,t);if(this.el=F.createElement(h,n),U.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=U.nextNode())&&a.length<r;){if(1===i.nodeType){{const e=i.localName;if(/^(?:textarea|template)$/i.test(e)&&i.innerHTML.includes(b)){const t=`Expressions are not supported inside \`${e}\` elements. See https://lit.dev/msg/expression-in-${e} for more information.`;if("template"===e)throw new Error(t);c("",t)}}if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith(y)||t.startsWith(b)){const n=d[o++];if(e.push(t),void 0!==n){const e=i.getAttribute(n.toLowerCase()+y).split(b),t=/([.?@])?(.*)/.exec(n);a.push({type:1,index:s,name:t[2],strings:e,ctor:"."===t[1]?Y:"?"===t[1]?K:"@"===t[1]?Q:G})}else a.push({type:6,index:s})}for(const t of e)i.removeAttribute(t)}if(N.test(i.tagName)){const e=i.textContent.split(b),t=e.length-1;if(t>0){i.textContent=u?u.emptyScript:"";for(let n=0;n<t;n++)i.append(e[n],k()),U.nextNode(),a.push({type:2,index:++s});i.append(e[t],k())}}}else if(8===i.nodeType)if(i.data===v)a.push({type:2,index:s});else{let e=-1;for(;-1!==(e=i.data.indexOf(b,e+1));)a.push({type:7,index:s}),e+=b.length-1}s++}null==l||l({kind:"template prep",template:this,clonableTemplate:this.el,parts:this.parts,strings:e})}static createElement(e,t){const n=x.createElement("template");return n.innerHTML=e,n}}function V(e,t,n=e,i){var s,o,r,a;if(t===D)return t;let l=void 0!==i?null===(s=n.__directives)||void 0===s?void 0:s[i]:n.__directive;const c=S(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(o=null==l?void 0:l._$notifyDirectiveConnectionChanged)||void 0===o||o.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$initialize(e,n,i)),void 0!==i?(null!==(r=(a=n).__directives)&&void 0!==r?r:a.__directives=[])[i]=l:n.__directive=l),void 0!==l&&(t=V(e,l._$resolve(e,t.values),l,i)),t}class H{constructor(e,t){this._parts=[],this._$disconnectableChildren=void 0,this._$template=e,this._$parent=t}get parentNode(){return this._$parent.parentNode}get _$isConnected(){return this._$parent._$isConnected}_clone(e){var t;const{el:{content:n},parts:i}=this._$template,s=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:x).importNode(n,!0);U.currentNode=s;let o=U.nextNode(),r=0,a=0,l=i[0];for(;void 0!==l;){if(r===l.index){let t;2===l.type?t=new W(o,o.nextSibling,this,e):1===l.type?t=new l.ctor(o,l.name,l.strings,this,e):6===l.type&&(t=new X(o,this,e)),this._parts.push(t),l=i[++a]}r!==(null==l?void 0:l.index)&&(o=U.nextNode(),r++)}return s}_update(e){let t=0;for(const n of this._parts)void 0!==n&&(null==l||l({kind:"set part",part:n,value:e[t],valueIndex:t,values:e,templateInstance:this}),void 0!==n.strings?(n._$setValue(e,n,t),t+=n.strings.length-2):n._$setValue(e[t])),t++}}class W{constructor(e,t,n,i){var s;this.type=2,this._$committedValue=z,this._$disconnectableChildren=void 0,this._$startNode=e,this._$endNode=t,this._$parent=n,this.options=i,this.__isConnected=null===(s=null==i?void 0:i.isConnected)||void 0===s||s,this._textSanitizer=void 0}get _$isConnected(){var e,t;return null!==(t=null===(e=this._$parent)||void 0===e?void 0:e._$isConnected)&&void 0!==t?t:this.__isConnected}get parentNode(){let e=d(this._$startNode).parentNode;const t=this._$parent;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$startNode}get endNode(){return this._$endNode}_$setValue(e,t=this){var n;if(null===this.parentNode)throw new Error("This `ChildPart` has no `parentNode` and therefore cannot accept a value. This likely means the element containing the part was manipulated in an unsupported way outside of Lit's control such that the part's marker nodes were ejected from DOM. For example, setting the element's `innerHTML` or `textContent` can do this.");if(e=V(this,e,t),S(e))e===z||null==e||""===e?(this._$committedValue!==z&&(null==l||l({kind:"commit nothing to child",start:this._$startNode,end:this._$endNode,parent:this._$parent,options:this.options}),this._$clear()),this._$committedValue=z):e!==this._$committedValue&&e!==D&&this._commitText(e);else if(void 0!==e._$litType$)this._commitTemplateResult(e);else if(void 0!==e.nodeType){if((null===(n=this.options)||void 0===n?void 0:n.host)===e)return this._commitText("[probable mistake: rendered a template's host in itself (commonly caused by writing ${this} in a template]"),void console.warn("Attempted to render the template host",e,"inside itself. This is almost always a mistake, and in dev mode ","we render some warning text. In production however, we'll ","render it, which will usually result in an error, and sometimes ","in the element disappearing from the DOM.");this._commitNode(e)}else P(e)?this._commitIterable(e):this._commitText(e)}_insert(e){return d(d(this._$startNode).parentNode).insertBefore(e,this._$endNode)}_commitNode(e){var t;if(this._$committedValue!==e){if(this._$clear(),$!==m){const e=null===(t=this._$startNode.parentNode)||void 0===t?void 0:t.nodeName;if("STYLE"===e||"SCRIPT"===e){let t="Forbidden";throw t="STYLE"===e?"Lit does not support binding inside style nodes. This is a security risk, as style injection attacks can exfiltrate data and spoof UIs. Consider instead using css`...` literals to compose styles, and make do dynamic styling with css custom properties, ::parts, <slot>s, and by mutating the DOM rather than stylesheets.":"Lit does not support binding inside script nodes. This is a security risk, as it could allow arbitrary code execution.",new Error(t)}}null==l||l({kind:"commit node",start:this._$startNode,parent:this._$parent,value:e,options:this.options}),this._$committedValue=this._insert(e)}}_commitText(e){if(this._$committedValue!==z&&S(this._$committedValue)){const t=d(this._$startNode).nextSibling;void 0===this._textSanitizer&&(this._textSanitizer=g(t,"data","property")),e=this._textSanitizer(e),null==l||l({kind:"commit text",node:t,value:e,options:this.options}),t.data=e}else{const t=x.createTextNode("");this._commitNode(t),void 0===this._textSanitizer&&(this._textSanitizer=g(t,"data","property")),e=this._textSanitizer(e),null==l||l({kind:"commit text",node:t,value:e,options:this.options}),t.data=e}this._$committedValue=e}_commitTemplateResult(e){var t;const{values:n,_$litType$:i}=e,s="number"==typeof i?this._$getTemplate(e):(void 0===i.el&&(i.el=F.createElement(i.h,this.options)),i);if((null===(t=this._$committedValue)||void 0===t?void 0:t._$template)===s)null==l||l({kind:"template updating",template:s,instance:this._$committedValue,parts:this._$committedValue._parts,options:this.options,values:n}),this._$committedValue._update(n);else{const e=new H(s,this),t=e._clone(this.options);null==l||l({kind:"template instantiated",template:s,instance:e,parts:e._parts,options:this.options,fragment:t,values:n}),e._update(n),null==l||l({kind:"template instantiated and updated",template:s,instance:e,parts:e._parts,options:this.options,fragment:t,values:n}),this._commitNode(t),this._$committedValue=e}}_$getTemplate(e){let t=B.get(e.strings);return void 0===t&&B.set(e.strings,t=new F(e)),t}_commitIterable(e){_(this._$committedValue)||(this._$committedValue=[],this._$clear());const t=this._$committedValue;let n,i=0;for(const s of e)i===t.length?t.push(n=new W(this._insert(k()),this._insert(k()),this,this.options)):n=t[i],n._$setValue(s),i++;i<t.length&&(this._$clear(n&&d(n._$endNode).nextSibling,i),t.length=i)}_$clear(e=d(this._$startNode).nextSibling,t){var n;for(null===(n=this._$notifyConnectionChanged)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$endNode;){const t=d(e).nextSibling;d(e).remove(),e=t}}setConnected(e){var t;if(void 0!==this._$parent)throw new Error("part.setConnected() may only be called on a RootPart returned from render().");this.__isConnected=e,null===(t=this._$notifyConnectionChanged)||void 0===t||t.call(this,e)}}class G{constructor(e,t,n,i,s){this.type=1,this._$committedValue=z,this._$disconnectableChildren=void 0,this.element=e,this.name=t,this._$parent=i,this.options=s,n.length>2||""!==n[0]||""!==n[1]?(this._$committedValue=new Array(n.length-1).fill(new String),this.strings=n):this._$committedValue=z,this._sanitizer=void 0}get tagName(){return this.element.tagName}get _$isConnected(){return this._$parent._$isConnected}_$setValue(e,t=this,n,i){const s=this.strings;let o=!1;if(void 0===s)e=V(this,e,t,0),o=!S(e)||e!==this._$committedValue&&e!==D,o&&(this._$committedValue=e);else{const i=e;let r,a;for(e=s[0],r=0;r<s.length-1;r++)a=V(this,i[n+r],t,r),a===D&&(a=this._$committedValue[r]),o||(o=!S(a)||a!==this._$committedValue[r]),a===z?e=z:e!==z&&(e+=(null!=a?a:"")+s[r+1]),this._$committedValue[r]=a}o&&!i&&this._commitValue(e)}_commitValue(e){e===z?d(this.element).removeAttribute(this.name):(void 0===this._sanitizer&&(this._sanitizer=$(this.element,this.name,"attribute")),e=this._sanitizer(null!=e?e:""),null==l||l({kind:"commit attribute",element:this.element,name:this.name,value:e,options:this.options}),d(this.element).setAttribute(this.name,null!=e?e:""))}}class Y extends G{constructor(){super(...arguments),this.type=3}_commitValue(e){void 0===this._sanitizer&&(this._sanitizer=$(this.element,this.name,"property")),e=this._sanitizer(e),null==l||l({kind:"commit property",element:this.element,name:this.name,value:e,options:this.options}),this.element[this.name]=e===z?void 0:e}}const J=u?u.emptyScript:"";class K extends G{constructor(){super(...arguments),this.type=4}_commitValue(e){null==l||l({kind:"commit boolean attribute",element:this.element,name:this.name,value:!(!e||e===z),options:this.options}),e&&e!==z?d(this.element).setAttribute(this.name,J):d(this.element).removeAttribute(this.name)}}class Q extends G{constructor(e,t,n,i,s){if(super(e,t,n,i,s),this.type=5,void 0!==this.strings)throw new Error(`A \`<${e.localName}>\` has a \`@${t}=...\` listener with invalid content. Event listeners in templates must have exactly one expression and no surrounding text.`)}_$setValue(e,t=this){var n;if((e=null!==(n=V(this,e,t,0))&&void 0!==n?n:z)===D)return;const i=this._$committedValue,s=e===z&&i!==z||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==z&&(i===z||s);null==l||l({kind:"commit event listener",element:this.element,name:this.name,value:e,options:this.options,removeListener:s,addListener:o,oldListener:i}),s&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$committedValue=e}handleEvent(e){var t,n;"function"==typeof this._$committedValue?this._$committedValue.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$committedValue.handleEvent(e)}}class X{constructor(e,t,n){this.element=e,this.type=6,this._$disconnectableChildren=void 0,this._$parent=t,this.options=n}get _$isConnected(){return this._$parent._$isConnected}_$setValue(e){null==l||l({kind:"commit to element binding",element:this.element,value:e,options:this.options}),V(this,e)}}const Z={_boundAttributeSuffix:y,_marker:b,_markerMatch:v,_HTML_RESULT:1,_getTemplateHtml:q,_TemplateInstance:H,_isIterable:P,_resolveDirective:V,_ChildPart:W,_AttributePart:G,_BooleanAttributePart:K,_EventPart:Q,_PropertyPart:Y,_ElementPart:X},ee=a.litHtmlPolyfillSupportDevMode;null==ee||ee(F,W),(null!==(r=a.litHtmlVersions)&&void 0!==r?r:a.litHtmlVersions=[]).push("2.7.0"),a.litHtmlVersions.length>1&&c("multiple-versions","Multiple versions of Lit loaded. Loading multiple versions is not recommended.");const te=(e,t,n)=>{var i,s;if(null==t)throw new TypeError(`The container to render into may not be ${t}`);const o=h++,r=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:t;let a=r._$litPart$;if(null==l||l({kind:"begin render",id:o,value:e,container:t,options:n,part:a}),void 0===a){const e=null!==(s=null==n?void 0:n.renderBefore)&&void 0!==s?s:null;r._$litPart$=a=new W(t.insertBefore(k(),e),e,void 0,null!=n?n:{})}return a._$setValue(e),null==l||l({kind:"end render",id:o,value:e,container:t,options:n,part:a}),a};te.setSanitizer=e=>{if($!==m)throw new Error("Attempted to overwrite existing lit-html security policy. setSanitizeDOMValueFactory should be called at most once.");$=e},te.createSanitizer=g,te._testOnlyClearSanitizerFactoryDoNotCallOrElse=()=>{$=m}},"./package.json":e=>{"use strict";e.exports=JSON.parse('{"name":"netplayjs","version":"0.4.1","main":"dist/netplay.js","types":"./dist/types/index.d.ts","description":"A framework for making P2P multiplayer games in Javascript.","repository":{"type":"git","url":"https://github.com/rameshvarun/netplayjs.git"},"keywords":["multiplayer","webrtc","typescript","p2p","javascript","rtc"],"homepage":"https://rameshvarun.github.io/netplayjs/","dependencies":{"@types/msgpack-lite":"^0.1.8","@vramesh/netplayjs-common":"^0.0.1","chai":"^4.3.0","eventemitter3":"^5.0.0","lit-html":"^2.7.0","loglevel":"^1.7.1","msgpack-lite":"^0.1.26","qrcode":"^1.5.1","query-string":"^6.14.0","react":"^18.2.0","react-dom":"^18.2.0","type-fest":"^0.8.1"},"scripts":{"build":"rm -rf dist/ && npm run typegen && webpack --env production && webpack --env development","build:watch":"watch \'npm run build\' src/","format":"prettier --write src/**/*.ts src/*.ts","typecheck":"tsc --noEmit","check-format":"prettier-check src/**/*.ts","test":"jest","typegen":"tsc --declaration --emitDeclarationOnly","prepublish":"cp ../README.md . && cp -r ../media ."},"license":"ISC","devDependencies":{"@types/chai":"^4.2.15","@types/jest":"^26.0.20","jest":"^26.6.3","madge":"^4.0.2","prettier":"^2.2.1","prettier-check":"^2.0.0","ts-jest":"^26.5.1","ts-loader":"^9.4.2","typescript":"^4.5.5","watch":"^1.0.2","webpack":"^5.77.0","webpack-cli":"^5.0.1","webpack-merge":"^5.8.0"}}')}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";n.r(i),n.d(i,{DefaultInput:()=>t.DefaultInput,DefaultInputReader:()=>t.DefaultInputReader,Game:()=>l.Game,GameWrapper:()=>s.GameWrapper,LocalWrapper:()=>h.LocalWrapper,LockstepWrapper:()=>o.LockstepWrapper,MultiplayerRollbackWrapper:()=>a.MultiplayerRollbackWrapper,NetplayInput:()=>e.NetplayInput,NetplayPlayer:()=>e.NetplayPlayer,NetplayState:()=>e.NetplayState,RollbackWrapper:()=>r.RollbackWrapper,TouchControl:()=>c.TouchControl,Vec2:()=>d.Vec2,VirtualJoystick:()=>c.VirtualJoystick});var e=n("./src/netcode/types.ts"),t=n("./src/defaultinput.ts"),s=n("./src/wrappers/gamewrapper.ts"),o=n("./src/wrappers/lockstepwrapper.ts"),r=n("./src/wrappers/rollbackwrapper.ts"),a=n("./src/wrappers/multiplayerrollbackwrapper.ts"),l=n("./src/game.ts"),c=n("./src/touchcontrols.ts"),h=n("./src/wrappers/localwrapper.ts"),d=n("./src/vec2.ts")})(),i})(),e.exports=t()}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}(()=>{"use strict";var e=n(343);const t={};class i{fire(t,n){let i=null,s=1/0;for(const e of n.enemies){const n=Math.sqrt(Math.pow(t.pos.x-e.pos.x,2)+Math.pow(t.pos.y-e.pos.y,2));n<s&&(s=n,i=e)}const o=i?Math.atan2(i.pos.y-t.pos.y,i.pos.x-t.pos.x):1===t.direction?0:Math.PI;let r=10*t.stats.damageMult;if(n.random()<t.stats.critChance&&(r*=2),t.ultActiveTime>0)return;const a=t.weaponLevel,l=a>=5,c=l?"rasenshuriken":"shuriken",h=l?3*r:r,d=l?5:t.stats.piercing,u=l?100:200,p=l?60:20;if(n.spawnProjectile(t.id,t.pos,o,u,h,c,t.stats.knockback+2,d,p),!l){if(a>=2&&(t.burstTimer=.1,t.burstCount=1),a>=3){const i=new e.Vec2(t.pos.x-40,t.pos.y);n.spawnProjectile(t.id,i,o,u,h,c,t.stats.knockback+2,d,p)}if(a>=4){const i=new e.Vec2(t.pos.x+40,t.pos.y);n.spawnProjectile(t.id,i,o,u,h,c,t.stats.knockback+2,d,p)}}}}const s={naruto:{skillQ:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i)}onPress(t,n,i){if(t.cooldown<=0){const s=16,o=50;for(let t=0;t<s;t++){const r=t/s*Math.PI*2,a=new e.Vec2(Math.cos(r)*o,Math.sin(r)*o),l=new e.Vec2(n.pos.x+a.x,n.pos.y+a.y);i.spawnProjectile(n.id,l,r,50,20*n.stats.damageMult,"clone_punch",50+n.stats.knockback,99,30)}const r={pos:n.pos,shape:{type:"circle",radius:150}},a=i.spatialHash.query(r);for(const e of a){const t=e;if(!t.dead&&Math.sqrt(Math.pow(n.pos.x-t.pos.x,2)+Math.pow(n.pos.y-t.pos.y,2))<150){const e=30*n.stats.damageMult;i.damageEnemy(t,e,n);const s=Math.atan2(t.pos.y-n.pos.y,t.pos.x-n.pos.x);t.push.x+=800*Math.cos(s),t.push.y+=800*Math.sin(s)}}i.spawnFloatingText(n.pos,"Uzumaki Barrage!","orange",n.id),t.cooldown=10*n.stats.cooldownMult}}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){}},skillE:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i),t.skillCharging||t.dashTime>0?t.invincible=!0:"naruto"===t.character&&t.ultActiveTime<=0&&(t.invincible=!1)}onPress(e,t,n){(e.cooldown<=0||e.isCharging)&&(e.isCharging=!0)}onHold(e,t,n,i){(e.cooldown<=0||e.isCharging)&&(e.isCharging=!0,e.chargeTime=Math.min(e.chargeTime+i,1.5),t.direction=Math.abs(t.aimAngle)>Math.PI/2?-1:1,t.skillCharging=!0,t.skillChargeTime=e.chargeTime,t.invincible=!0)}onRelease(t,n,i){if(t.chargeTime>0){const i=t.chargeTime/1.5,s=600,o=75,r=o+i*(375-o);n.dashTime=r/s,n.dashHitList=[],n.dashVec=new e.Vec2(Math.cos(n.aimAngle)*s,Math.sin(n.aimAngle)*s),t.chargeTime=0,t.isCharging=!1,t.cooldown=5*n.stats.cooldownMult,n.skillCharging=!1,n.skillChargeTime=0,n.invincible=!0,"naruto"===n.character&&n.charState&&(n.charState.rasenganSize=1+2*i)}}draw(e,n,i,s){if(n.isCharging){e.save(),e.translate(i.pos.x,i.pos.y);const o=75,r=o+n.chargeTime/1.5*(375-o);e.save(),e.rotate(i.aimAngle),e.fillStyle="rgba(0, 210, 255, 0.2)",e.fillRect(0,-2,r,4);const a=1+n.chargeTime/1.5*2;e.beginPath(),e.arc(r,0,50*a*.4/2,0,2*Math.PI),e.fillStyle="rgba(0, 210, 255, 0.3)",e.fill(),e.restore(),e.save();const l=.4*a;e.scale(l,l),e.rotate(10*s.gameTime),t.rasengan&&e.drawImage(t.rasengan,-50,-50),e.restore(),e.restore()}}},ult:new class{update(t,n,i,s){if(t.cooldown>0&&(t.cooldown-=s),t.activeTime>0){t.activeTime-=s,n.ultActiveTime=t.activeTime,n.invincible=!0;const o=2e3,r={pos:n.pos,shape:{type:"capsule",radius:30,startOffset:new e.Vec2(0,0),endOffset:new e.Vec2(Math.cos(n.aimAngle)*o,Math.sin(n.aimAngle)*o)}},a=i.spatialHash.query(r);for(const e of a){const t=e;if(!t.dead&&i.spatialHash.checkCollision(r,t)){const e=5*n.stats.damageMult;i.damageEnemy(t,e,n)}}}else"naruto"===n.character&&!n.skillCharging&&n.dashTime<=0&&(n.invincible=!1)}onPress(e,t,n){e.cooldown<=0&&(e.activeTime=6,e.cooldown=25*t.stats.cooldownMult,t.ultActiveTime=6)}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,n,i,s){if(n.activeTime>0){e.save(),e.globalAlpha=.8,e.shadowBlur=20,e.shadowColor="red",t.kurama&&e.drawImage(t.kurama,i.pos.x-150,i.pos.y-180),e.save(),e.translate(i.pos.x,i.pos.y),e.rotate(i.aimAngle);const n=e.createLinearGradient(0,-30,0,30);n.addColorStop(0,"rgba(255, 0, 0, 0)"),n.addColorStop(.5,"rgba(255, 200, 0, 0.9)"),n.addColorStop(1,"rgba(255, 0, 0, 0)"),e.fillStyle=n,e.fillRect(0,-30,2e3,60),e.restore(),e.shadowBlur=0,e.restore()}}}},sasuke:{skillQ:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i)}onPress(e,t,n){if(e.cooldown<=0){const i=100,s=40*t.stats.damageMult;n.spawnProjectile(t.id,t.pos,t.aimAngle,i,s,"fireball",50+t.stats.knockback,100+t.stats.piercing,30),e.cooldown=6*t.stats.cooldownMult}}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){}},skillE:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i),e.activeTime>0?(e.activeTime-=i,t.invincible=!0):"sasuke"===t.character&&!t.skillCharging&&t.dashTime<=0&&(t.invincible=!1)}onPress(e,t,n){if(e.cooldown<=0){const i=t.targetPos,s=50;let o=null,r=-1;const a={pos:i,shape:{type:"circle",radius:s}},l=n.spatialHash.query(a);for(const e of l){const t=e;t.dead||Math.sqrt(Math.pow(i.x-t.pos.x,2)+Math.pow(i.y-t.pos.y,2))<s&&t.hp>r&&(r=t.hp,o=t)}if(o){n.spawnFloatingText(t.pos,"Swap!","purple",t.id),n.spawnProjectile(t.id,t.pos,0,0,0,"rinnegan_effect",0,99,30);const i={x:t.pos.x,y:t.pos.y};t.pos.x=o.pos.x,t.pos.y=o.pos.y,o.pos.x=i.x,o.pos.y=i.y,n.spawnProjectile(t.id,t.pos,0,0,0,"rinnegan_effect",0,99,30),e.activeTime=.5;const s=100*t.stats.damageMult;n.damageEnemy(o,s,t),e.cooldown=12*t.stats.cooldownMult}else n.spawnFloatingText(t.pos,"Need Target!","gray",t.id)}}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){}},ult:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i),e.activeTime>0&&(e.activeTime-=i,e.activeTime)}onPress(e,t,n){e.cooldown<=0&&(e.isCharging=!0,e.chargeTime=0)}onHold(e,t,n,i){e.isCharging&&(e.chargeTime+=i,e.chargeTime>2&&(e.chargeTime=2))}onRelease(e,t,n){if(e.isCharging){e.isCharging=!1;const i=t.targetPos,s=100+50*e.chargeTime,o=200+100*e.chargeTime;e.activeTime=.5,e.cooldown=40*t.stats.cooldownMult;const r={pos:i,shape:{type:"circle",radius:s}},a=n.spatialHash.query(r);for(const e of a){const r=e;r.dead||Math.sqrt(Math.pow(i.x-r.pos.x,2)+Math.pow(i.y-r.pos.y,2))<s&&(n.damageEnemy(r,o*t.stats.damageMult,t),r.stunTimer=2)}n.spawnFloatingText(i,"KIRIN!","cyan")}}draw(e,t,n,i){if(t.isCharging){const s=n.targetPos,o=100+50*t.chargeTime;e.save(),e.translate(s.x,s.y),e.strokeStyle=`rgba(0, 255, 255, ${.5+.2*Math.sin(10*i.gameTime)})`,e.lineWidth=3,e.beginPath(),e.arc(0,0,o,0,2*Math.PI),e.stroke(),e.fillStyle=`rgba(0, 255, 255, ${t.chargeTime/4})`,e.fill(),e.restore()}if(t.activeTime>0){const s=n.targetPos,o=Math.max(0,(.5-t.activeTime)/.2);e.save(),e.translate(s.x,s.y),t.activeTime>.4&&(e.fillStyle="rgba(255, 255, 255, 0.8)",e.fillRect(-1e3,-1e3,2e3,2e3));const r=-800,a=r+(0-r)*Math.min(o,1);e.save(),e.translate(0,a),e.shadowBlur=30,e.shadowColor="cyan",e.strokeStyle="cyan",e.fillStyle="#e0ffff",e.lineWidth=5,e.beginPath(),e.moveTo(0,0),e.lineTo(-20,-30),e.lineTo(-10,-50),e.lineTo(-30,-80),e.lineTo(-10,-60),e.lineTo(10,-60),e.lineTo(30,-80),e.lineTo(10,-50),e.lineTo(20,-30),e.lineTo(0,0),e.fill(),e.stroke(),e.fillStyle="red",e.beginPath(),e.arc(-10,-35,3,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(10,-35,3,0,2*Math.PI),e.fill(),e.strokeStyle="cyan",e.lineWidth=15,e.beginPath(),e.moveTo(0,-60);let l=0;for(let t=-60;t>-1e3;t-=40)l=50*Math.sin(.01*t+20*i.gameTime),e.lineTo(l,t);e.stroke(),e.strokeStyle="white",e.lineWidth=2,e.beginPath();for(let t=0;t<5;t++){const t=200*(Math.random()-.5),n=200*(Math.random()-.5)-100;e.moveTo(t,n),e.lineTo(t+50*(Math.random()-.5),n+50*(Math.random()-.5))}e.stroke(),e.restore(),o>=1&&(e.fillStyle="rgba(0, 255, 255, 0.5)",e.beginPath(),e.arc(0,0,t.activeTime/.3*150,0,2*Math.PI),e.fill()),e.restore()}}}},gaara:{skillQ:new class{update(e,t,n,i){if(e.cooldown>0&&(e.cooldown-=i),e.activeTime>0){e.activeTime-=i,t.invincible=!0;for(const e of n.enemies)if(Math.sqrt(Math.pow(t.pos.x-e.pos.x,2)+Math.pow(t.pos.y-e.pos.y,2))<100){const s=50*i*t.stats.damageMult;n.damageEnemy(e,s,t)}}else"gaara"===t.character&&t.ultActiveTime<=0&&(t.invincible=!1)}onPress(e,t,n){e.cooldown<=0&&(e.activeTime=3,e.cooldown=15*t.stats.cooldownMult)}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){t.activeTime>0&&(e.save(),e.translate(n.pos.x,n.pos.y),e.beginPath(),e.arc(0,0,60,0,2*Math.PI),e.fillStyle="rgba(194, 178, 128, 0.5)",e.fill(),e.strokeStyle="rgba(194, 178, 128, 1)",e.lineWidth=3,e.stroke(),e.restore())}},skillE:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i)}onPress(t,n,i){t.cooldown<=0&&(i.hazards.push({id:i.nextEntityId++,pos:new e.Vec2(n.pos.x,n.pos.y),radius:200,duration:5,damage:20*n.stats.damageMult,type:"quicksand",ownerId:n.id,shape:{type:"circle",radius:200},tickTimer:0}),t.cooldown=8*n.stats.cooldownMult)}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){}},ult:new class{update(e,t,n,i){if(e.cooldown>0&&(e.cooldown-=i),e.activeTime>0){e.activeTime-=i,t.ultActiveTime=e.activeTime;for(const e of n.enemies)e.rooted=!0;if(e.activeTime<=0)for(const e of n.enemies){e.rooted=!1;const i=500*t.stats.damageMult;n.damageEnemy(e,i,t)}}}onPress(e,t,n){e.cooldown<=0&&(e.activeTime=2,e.cooldown=60*t.stats.cooldownMult,t.ultActiveTime=2)}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){if(t.activeTime>0){e.save(),e.fillStyle="rgba(194, 178, 128, 0.3)",e.fillRect(n.pos.x-1e3,n.pos.y-1e3,2e3,2e3);for(const t of i.enemies)e.save(),e.translate(t.pos.x,t.pos.y),e.beginPath(),e.moveTo(0,-30),e.lineTo(20,10),e.lineTo(-20,10),e.closePath(),e.fillStyle="rgba(194, 178, 128, 0.8)",e.fill(),e.restore();e.restore()}}}},sakura:{skillQ:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i)}onPress(e,t,n){if(e.cooldown<=0){const i=50;t.hp=Math.min(t.hp+i,t.maxHp),n.spawnFloatingText(t.pos,"+"+i,"green",t.id);for(let e in n.players){const s=n.players[e];s.id!==t.id&&(s.dead||Math.sqrt(Math.pow(t.pos.x-s.pos.x,2)+Math.pow(t.pos.y-s.pos.y,2))<300&&(s.hp=Math.min(s.hp+i,s.maxHp),n.spawnFloatingText(s.pos,"+"+i,"green",s.id)))}e.cooldown=15*t.stats.cooldownMult}}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){}},skillE:new class{update(e,t,n,i){e.cooldown>0&&(e.cooldown-=i),e.activeTime>0&&(e.activeTime-=i)}onPress(t,n,i){if(t.cooldown<=0){t.activeTime=5,t.cooldown=12*n.stats.cooldownMult,i.spawnFloatingText(n.pos,"Scalpel!","pink",n.id);const s=600,o=200;n.dashTime=o/s,n.dashHitList=[],n.dashVec=new e.Vec2(Math.cos(n.aimAngle)*s,Math.sin(n.aimAngle)*s),n.invincible=!0}}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){t.activeTime>0&&(e.save(),e.translate(n.pos.x,n.pos.y),e.beginPath(),e.arc(0,0,25,0,2*Math.PI),e.strokeStyle="cyan",e.lineWidth=2,e.stroke(),e.restore())}},ult:new class{update(e,t,n,i){if(e.cooldown>0&&(e.cooldown-=i),e.activeTime>0){e.activeTime-=i,t.ultActiveTime=e.activeTime;const s=10/60,o=e.activeTime+i;if(Math.floor(o/s)!==Math.floor(e.activeTime/s)){const e=20*s;for(let i in n.players){const s=n.players[i];s.dead||Math.sqrt(Math.pow(t.pos.x-s.pos.x,2)+Math.pow(t.pos.y-s.pos.y,2))<300&&(s.hp=Math.min(s.hp+e,s.maxHp),n.spawnFloatingText(s.pos,"+"+Math.ceil(e),"green",s.id))}for(const e of n.enemies)if(Math.sqrt(Math.pow(t.pos.x-e.pos.x,2)+Math.pow(t.pos.y-e.pos.y,2))<300){const i=20*s*t.stats.damageMult;n.damageEnemy(e,i,t),e.speedMult=.5}}}}onPress(e,t,n){e.cooldown<=0&&(e.activeTime=8,e.cooldown=60*t.stats.cooldownMult,t.ultActiveTime=8)}onHold(e,t,n,i){}onRelease(e,t,n){}draw(e,t,n,i){t.activeTime>0&&(e.save(),e.translate(n.pos.x,n.pos.y),e.beginPath(),e.arc(0,0,300,0,2*Math.PI),e.fillStyle="rgba(0, 255, 0, 0.1)",e.fill(),e.strokeStyle="rgba(0, 255, 0, 0.3)",e.lineWidth=2,e.stroke(),e.fillStyle="white",e.beginPath(),e.ellipse(0,0,60,40,0,0,2*Math.PI),e.fill(),e.fillStyle="blue",e.beginPath(),e.ellipse(0,-10,40,20,0,0,2*Math.PI),e.fill(),e.restore())}}}},o={naruto:new i,sasuke:new class{fire(e,t){let n=null,i=1/0;for(const s of t.enemies){const t=Math.sqrt(Math.pow(e.pos.x-s.pos.x,2)+Math.pow(e.pos.y-s.pos.y,2));t<i&&(i=t,n=s)}const s=n?Math.atan2(n.pos.y-e.pos.y,n.pos.x-e.pos.x):1===e.direction?0:Math.PI;let o=10*e.stats.damageMult;t.random()<e.stats.critChance&&(o*=2);const r=e.weaponLevel;if(r>=5){const n=4*o,i=800;t.spawnProjectile(e.id,e.pos,s,i,n,"chidori_spear",4+e.stats.knockback,999,30)}else{let n="rotating_slash";r>=3?n="sword_slash_chidori":r>=2&&(n="rotating_slash_lightning");const i=r>=4?2.5*o:r>=2?1.5*o:o,a=r>=4?150:r>=2?100:80;t.spawnProjectile(e.id,e.pos,s,0,i,n,5+e.stats.knockback,99,a);const l=t.projectiles[t.projectiles.length-1];l&&(l.life=.3)}}},gaara:new i,sakura:new i};function r(e,t){if(!e)return null;const n=s[e];return n&&n[t]||null}class a{constructor(e){this.cellSize=e,this.buckets=new Map}clear(){this.buckets.clear()}add(e){const t=this.getBounds(e),n=Math.floor(t.minX/this.cellSize),i=Math.floor(t.minY/this.cellSize),s=Math.floor(t.maxX/this.cellSize),o=Math.floor(t.maxY/this.cellSize);for(let t=n;t<=s;t++)for(let n=i;n<=o;n++){const i=`${t},${n}`;this.buckets.has(i)||this.buckets.set(i,[]),this.buckets.get(i).push(e)}}query(e){const t=this.getBounds(e),n=Math.floor(t.minX/this.cellSize),i=Math.floor(t.minY/this.cellSize),s=Math.floor(t.maxX/this.cellSize),o=Math.floor(t.maxY/this.cellSize),r=new Set,a=[];for(let e=n;e<=s;e++)for(let t=i;t<=o;t++){const n=`${e},${t}`,i=this.buckets.get(n);if(i)for(const e of i)r.has(e.id)||(r.add(e.id),a.push(e))}return a}getBounds(e){let t=e.pos.x,n=e.pos.y,i=e.pos.x,s=e.pos.y;if("circle"===e.shape.type){const o=e.shape.radius;t-=o,n-=o,i+=o,s+=o}else if("capsule"===e.shape.type){const o=e.shape.radius,r=e.pos.x+e.shape.startOffset.x,a=e.pos.y+e.shape.startOffset.y,l=e.pos.x+e.shape.endOffset.x,c=e.pos.y+e.shape.endOffset.y;t=Math.min(r,l)-o,n=Math.min(a,c)-o,i=Math.max(r,l)+o,s=Math.max(a,c)+o}else"aabb"===e.shape.type&&(t-=e.shape.width/2,n-=e.shape.height/2,i+=e.shape.width/2,s+=e.shape.height/2);return{minX:t,minY:n,maxX:i,maxY:s}}checkCollision(t,n){if("circle"===t.shape.type&&"circle"===n.shape.type){const e=Math.pow(t.pos.x-n.pos.x,2)+Math.pow(t.pos.y-n.pos.y,2),i=t.shape.radius+n.shape.radius;return e<i*i}if("circle"===t.shape.type&&"capsule"===n.shape.type){const i=new e.Vec2(n.pos.x+n.shape.startOffset.x,n.pos.y+n.shape.startOffset.y),s=new e.Vec2(n.pos.x+n.shape.endOffset.x,n.pos.y+n.shape.endOffset.y),o=function(e,t,n){const i=Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2);if(0===i)return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2);let s=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return s=Math.max(0,Math.min(1,s)),Math.pow(e.x-(t.x+s*(n.x-t.x)),2)+Math.pow(e.y-(t.y+s*(n.y-t.y)),2)}(t.pos,i,s),r=t.shape.radius+n.shape.radius;return o<r*r}return"capsule"===t.shape.type&&"circle"===n.shape.type&&this.checkCollision(n,t)}}class l{static spawn(t,n,i,s,o,r,a){if(void 0!==r&&a){const e=t.find(e=>e.targetId===r);if(e&&Math.sqrt(Math.pow(e.pos.x-a.x,2)+Math.pow(e.pos.y-a.y,2))<=100){const t=parseInt(s);if(!isNaN(t))return e.accumulatedValue=(e.accumulatedValue||parseInt(e.text))+t,e.text=e.accumulatedValue.toString()+(s.includes("!")?"!":""),e.life=1,e.color=o,e.pos.x=a.x,e.pos.y=a.y-20,e.vel.y=-20,n}}return t.push({id:n,pos:new e.Vec2(i.x,i.y-20),vel:new e.Vec2(0,-20),text:s,color:o,life:1,maxLife:1,size:20,targetId:r,accumulatedValue:parseInt(s)||void 0}),n+1}static update(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];i.life-=t,i.pos.x+=i.vel.x*t,i.pos.y+=i.vel.y*t,i.life<=0&&e.splice(n,1)}}static draw(e,t){for(const n of t)e.save(),e.globalAlpha=Math.max(0,n.life/.5),e.fillStyle=n.color,e.font=`bold ${n.size}px 'Bangers', sans-serif`,e.textAlign="center",e.shadowColor="black",e.shadowBlur=2,e.fillText(n.text,n.pos.x,n.pos.y),e.restore()}}class c extends e.Game{random(){return this.rngSeed=(1664525*this.rngSeed+1013904223)%4294967296,this.rngSeed/4294967296}getPlayerColor(e){const t=["#00d2ff","#ff4444","#ffd700","#00ff88"];return t[e%t.length]}constructor(n,i){super(),this.players={},this.enemies=[],this.projectiles=[],this.xpOrbs=[],this.particles=[],this.hazards=[],this.spatialHash=new a(200),this.floatingTexts=[],this.gamePhase="charSelect",this.teamXP=0,this.teamLevel=1,this.xpToNextLevel=300,this.gameTime=0,this.spawnTimer=0,this.nextEntityId=0,this.rngSeed=12345,this.netplayPlayers=i,function(){const e=new Image;e.src="./grass.png",t.grass=e;const n=(e,t,n)=>{const i=document.createElement("canvas");return i.width=e,i.height=t,n(i.getContext("2d"),e/2,t/2),i};t.tree=n(120,160,(e,t,n)=>{e.fillStyle="#3e2723",e.fillRect(t-15,n,30,80),e.fillStyle="#1b5e20",e.beginPath(),e.moveTo(t-50,n+20),e.lineTo(t,n-60),e.lineTo(t+50,n+20),e.fill(),e.beginPath(),e.moveTo(t-45,n-20),e.lineTo(t,n-90),e.lineTo(t+45,n-20),e.fill(),e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(t,n+75,40,15,0,0,2*Math.PI),e.fill()}),t.naruto=n(64,64,(e,t,n)=>{e.fillStyle="#ff6b00",e.beginPath(),e.arc(t,n+10,15,0,2*Math.PI),e.fill(),e.fillStyle="#f1c40f",function(e,t,n){e.fillStyle="#f1c40f",e.beginPath();for(let i=0;i<8;i++){const s=i/8*Math.PI*2,o=t+18*Math.cos(s),r=n+18*Math.sin(s);e.lineTo(o,r);const a=s+Math.PI/8,l=t+9*Math.cos(a),c=n+9*Math.sin(a);e.lineTo(l,c)}e.closePath(),e.fill()}(e,t,n-5),e.fillStyle="#ffccaa",e.beginPath(),e.arc(t,n,12,0,2*Math.PI),e.fill(),e.fillStyle="#333",e.fillRect(t-10,n-8,20,6),e.fillStyle="#ccc",e.fillRect(t-4,n-7,8,4)}),t.sasuke=n(64,64,(e,t,n)=>{e.fillStyle="#ccc",e.beginPath(),e.moveTo(t-12,n+5),e.lineTo(t+12,n+5),e.lineTo(t+15,n-8),e.lineTo(t-15,n-8),e.fill(),e.beginPath(),e.arc(t,n+10,14,0,2*Math.PI),e.fill(),e.fillStyle="#ffe0bd",e.beginPath(),e.moveTo(t,n+5),e.lineTo(t-4,n+15),e.lineTo(t+4,n+15),e.fill(),e.strokeStyle="#800080",e.lineWidth=4,e.beginPath(),e.moveTo(t-14,n+15),e.lineTo(t+14,n+15),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(t+8,n+15),e.lineTo(t+10,n+22),e.stroke(),e.fillStyle="#ffe0bd",e.beginPath(),e.arc(t,n,11,0,2*Math.PI),e.fill(),e.fillStyle="#1a1a2e",e.beginPath(),e.moveTo(t-12,n-5),e.lineTo(t-18,n-15),e.lineTo(t-8,n-12),e.lineTo(t,n-18),e.lineTo(t+8,n-12),e.lineTo(t+18,n-15),e.lineTo(t+12,n-5),e.fill(),e.beginPath(),e.arc(t,n-2,12,0,Math.PI,!0),e.fill(),e.fillStyle="red",e.beginPath(),e.arc(t+3,n+2,1.5,0,2*Math.PI),e.fill(),e.strokeStyle="#333",e.lineWidth=3,e.beginPath(),e.moveTo(t+8,n-5),e.lineTo(t+12,n-15),e.stroke()}),t.gaara=n(80,80,(e,t,n)=>{e.fillStyle="#d35400",e.beginPath(),e.ellipse(t+10,n-5,12,18,.2,0,2*Math.PI),e.fill(),e.fillStyle="#8e44ad",e.beginPath(),e.arc(t,n+10,15,0,2*Math.PI),e.fill(),e.fillStyle="#c0392b",e.beginPath(),e.arc(t,n,13,0,2*Math.PI),e.fill(),e.fillStyle="#ffe0bd",e.beginPath(),e.arc(t,n+2,11,0,2*Math.PI),e.fill(),e.strokeStyle="#000",e.lineWidth=2,e.beginPath(),e.moveTo(t-5,n+2),e.lineTo(t-2,n+2),e.stroke()}),t.sakura=n(64,64,(e,t,n)=>{e.fillStyle="#e74c3c",e.beginPath(),e.arc(t,n+10,14,0,2*Math.PI),e.fill(),e.fillStyle="#fd79a8",e.beginPath(),e.arc(t,n,14,0,2*Math.PI),e.fill(),e.fillStyle="#ffe0bd",e.beginPath(),e.arc(t,n+3,11,0,2*Math.PI),e.fill(),e.fillStyle="#e74c3c",e.fillRect(t-10,n-8,20,5)}),t.zetsu=n(64,64,(e,t,n)=>{e.fillStyle="#2ecc71",e.beginPath(),e.ellipse(t,n,16,20,0,0,2*Math.PI),e.fill(),e.fillStyle="#eee",e.beginPath(),e.arc(t-5,n,10,0,2*Math.PI),e.fill(),e.fillStyle="#111",e.beginPath(),e.arc(t+5,n,10,0,2*Math.PI),e.fill(),e.fillStyle="yellow",e.beginPath(),e.arc(t-2,n-2,2,0,2*Math.PI),e.fill()}),t.puppet=n(80,80,(e,t,n)=>{e.fillStyle="#5d4037",e.beginPath(),e.arc(t,n,22,0,2*Math.PI),e.fill(),e.fillStyle="#d7ccc8",e.beginPath(),e.arc(t,n+2,15,0,2*Math.PI),e.fill(),e.strokeStyle="#5d4037",e.lineWidth=2,e.beginPath(),e.moveTo(t-10,n+8),e.lineTo(t+10,n+8),e.stroke()}),t.sound_ninja=n(64,64,(e,t,n)=>{e.fillStyle="#999",e.beginPath(),e.arc(t,n,18,0,2*Math.PI),e.fill(),e.fillStyle="#333",e.beginPath(),e.arc(t,n-5,15,0,2*Math.PI),e.fill(),e.strokeStyle="#eee",e.lineWidth=3,e.beginPath(),e.moveTo(t-15,n+10),e.lineTo(t-25,n+20),e.stroke(),e.beginPath(),e.moveTo(t+15,n+10),e.lineTo(t+25,n+20),e.stroke()}),t.snake=n(128,128,(e,t,n)=>{e.fillStyle="#5e35b1",e.beginPath(),e.ellipse(t,n,30,50,0,0,2*Math.PI),e.fill(),e.fillStyle="#yellow",e.beginPath(),e.arc(t-10,n-30,5,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(t+10,n-30,5,0,2*Math.PI),e.fill()}),t.shuriken=n(32,32,(e,t,n)=>{e.translate(t,n),e.fillStyle="#ccc";for(let t=0;t<4;t++)e.rotate(Math.PI/2),e.beginPath(),e.moveTo(0,-10),e.lineTo(3,-2),e.lineTo(10,0),e.lineTo(3,2),e.fill();e.fillStyle="#eee",e.beginPath(),e.arc(0,0,3,0,2*Math.PI),e.fill()}),t.rasengan=n(100,100,(e,t,n)=>{const i=e.createRadialGradient(t,n,10,t,n,40);i.addColorStop(0,"white"),i.addColorStop(.5,"#00d2ff"),i.addColorStop(1,"rgba(0, 210, 255, 0)"),e.fillStyle=i,e.beginPath(),e.arc(t,n,40,0,2*Math.PI),e.fill(),e.strokeStyle="white",e.lineWidth=2,e.beginPath(),e.arc(t,n,30,0,2*Math.PI),e.stroke(),e.strokeStyle="#00d2ff";for(let i=0;i<3;i++)e.beginPath(),e.arc(t,n,20+5*i,i,i+Math.PI),e.stroke()}),t.rasenshuriken=n(128,128,(e,t,n)=>{e.translate(t,n),e.fillStyle="rgba(200, 240, 255, 0.7)";for(let t=0;t<3;t++)e.rotate(2*Math.PI/3),e.beginPath(),e.ellipse(40,0,50,15,0,0,2*Math.PI),e.fill();e.fillStyle="#00d2ff",e.beginPath(),e.arc(0,0,20,0,2*Math.PI),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(0,0,10,0,2*Math.PI),e.fill()}),t.sword_slash=n(100,60,(e,t,n)=>{e.fillStyle="rgba(200, 220, 255, 0.8)",e.beginPath(),e.arc(t-20,n,45,-Math.PI/3,Math.PI/3),e.lineTo(t-30,n),e.fill(),e.strokeStyle="#00d2ff",e.lineWidth=2,e.stroke()}),t.sand_hand=n(120,160,(e,t,n)=>{e.fillStyle="#d35400",e.strokeStyle="#a04000",e.lineWidth=3,e.beginPath(),e.arc(t,n+30,40,0,2*Math.PI),e.fill(),e.stroke();for(let i=-2;i<=2;i++){const s=.2*i-Math.PI/2,o=t+60*Math.cos(s),r=n+60*Math.sin(s);e.beginPath(),e.moveTo(t+30*Math.cos(s),n+30*Math.sin(s)+30),e.lineTo(o,r),e.lineWidth=15,e.lineCap="round",e.stroke(),e.beginPath(),e.arc(o,r,8,0,2*Math.PI),e.fill()}}),t.tailed_beast_bomb=n(64,64,(e,t,n)=>{const i=e.createRadialGradient(t,n,5,t,n,30);i.addColorStop(0,"black"),i.addColorStop(.5,"#4b0082"),i.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=i,e.beginPath(),e.arc(t,n,25,0,2*Math.PI),e.fill(),e.fillStyle="white",e.beginPath(),e.arc(t-5,n-5,2,0,2*Math.PI),e.fill()}),t.rock_wave=n(80,40,(e,t,n)=>{e.fillStyle="#654321",e.beginPath(),e.rect(t-40,n-15,80,30),e.fill(),e.fillStyle="#8b4513",e.beginPath(),e.moveTo(t-30,n-15),e.lineTo(t-20,n-35),e.lineTo(t-10,n-15),e.moveTo(t,n-15),e.lineTo(t+10,n-40),e.lineTo(t+20,n-15),e.fill()}),t.cracks=n(100,100,(e,t,n)=>{e.strokeStyle="#3e2723",e.lineWidth=3,e.beginPath();for(let i=0;i<5;i++){const s=i/5*Math.PI*2;e.moveTo(t,n),e.lineTo(t+40*Math.cos(s),n+40*Math.sin(s)),e.lineTo(t+50*Math.cos(s+.2),n+50*Math.sin(s+.2))}e.stroke()}),t.susanoo=n(300,300,(e,t,n)=>{e.strokeStyle="#8A2BE2",e.lineWidth=8,e.lineCap="round",e.shadowBlur=20,e.shadowColor="#8A2BE2";for(let i=0;i<3;i++)e.beginPath(),e.arc(t,n+20,40+30*i,Math.PI,0),e.stroke();e.beginPath(),e.arc(t,n-80,40,0,2*Math.PI),e.stroke()}),t.kurama=n(300,300,(e,t,n)=>{e.fillStyle="rgba(255, 140, 0, 0.4)",e.shadowBlur=30,e.shadowColor="orange",e.beginPath(),e.moveTo(t,n+50),e.lineTo(t-80,n-60),e.lineTo(t-100,n-120),e.lineTo(t-40,n-80),e.lineTo(t,n-40),e.lineTo(t+40,n-80),e.lineTo(t+100,n-120),e.lineTo(t+80,n-60),e.lineTo(t,n+50),e.fill(),e.fillStyle="white",e.beginPath(),e.ellipse(t-30,n-30,10,20,.5,0,2*Math.PI),e.fill(),e.beginPath(),e.ellipse(t+30,n-30,10,20,-.5,0,2*Math.PI),e.fill()}),t.slug=n(200,200,(e,t,n)=>{e.fillStyle="#81ecec",e.strokeStyle="#00cec9",e.lineWidth=5,e.beginPath(),e.ellipse(t,n,60,80,0,0,2*Math.PI),e.fill(),e.stroke(),e.beginPath(),e.arc(t,n-60,40,0,2*Math.PI),e.fill(),e.stroke(),e.fillStyle="#0984e3",e.beginPath(),e.arc(t,n-70,5,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(t-20,n,10,0,2*Math.PI),e.fill()}),t.rinnegan_effect=n(50,50,(e,t,n)=>{e.strokeStyle="#8A2BE2",e.lineWidth=3;for(let i=1;i<=4;i++)e.beginPath(),e.arc(t,n,5*i,0,2*Math.PI),e.stroke();e.fillStyle="rgba(138, 43, 226, 0.5)",e.beginPath(),e.arc(t,n,20,0,2*Math.PI),e.fill()}),t.fire_trail=n(64,64,(e,t,n)=>{e.fillStyle="rgba(255, 69, 0, 0.6)",e.beginPath(),e.arc(t,n,20,0,2*Math.PI),e.fill(),e.fillStyle="rgba(255, 140, 0, 0.8)",e.beginPath(),e.arc(t,n,12,0,2*Math.PI),e.fill()})}(),document.addEventListener("keydown",e=>{"Backquote"===e.code&&(c.debugMode=!c.debugMode,console.log("Debug mode:",c.debugMode?"ON":"OFF"))});for(const e of i)if(e.isLocal){c.localPlayerId=e.id;break}for(let t of i)this.players[t.id]={id:t.id,name:`Player ${t.id+1}`,pos:new e.Vec2(0,0),hp:100,maxHp:100,character:null,skills:{skillQ:{cooldown:0,chargeTime:0,isCharging:!1,activeTime:0},skillE:{cooldown:0,chargeTime:0,isCharging:!1,activeTime:0},ult:{cooldown:0,chargeTime:0,isCharging:!1,activeTime:0}},weaponLevel:1,isEvolved:!1,stats:{damageMult:1,areaMult:1,cooldownMult:1,critChance:.05,knockback:1,piercing:0},elements:{Fire:!1,Water:!1,Earth:!1,Wind:!1,Lightning:!1},ready:!1,offeredUpgrades:[],selectedUpgrade:null,dead:!1,direction:1,aimAngle:0,targetPos:new e.Vec2(0,0),flash:0,fireTimer:0,burstTimer:0,burstCount:0,shield:0,maxShield:50,healCharge:0,skillChargeTime:0,skillCharging:!1,ultActiveTime:0,dashTime:0,dashVec:new e.Vec2(0,0),dashHitList:[],charState:null,invincible:!1,rooted:!1,shape:{type:"circle",radius:20}}}tick(e){"charSelect"===this.gamePhase?this.tickCharSelect(e):"playing"===this.gamePhase?this.tickPlaying(e):"levelUp"===this.gamePhase?this.tickLevelUp(e):this.gamePhase}tickCharSelect(e){let t=!0;for(const[n,i]of e.entries()){const e=n.id,s=this.players[e];i.keysPressed[1]&&(s.character="naruto"),i.keysPressed[2]&&(s.character="sasuke"),i.keysPressed[3]&&(s.character="gaara"),i.keysPressed[4]&&(s.character="sakura"),i.keysPressed[" "]&&s.character&&(s.ready=!0),s.ready||(t=!1)}t&&Object.keys(this.players).length>0&&(this.gamePhase="playing",this.initializeGame())}initializeGame(){let t=0;for(let n in this.players){const i=this.players[n];i.pos=new e.Vec2(100*t-200,0),"naruto"===i.character?(i.maxHp=150,i.hp=150,i.charState={regenTimer:0}):"sasuke"===i.character?(i.maxHp=80,i.hp=80,i.charState={dodgeBuffTimer:0,sharinganCooldown:0}):"gaara"===i.character?(i.maxHp=150,i.hp=150,i.charState={shieldHp:50,shieldRegenTimer:0}):"sakura"===i.character&&(i.maxHp=100,i.hp=100,i.charState={meter:0}),t++}}tickPlaying(t){const n=c.timestep/1e3;this.gameTime+=n,this.spatialHash=new a(200);for(const e of this.enemies)this.spatialHash.add(e);for(const[i,s]of t.entries()){const t=i.id,o=this.players[t];if(o.dead)continue;if(this.updateCharacterPassives(o,n),o.rooted);else if(o.dashTime>0){o.pos.x+=o.dashVec.x*n,o.pos.y+=o.dashVec.y*n,o.dashTime-=n;const t=this.spatialHash.query(o);for(const e of t){const t=e;if(!o.dashHitList.includes(t.id)&&this.spatialHash.checkCollision(o,t)){o.dashHitList.push(t.id);const e=50*o.stats.damageMult;this.damageEnemy(t,e,o)}}if(o.dashTime<=0)if(o.dashTime=0,"naruto"===o.character){this.particles.push({id:this.nextEntityId++,type:"crater",pos:new e.Vec2(o.pos.x,o.pos.y),vel:new e.Vec2(0,0),life:2,maxLife:2,color:"",size:1});for(const e of this.enemies)if(Math.sqrt(Math.pow(o.pos.x-e.pos.x,2)+Math.pow(o.pos.y-e.pos.y,2))<150){const t=50*o.stats.damageMult;this.damageEnemy(e,t,o);const n=Math.atan2(e.pos.y-o.pos.y,e.pos.x-o.pos.x);e.push.x+=650*Math.cos(n),e.push.y+=650*Math.sin(n)}}else{const e=this.spatialHash.query(o);for(const t of e){const e=t;this.spatialHash.checkCollision(o,e)&&Math.sqrt(Math.pow(o.pos.x-e.pos.x,2)+Math.pow(o.pos.y-e.pos.y,2))<150&&this.damageEnemy(e,50*o.stats.damageMult,o)}}}else{let e=120;o.skillCharging&&(e=0),"naruto"===o.character&&o.ultActiveTime>0&&(e=0);let t=0,i=0;if(s.keysHeld.a&&(t-=1),s.keysHeld.d&&(t+=1),s.keysHeld.w&&(i-=1),s.keysHeld.s&&(i+=1),0!==t||0!==i){const s=Math.sqrt(t*t+i*i);o.pos.x+=t/s*e*n,o.pos.y+=i/s*e*n,0!==t&&(o.direction=Math.sign(t))}}const a=700;if(o.pos.x<20-a&&(o.pos.x=20-a),o.pos.x>a-20&&(o.pos.x=a-20),s.mousePosition){const e=s.mousePosition.x-c.canvasSize.width/2,t=s.mousePosition.y-c.canvasSize.height/2;o.aimAngle=Math.atan2(t,e),o.targetPos.x=o.pos.x+e,o.targetPos.y=o.pos.y+t}for(let e in o.skills){const t=o.skills[e];t.cooldown>0&&(t.cooldown-=n)}const l=r(o.character||"","skillQ"),h=r(o.character||"","skillE"),d=r(o.character||"","ult");l&&l.update(o.skills.skillQ,o,this,n),h&&h.update(o.skills.skillE,o,this,n),d&&d.update(o.skills.ult,o,this,n),s.keysHeld.q&&l&&l.onHold(o.skills.skillQ,o,this,n),s.keysPressed.q&&l&&l.onPress(o.skills.skillQ,o,this),!s.keysHeld.q&&o.skills.skillQ.isCharging&&l&&l.onRelease(o.skills.skillQ,o,this),s.keysHeld.e&&h&&h.onHold(o.skills.skillE,o,this,n),s.keysPressed.e&&h&&h.onPress(o.skills.skillE,o,this),!s.keysHeld.e&&o.skills.skillE.isCharging&&h&&h.onRelease(o.skills.skillE,o,this),s.keysPressed.r&&d&&d.onPress(o.skills.ult,o,this),!s.keysHeld.r&&o.skills.ult.isCharging&&d&&d.onRelease(o.skills.ult,o,this),o.fireTimer+=n;const u=("sasuke"===o.character?1:1.5)*o.stats.cooldownMult;o.fireTimer>=u&&(this.fireWeapon(o),o.fireTimer=0,"naruto"===o.character&&o.weaponLevel>=2&&!o.isEvolved&&(o.burstTimer=.1,o.burstCount=1)),o.burstCount>0&&(o.burstTimer-=n,o.burstTimer<=0&&(this.fireWeapon(o),o.burstCount--,o.burstCount>0&&(o.burstTimer=.1)))}for(let e=this.hazards.length-1;e>=0;e--){const t=this.hazards[e];if(t.duration-=n,t.duration<=0){this.hazards.splice(e,1);continue}t.tickTimer+=n;const i=1/60*10;if(t.tickTimer>=i){t.tickTimer=0;const e=this.spatialHash.query(t);for(const n of e){const e=n;if(this.spatialHash.checkCollision(t,e)){"quicksand"===t.type&&(e.speedMult*=.5);const n=t.damage*i;e.hp-=n,this.random()<.1&&this.spawnFloatingText(e.pos,Math.ceil(n).toString(),"white",e.id)}}}}this.spawnTimer+=n;let i=1,s=1;this.gameTime<60?(i=1,s=1):this.gameTime<120?(i=.8,s=2):(i=.4,s=3),this.spawnTimer>i&&this.enemies.length<50&&(this.spawnEnemy(),s>=2&&this.random()<.4&&this.spawnEnemy(),s>=3&&this.random()<.6&&this.spawnEnemy(),this.spawnTimer=0);for(const e of this.enemies){let t=null,i=1/0;for(let n in this.players){const s=this.players[n];if(s.dead)continue;const o=Math.sqrt(Math.pow(s.pos.x-e.pos.x,2)+Math.pow(s.pos.y-e.pos.y,2));o<i&&(i=o,t=s)}if(t){const i=Math.atan2(t.pos.y-e.pos.y,t.pos.x-e.pos.x);e.rooted&&(e.speedMult=0);const s=50*e.speedMult;if(e.pos.x+=(Math.cos(i)*s+e.push.x)*n,e.pos.y+=(Math.sin(i)*s+e.push.y)*n,e.push.x*=.95,e.push.y*=.95,e.bleedStacks>0&&(e.dotTimer-=n,e.dotTimer<=0)){e.dotTimer=1;const t=5*e.bleedStacks;e.hp-=t,this.spawnFloatingText(e.pos,t.toString(),"red",e.id)}if(t&&Math.sqrt(Math.pow(t.pos.x-e.pos.x,2)+Math.pow(t.pos.y-e.pos.y,2))<30){const i=10*n*e.damageDebuff;this.damagePlayer(t,i)}}e.speedMult=1}for(let e=this.enemies.length-1;e>=0;e--)this.enemies[e].dead&&this.enemies.splice(e,1);for(let t=this.projectiles.length-1;t>=0;t--){const i=this.projectiles[t];if(i.life-=n,i.life<=0){this.projectiles.splice(t,1);continue}if("rotating_slash"===i.type||"rotating_slash_lightning"===i.type||"sword_slash_chidori"===i.type){const e=this.players[i.ownerId];if(e){const t=1.6,n=-t/2+t*(1-i.life/.3),s=void 0!==i.targetAngle?i.targetAngle:e.aimAngle;i.angle=s+n,i.pos.x=e.pos.x+Math.cos(i.angle),i.pos.y=e.pos.y+Math.sin(i.angle)}}else if("fireball"===i.type)if(i.size+=20*n,void 0===i.trailId){const t={id:this.nextEntityId++,pos:new e.Vec2(i.pos.x,i.pos.y),radius:.8*i.size,duration:2,damage:5,type:"fire",ownerId:i.ownerId,shape:{type:"capsule",radius:.8*i.size,startOffset:new e.Vec2(0,0),endOffset:new e.Vec2(0,0)},tickTimer:0};this.hazards.push(t),i.trailId=t.id}else{const e=this.hazards.find(e=>e.id===i.trailId);e&&"capsule"===e.shape.type&&(e.shape.endOffset.x=i.pos.x-e.pos.x,e.shape.endOffset.y=i.pos.y-e.pos.y,e.shape.radius=.8*i.size,e.duration=2)}i.pos.x+=i.vel.x*n,i.pos.y+=i.vel.y*n;const s=this.spatialHash.query(i);for(const n of s){const s=n;if(i.hitList.includes(s.id))continue;let o=!1;if("rotating_slash"===i.type||"rotating_slash_lightning"===i.type||"sword_slash_chidori"===i.type){const e=this.players[i.ownerId];if(e&&Math.sqrt(Math.pow(s.pos.x-e.pos.x,2)+Math.pow(s.pos.y-e.pos.y,2))<i.size){let t=Math.atan2(s.pos.y-e.pos.y,s.pos.x-e.pos.x)-i.angle;for(;t>Math.PI;)t-=2*Math.PI;for(;t<-Math.PI;)t+=2*Math.PI;Math.abs(t)<.8&&(o=!0)}}else o=this.spatialHash.checkCollision(i,s);if(o){const n=this.players[i.ownerId];if(n?(this.damageEnemy(s,i.dmg,n),"sword_slash_chidori"===i.type&&this.chainLightning(n,s.pos,.5*i.dmg,3,300,[s.id])):s.hp-=i.dmg,i.hitList.push(s.id),!(i.pierce>0)){this.projectiles.splice(t,1);break}i.pierce--,s.hp<=0&&(s.dead=!0,this.xpOrbs.push({id:this.nextEntityId++,pos:new e.Vec2(s.pos.x,s.pos.y),val:10,dead:!1}))}}}for(let e in this.players){const t=this.players[e];if(!t.dead)for(let e=this.xpOrbs.length-1;e>=0;e--){const i=this.xpOrbs[e],s=Math.sqrt(Math.pow(t.pos.x-i.pos.x,2)+Math.pow(t.pos.y-i.pos.y,2));if(s<50){const o=Math.atan2(t.pos.y-i.pos.y,t.pos.x-i.pos.x);if(i.pos.x+=300*Math.cos(o)*n,i.pos.y+=300*Math.sin(o)*n,s<20&&(this.teamXP+=i.val,this.xpOrbs.splice(e,1),this.teamXP>=this.xpToNextLevel)){this.teamXP=0,this.teamLevel++,this.xpToNextLevel*=1.2,this.gamePhase="levelUp";for(let e in this.players)this.players[e].selectedUpgrade=null,this.players[e].offeredUpgrades=this.generateUpgrades(this.players[e])}}}}for(let e=this.particles.length-1;e>=0;e--){const t=this.particles[e];t.life-=n,t.life<=0?this.particles.splice(e,1):(t.pos.x+=t.vel.x*n,t.pos.y+=t.vel.y*n)}l.update(this.floatingTexts,n)}damagePlayer(e,t){if(!e.invincible&&!e.dead){if("sasuke"===e.character&&e.charState&&"sharinganCooldown"in e.charState&&e.charState.sharinganCooldown<=0&&this.random()<.15)return e.charState.sharinganCooldown=5,this.spawnFloatingText(e.pos,"Dodge!","cyan",e.id),void("dodgeBuffTimer"in e.charState&&(e.charState.dodgeBuffTimer=2));if("gaara"===e.character&&e.charState&&"shieldHp"in e.charState){const n=e.charState.shieldHp;if(n>0){const i=Math.min(n,t);if(e.charState.shieldHp-=i,t-=i,e.charState.shieldRegenTimer=0,t<=0)return}else e.charState.shieldRegenTimer=0}"sakura"===e.character&&e.charState&&"meter"in e.charState&&(e.charState.meter=Math.min(e.charState.meter+10,100)),e.hp-=t,e.flash=.1}}damageEnemy(t,n,i){if(t.dead)return;let s=n,o=!1,r=i.stats.critChance;"sasuke"===i.character&&i.charState&&"dodgeBuffTimer"in i.charState&&i.charState.dodgeBuffTimer>0&&(r+=.5),this.random()<r&&(s*=2,o=!0),"sakura"===i.character&&i.charState&&"meter"in i.charState&&i.charState.meter>=100&&(s*=5,i.charState.meter=0,this.spawnFloatingText(i.pos,"SMASH!","pink",i.id)),t.hp-=s;const a=o?"yellow":"white",l=Math.ceil(s).toString()+(o?"!":"");this.spawnFloatingText(t.pos,l,a,t.id),t.hp<=0&&(t.dead=!0,this.xpOrbs.push({id:this.nextEntityId++,pos:new e.Vec2(t.pos.x,t.pos.y),val:10,dead:!1}))}updateCharacterPassives(e,t){if(!e.dead){if("naruto"===e.character&&e.charState&&"regenTimer"in e.charState&&(e.charState.regenTimer+=t,e.charState.regenTimer>=1)){e.charState.regenTimer=0;let t=.01*e.maxHp;e.hp<.3*e.maxHp&&(t*=2),e.hp=Math.min(e.hp+t,e.maxHp)}"gaara"===e.character&&e.charState&&"shieldHp"in e.charState&&(e.charState.shieldRegenTimer+=t,e.charState.shieldRegenTimer>=8&&e.charState.shieldHp<50&&(e.charState.shieldHp+=10*t,e.charState.shieldHp>50&&(e.charState.shieldHp=50))),"sasuke"===e.character&&e.charState&&"dodgeBuffTimer"in e.charState&&(e.charState.dodgeBuffTimer>0?(e.charState.dodgeBuffTimer-=t,e.stats.critChance=.5):e.stats.critChance=.05,e.charState.sharinganCooldown>0&&(e.charState.sharinganCooldown-=t))}}fireWeapon(e){const t=(n=e.character||"")&&o[n]||null;var n;t&&t.fire(e,this)}spawnProjectile(t,n,i,s,o,r,a,l,c){this.projectiles.push({id:this.nextEntityId++,type:r,pos:new e.Vec2(n.x,n.y),vel:new e.Vec2(Math.cos(i)*s,Math.sin(i)*s),dmg:o,knock:a,pierce:l,life:2,angle:i,targetAngle:i,ownerId:t,hitList:[],size:c,shape:{type:"circle",radius:c}})}chainLightning(t,n,i,s,o,r){if(s<=0)return;let a=null,l=o;for(const e of this.enemies){if(e.dead||r.includes(e.id))continue;const t=Math.sqrt(Math.pow(n.x-e.pos.x,2)+Math.pow(n.y-e.pos.y,2));t<l&&(l=t,a=e)}if(a){this.damageEnemy(a,i,t);const c=Math.atan2(a.pos.y-n.y,a.pos.x-n.x);this.particles.push({id:this.nextEntityId++,type:"lightning_bolt",pos:new e.Vec2(n.x,n.y),vel:new e.Vec2(0,0),life:.2,maxLife:.2,color:"cyan",size:l,angle:c}),r.push(a.id),this.chainLightning(t,a.pos,.8*i,s-1,o,r)}}generateUpgrades(e){const t=[];if(e.weaponLevel<5){const n=4===e.weaponLevel?"Evolution":`Level ${e.weaponLevel+1}`;t.push({id:"weapon_level",name:`Increase Weapon Level (${n})`,description:"Upgrade your main weapon to the next level",type:"weapon"})}t.push({id:"damage",name:"Increase Damage (+20%)",description:"Increase all damage dealt",type:"stat"}),t.push({id:"cooldown",name:"Reduce Cooldown (-15%)",description:"Reduce all skill cooldowns",type:"stat"});for(let e=t.length-1;e>0;e--){const n=Math.floor(this.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t.slice(0,3)}tickLevelUp(e){let t=!0;for(const[n,i]of e.entries()){const e=n.id,s=this.players[e];null===s.selectedUpgrade&&(i.keysPressed[1]&&(s.selectedUpgrade=0),i.keysPressed[2]&&(s.selectedUpgrade=1),i.keysPressed[3]&&(s.selectedUpgrade=2)),null===s.selectedUpgrade&&(t=!1)}if(t){for(let e in this.players){const t=this.players[e],n=t.offeredUpgrades[t.selectedUpgrade];n&&this.applyUpgrade(t,n),t.selectedUpgrade=null,t.offeredUpgrades=[]}this.gamePhase="playing"}}applyUpgrade(e,t){switch(t.id){case"weapon_level":e.weaponLevel=Math.min(e.weaponLevel+1,5),e.weaponLevel>=5&&(e.isEvolved=!0),this.spawnFloatingText(e.pos,`Weapon Level ${e.weaponLevel}!`,"gold");break;case"damage":e.stats.damageMult*=1.2,this.spawnFloatingText(e.pos,"+20% Damage!","red");break;case"cooldown":e.stats.cooldownMult*=.85,this.spawnFloatingText(e.pos,"-15% Cooldown!","cyan")}}spawnEnemy(){let t="zetsu";const n=this.random();t=this.gameTime<60?n<.9?"zetsu":"sound":this.gameTime<120?n<.6?"zetsu":n<.9?"sound":"snake":n<.4?"zetsu":n<.7?"sound":"snake";const i=this.random()<.5?-1:1,s=Object.keys(this.players);if(0===s.length)return;const o=-1===i?-750:750,r=this.players[parseInt(s[Math.floor(this.random()*s.length)])].pos.y+800*(this.random()-.5),a=1+this.gameTime/60;let l=20*a,c=100;"sound"===t&&(l=15*a,c=210),"snake"===t&&(l=200*a,c=90),this.enemies.push({id:this.nextEntityId++,type:t,pos:new e.Vec2(o,r),hp:l,maxHp:l,dead:!1,burnStacks:0,bleedStacks:0,slowTimer:0,stunTimer:0,dotTimer:0,push:new e.Vec2(0,0),rooted:!1,damageDebuff:1,speedMult:1,shape:{type:"circle",radius:20}})}spawnFloatingText(e,t,n,i){let s;if(void 0!==i){const e=this.enemies.find(e=>e.id===i);e&&(s=e.pos);const t=this.players[i];t&&(s=t.pos)}this.nextEntityId=l.spawn(this.floatingTexts,this.nextEntityId,e,t,n,i,s)}draw(e){try{const n=e.getContext("2d");n.fillStyle="#1b2e1b",n.fillRect(0,0,e.width,e.height),n.save();let i=c.localPlayerId;null===i&&(i=0);const s=this.players[i];let o=0,a=0;s&&(o=s.pos.x-e.width/2,a=s.pos.y-e.height/2),n.translate(-o,-a);const h=100,d=Math.floor((a-200)/h)*h,u=a+e.height+200,p=-700,f=700;if(t.grass&&t.grass instanceof HTMLImageElement&&t.grass.complete){const i=64,s=Math.floor((o-200)/i)*i,r=Math.floor((a-200)/i)*i,l=o+e.width+200,c=a+e.height+200;for(let e=r;e<c;e+=i)for(let o=s;o<l;o+=i)n.drawImage(t.grass,o,e,i,i)}for(let i=d;i<u;i+=h){if(o<p+200)for(let e=p-300;e<p;e+=80)Math.abs(i*e),t.tree&&n.drawImage(t.tree,e,i);if(o+e.width>f-200)for(let e=f;e<f+300;e+=80)Math.abs(i*e),t.tree&&n.drawImage(t.tree,e-60,i)}for(const e of this.hazards){if(n.globalAlpha=.6,"acid"===e.type)n.fillStyle="#2ecc71",n.beginPath(),n.arc(e.pos.x,e.pos.y,e.radius,0,2*Math.PI),n.fill(),n.strokeStyle="#555",n.lineWidth=2,n.stroke();else if("fire"===e.type){const t=1+.1*Math.sin(20*this.gameTime+e.id),i=e.radius*t,s=n.createRadialGradient(e.pos.x,e.pos.y,.2*i,e.pos.x,e.pos.y,i);s.addColorStop(0,"rgba(255, 255, 0, 0.8)"),s.addColorStop(.6,"rgba(255, 69, 0, 0.6)"),s.addColorStop(1,"rgba(255, 0, 0, 0)"),n.fillStyle=s,n.beginPath(),n.arc(e.pos.x,e.pos.y,i,0,2*Math.PI),n.fill()}else n.fillStyle="black",n.beginPath(),n.arc(e.pos.x,e.pos.y,e.radius,0,2*Math.PI),n.fill(),n.strokeStyle="#555",n.lineWidth=2,n.stroke();n.globalAlpha=1}for(const e of this.xpOrbs)n.fillStyle="#00d2ff",n.beginPath(),n.arc(e.pos.x,e.pos.y,4,0,2*Math.PI),n.fill(),n.shadowBlur=5,n.shadowColor="#00d2ff",n.fill(),n.shadowBlur=0;for(const e of this.enemies){const i=t[e.type]||t.zetsu;n.drawImage(i,e.pos.x-i.width/2,e.pos.y-i.height/2);const s=Math.min(Math.max(e.hp/e.maxHp,0),1);n.fillStyle="red",n.fillRect(e.pos.x-15,e.pos.y-40,30,4),n.fillStyle="#0f0",n.fillRect(e.pos.x-15,e.pos.y-40,30*s,4)}for(let e in this.players){const s=this.players[e];if(s.dead)continue;const o=s.character||"naruto",a=t[o],l=r(s.character||"","ult");if(l&&l.draw(n,s.skills.ult,s,this),"naruto"===s.character&&s.weaponLevel>=3&&!s.dead){const e=t.naruto;if(e){n.save(),n.globalAlpha=.6;const t=s.pos.x-40,i=s.pos.y;if(n.drawImage(e,t-e.width/2,i-e.height/2),s.weaponLevel>=4){const t=s.pos.x+40,i=s.pos.y;n.drawImage(e,t-e.width/2,i-e.height/2)}n.restore()}}const c=this.getPlayerColor(parseInt(e));n.fillStyle=c,n.globalAlpha=.6,n.beginPath(),n.ellipse(s.pos.x,s.pos.y+15,20,8,0,0,2*Math.PI),n.fill(),n.globalAlpha=1,n.save(),n.translate(s.pos.x,s.pos.y),n.scale(s.direction,1),a?n.drawImage(a,-a.width/2,-a.height/2):(n.fillStyle="orange",n.fillRect(-10,-10,20,20)),n.restore();const h=r(s.character||"","skillQ");h&&h.draw(n,s.skills.skillQ,s,this);const d=r(s.character||"","skillE");if(d&&d.draw(n,s.skills.skillE,s,this),"naruto"===s.character&&s.dashTime>0){let e=2.5;s.charState&&"rasenganSize"in s.charState&&s.charState.rasenganSize&&(e=s.charState.rasenganSize),n.save(),n.translate(s.pos.x,s.pos.y);const i=Math.atan2(s.dashVec.y,s.dashVec.x);n.rotate(i);const o=40*e;t.rasengan&&n.drawImage(t.rasengan,0,-o/2,o,o),n.restore()}if(parseInt(e)!==i){n.fillStyle="white",n.font="12px Arial",n.textAlign="center",n.fillText(s.name,s.pos.x,s.pos.y-45);const e=Math.min(Math.max(s.hp/s.maxHp,0),1);n.fillStyle="red",n.fillRect(s.pos.x-20,s.pos.y-40,40,5),n.fillStyle="#0f0",n.fillRect(s.pos.x-20,s.pos.y-40,40*e,5)}}for(const e of this.particles)if("crater"===e.type)n.save(),n.translate(e.pos.x,e.pos.y),n.globalAlpha=e.life/e.maxLife,t.cracks?n.drawImage(t.cracks,-50,-50):(n.fillStyle="rgba(0,0,0,0.5)",n.beginPath(),n.ellipse(0,0,40,20,0,0,2*Math.PI),n.fill()),n.restore();else if("lightning_bolt"===e.type){n.save(),n.translate(e.pos.x,e.pos.y),void 0!==e.angle&&n.rotate(e.angle),n.strokeStyle="cyan",n.shadowBlur=15,n.shadowColor="cyan",n.lineWidth=3,n.globalAlpha=.8,n.beginPath(),n.moveTo(0,0);const t=8,i=e.size;for(let e=1;e<=t;e++){const s=e/t*i,o=20*(Math.random()-.5);n.lineTo(s,o)}n.stroke(),n.restore()}for(const e of this.projectiles){const i=t[e.type];if(n.save(),n.translate(e.pos.x,e.pos.y),n.rotate(e.angle),"rotating_slash"===e.type||"rotating_slash_lightning"===e.type||"sword_slash_chidori"===e.type){const t="rotating_slash_lightning"===e.type||"sword_slash_chidori"===e.type;n.fillStyle=t?"rgba(100, 200, 255, 0.6)":"rgba(200, 200, 255, 0.5)",n.strokeStyle=t?"cyan":"white",n.lineWidth=t?3:2,n.beginPath(),n.arc(0,0,e.size,-.8,.8),n.lineTo(0,0),n.fill(),n.stroke()}else if("shadow_clone"===e.type){const e=t.naruto;e&&(n.globalAlpha=.6,n.drawImage(e,-e.width/2,-e.height/2),n.globalAlpha=1)}else if("clone_punch"===e.type){const e=t.naruto;e&&(n.globalAlpha=.7,n.drawImage(e,-e.width/2,-e.height/2),n.globalAlpha=1)}else i?("shuriken"!==e.type&&"rasenshuriken"!==e.type||n.rotate(20*this.gameTime),n.drawImage(i,-e.size,-e.size,2*e.size,2*e.size)):"fireball"===e.type?(n.fillStyle="orange",n.beginPath(),n.arc(0,0,e.size,0,2*Math.PI),n.fill(),n.fillStyle="yellow",n.beginPath(),n.arc(0,0,.75*e.size,0,2*Math.PI),n.fill()):"rinnegan_effect"===e.type?(n.strokeStyle="#8A2BE2",n.lineWidth=3,n.beginPath(),n.arc(0,0,e.size,0,2*Math.PI),n.stroke()):"fire_trail"===e.type?(n.fillStyle="rgba(255, 69, 0, 0.6)",n.beginPath(),n.arc(0,0,e.size,0,2*Math.PI),n.fill()):(n.fillStyle="yellow",n.fillRect(-e.size,-e.size,2*e.size,2*e.size));n.restore()}if(l.draw(n,this.floatingTexts),c.debugMode&&this.drawDebugShapes(n),n.restore(),"playing"===this.gamePhase||"levelUp"===this.gamePhase){const t=Math.min(this.teamXP/this.xpToNextLevel,1),i=600,o=20,r=(e.width-i)/2;if(n.fillStyle="#333",n.fillRect(r,10,i,o),n.fillStyle="#00d2ff",n.fillRect(r,10,i*t,o),n.strokeStyle="#fff",n.lineWidth=2,n.strokeRect(r,10,i,o),n.fillStyle="white",n.font="bold 16px Arial",n.textAlign="center",n.fillText(`Team Level ${this.teamLevel}`,e.width/2,26),s){const t=s.hp/s.maxHp;n.fillStyle="#333",n.fillRect(20,e.height-40,200,20),n.fillStyle="#2ecc71",n.fillRect(20,e.height-40,200*t,20),n.strokeStyle="#fff",n.strokeRect(20,e.height-40,200,20),n.fillStyle="white",n.font="14px Arial",n.textAlign="left",n.fillText(`${Math.ceil(s.hp)} / ${s.maxHp}`,25,e.height-25);const i=(t,i,o)=>{const r=s.skills[i];n.fillStyle="rgba(0,0,0,0.5)",n.fillRect(t,e.height-90,50,50),n.strokeStyle="white",n.strokeRect(t,e.height-90,50,50),n.fillStyle="white",n.font="12px Arial",n.textAlign="center",n.fillText(o,t+25,e.height-95),r.cooldown>0&&(n.fillStyle="rgba(0,0,0,0.7)",n.fillRect(t,e.height-90,50,50),n.fillStyle="white",n.font="bold 16px Arial",n.fillText(Math.ceil(r.cooldown).toString(),t+25,e.height-60))};i(180,"skillQ","Q"),i(240,"skillE","E"),i(300,"ult","R"),this.drawCharacterHUD(n,s)}}if("charSelect"===this.gamePhase){n.fillStyle="rgba(0,0,0,0.8)",n.fillRect(0,0,e.width,e.height),n.fillStyle="white",n.font="30px Arial",n.textAlign="center",n.fillText("Select Character: 1-Naruto, 2-Sasuke, 3-Gaara, 4-Sakura",e.width/2,100),n.fillText("Press SPACE to Ready",e.width/2,150);let t=200;for(let i in this.players){const s=this.players[i],o=s.ready?"READY":s.character?s.character.toUpperCase():"Selecting...";n.fillText(`${s.name}: ${o}`,e.width/2,t),t+=40}}else if("levelUp"===this.gamePhase){if(n.fillStyle="rgba(0,0,0,0.7)",n.fillRect(0,0,e.width,e.height),n.fillStyle="white",n.font="40px Arial",n.textAlign="center",n.fillText("LEVEL UP!",e.width/2,100),n.font="20px Arial",n.fillText("Select an upgrade (1, 2, or 3)",e.width/2,140),s&&s.offeredUpgrades.length>0){n.font="24px Arial";let t=200;for(let i=0;i<s.offeredUpgrades.length;i++){const o=s.offeredUpgrades[i],r=s.selectedUpgrade===i;n.fillStyle=r?"gold":"white",n.fillText(`${i+1}. ${o.name}`,e.width/2,t),n.font="16px Arial",n.fillStyle=r?"yellow":"#ccc",n.fillText(o.description,e.width/2,t+25),n.font="24px Arial",t+=80}}n.font="18px Arial";let t=500;for(let s in this.players){const o=this.players[s];if(parseInt(s)===i)continue;const r=null!==o.selectedUpgrade?"SELECTED":"CHOOSING...";n.fillStyle="white",n.fillText(`${o.name}: ${r}`,e.width/2,t),t+=30}}}catch(e){console.error("DRAW ERROR:",e)}}drawCharacterHUD(e,t){const n=e.canvas;if("gaara"===t.character&&t.charState&&"shieldHp"in t.charState){const i=t.charState.shieldHp/50;e.fillStyle="#555",e.fillRect(20,n.height-65,150,10),e.fillStyle="#c2b280",e.fillRect(20,n.height-65,150*i,10),e.strokeStyle="#fff",e.strokeRect(20,n.height-65,150,10),e.fillStyle="white",e.font="10px Arial",e.textAlign="left",e.fillText(`Shield: ${Math.ceil(t.charState.shieldHp)}`,25,n.height-56)}else if("sakura"===t.character&&t.charState&&"meter"in t.charState){const i=t.charState.meter/100;e.fillStyle="#555",e.fillRect(20,n.height-65,150,10),e.fillStyle="#ff69b4",e.fillRect(20,n.height-65,150*i,10),e.strokeStyle="#fff",e.strokeRect(20,n.height-65,150,10),e.fillStyle="white",e.font="10px Arial",e.textAlign="left",e.fillText(`Strength: ${Math.ceil(t.charState.meter)}%`,25,n.height-56)}else if("sasuke"===t.character&&t.charState&&"sharinganCooldown"in t.charState){const i=t.charState.sharinganCooldown,s=20,o=n.height-80;e.fillStyle=i>0?"rgba(100,0,0,0.5)":"rgba(255,0,0,0.8)",e.beginPath(),e.arc(s+15,o+15,15,0,2*Math.PI),e.fill(),e.strokeStyle="white",e.lineWidth=2,e.stroke(),e.fillStyle="black",e.beginPath(),e.arc(s+15,o+15,5,0,2*Math.PI),e.fill(),i>0?(e.fillStyle="white",e.font="bold 12px Arial",e.textAlign="center",e.fillText(Math.ceil(i).toString(),s+15,o+20)):(e.fillStyle="white",e.font="10px Arial",e.textAlign="center",e.fillText("READY",s+15,o+40))}}drawDebugShapes(e){e.globalAlpha=.5,e.lineWidth=2,e.strokeStyle="lime";for(const t in this.players){const n=this.players[t];!n.dead&&n.shape&&this.drawShape(e,n.pos,n.shape)}e.strokeStyle="red";for(const t of this.enemies)!t.dead&&t.shape&&this.drawShape(e,t.pos,t.shape);e.strokeStyle="yellow";for(const t of this.projectiles)t.shape&&this.drawShape(e,t.pos,t.shape);e.strokeStyle="orange";for(const t of this.hazards)t.shape&&this.drawShape(e,t.pos,t.shape);e.globalAlpha=1}drawShape(t,n,i){if("circle"===i.type)t.beginPath(),t.arc(n.x,n.y,i.radius,0,2*Math.PI),t.stroke();else if("capsule"===i.type){const s=new e.Vec2(n.x+i.startOffset.x,n.y+i.startOffset.y),o=new e.Vec2(n.x+i.endOffset.x,n.y+i.endOffset.y),r=i.radius,a=o.x-s.x,l=o.y-s.y,c=Math.sqrt(a*a+l*l);if(c>0){const e=-l/c*r,n=a/c*r;t.beginPath(),t.moveTo(s.x+e,s.y+n),t.lineTo(o.x+e,o.y+n),t.stroke(),t.beginPath(),t.moveTo(s.x-e,s.y-n),t.lineTo(o.x-e,o.y-n),t.stroke()}t.beginPath(),t.arc(s.x,s.y,r,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(o.x,o.y,r,0,2*Math.PI),t.stroke()}else"aabb"===i.type&&t.strokeRect(n.x-i.width/2,n.y-i.height/2,i.width,i.height)}}c.timestep=1e3/60,c.canvasSize={width:640,height:360},c.numPlayers=2,c.localPlayerId=null,c.debugMode=!1,console.log("Starting LocalWrapper...");try{new e.LocalWrapper(c).start(),console.log("LocalWrapper started.")}catch(e){console.error("Error starting LocalWrapper:",e)}})()})();